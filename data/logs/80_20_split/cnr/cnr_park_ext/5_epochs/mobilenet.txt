Train split file: ../data/splits/cnr/cnr_park_ext_train_80_20.txt
Validation split file: ../data/splits/cnr/cnr_park_ext_valid_80_20.txt

**************************************************
Train dataset size: 115972
Train dataset class distribution: {'empty': 52607, 'occupied': 63365}
Valid dataset size: 14496
Valid dataset class distribution: {'empty': 6458, 'occupied': 8038}
Training the model...
**************************************************
Epoch 1/5
Batch [100/1813], Train Loss: 0.0946008563041687, Train Acc: 0.903125, Train F1: 0.9077009722051502, Train ROC AUC: 0.9043902008384931
Batch [200/1813], Train Loss: 0.04839658364653587, Train Acc: 0.9275, Train F1: 0.929850994666757, Train ROC AUC: 0.9280259972742664
Batch [300/1813], Train Loss: 0.10790474712848663, Train Acc: 0.9371354166666667, Train F1: 0.9387259225308249, Train ROC AUC: 0.9374375466667695
Batch [400/1813], Train Loss: 0.22853638231754303, Train Acc: 0.9441015625, Train F1: 0.945306298910908, Train ROC AUC: 0.9443091647327352
Batch [500/1813], Train Loss: 0.1076350063085556, Train Acc: 0.9489375, Train F1: 0.9499080535051284, Train ROC AUC: 0.9491548462347535
Batch [600/1813], Train Loss: 0.033075492829084396, Train Acc: 0.9523697916666667, Train F1: 0.9531847732423914, Train ROC AUC: 0.9525669383316696
Batch [700/1813], Train Loss: 0.048162613064050674, Train Acc: 0.9551339285714285, Train F1: 0.9558357171314641, Train ROC AUC: 0.9553331590489541
Batch [800/1813], Train Loss: 0.11006780713796616, Train Acc: 0.9573828125, Train F1: 0.9579986759958251, Train ROC AUC: 0.9575536291973226
Batch [900/1813], Train Loss: 0.14179573953151703, Train Acc: 0.9597048611111111, Train F1: 0.9602539649848091, Train ROC AUC: 0.9598831412576967
Batch [1000/1813], Train Loss: 0.041115906089544296, Train Acc: 0.9611875, Train F1: 0.9616832862868189, Train ROC AUC: 0.9613658285398226
Batch [1100/1813], Train Loss: 0.020066216588020325, Train Acc: 0.9623295454545454, Train F1: 0.9627821317727056, Train ROC AUC: 0.9625120608333064
Batch [1200/1813], Train Loss: 0.056296054273843765, Train Acc: 0.9633984375, Train F1: 0.9638141415504632, Train ROC AUC: 0.9635623932998829
Batch [1300/1813], Train Loss: 0.061945606023073196, Train Acc: 0.9643149038461538, Train F1: 0.9646994199281316, Train ROC AUC: 0.9644796997182178
Batch [1400/1813], Train Loss: 0.0877143144607544, Train Acc: 0.9652678571428571, Train F1: 0.9656255165763108, Train ROC AUC: 0.9654378614860635
Batch [1500/1813], Train Loss: 0.05899381265044212, Train Acc: 0.96603125, Train F1: 0.9663655681047684, Train ROC AUC: 0.966190079057197
Batch [1600/1813], Train Loss: 0.0932995080947876, Train Acc: 0.966796875, Train F1: 0.9671109214677608, Train ROC AUC: 0.9669578743436655
Batch [1700/1813], Train Loss: 0.06839816272258759, Train Acc: 0.9673621323529412, Train F1: 0.9676580040649727, Train ROC AUC: 0.967513291294686
Batch [1800/1813], Train Loss: 0.07329992204904556, Train Acc: 0.9680642361111111, Train F1: 0.9683442199112111, Train ROC AUC: 0.9682114566179912
--------------------------------------------------
Train Loss: 0.10296633027602342, Train Acc: 0.9681388611044045, Train F1: 0.968416729403447, Train ROC AUC: 0.9682787495943515
Valid Loss: 0.06694058595750366, Valid Acc: 0.9816501103752759, Valid F1: 0.9816475676679941, Valid ROC AUC: 0.9812925226419474
Confusion Matrix for the validation set:
 [[6316  142]
 [ 124 7914]]
Saved the new best model to ../data/models/80_20_split/cnr/cnr_park_ext/5_epochs/mobilenet.pth with accuracy 0.9816501103752759
Epoch time: 513.4172732830048 seconds.
==================================================
Epoch 2/5
Batch [100/1813], Train Loss: 0.015794100239872932, Train Acc: 0.97890625, Train F1: 0.9789135872944837, Train ROC AUC: 0.979015707464336
Batch [200/1813], Train Loss: 0.04113920032978058, Train Acc: 0.97765625, Train F1: 0.9776617017060835, Train ROC AUC: 0.9777093596059113
Batch [300/1813], Train Loss: 0.1294982135295868, Train Acc: 0.978125, Train F1: 0.9781299912565351, Train ROC AUC: 0.9781686481149153
Batch [400/1813], Train Loss: 0.053080011159181595, Train Acc: 0.9779296875, Train F1: 0.9779356778300397, Train ROC AUC: 0.977999015407148
Batch [500/1813], Train Loss: 0.07187873125076294, Train Acc: 0.97859375, Train F1: 0.9785994856696886, Train ROC AUC: 0.9786859913888206
Batch [600/1813], Train Loss: 0.127997487783432, Train Acc: 0.9792447916666667, Train F1: 0.9792498033873326, Train ROC AUC: 0.9793230392683419
Batch [700/1813], Train Loss: 0.06526139378547668, Train Acc: 0.97953125, Train F1: 0.9795364180818946, Train ROC AUC: 0.9796202738367612
Batch [800/1813], Train Loss: 0.01386390533298254, Train Acc: 0.9795703125, Train F1: 0.9795766469037246, Train ROC AUC: 0.9797063609274795
Batch [900/1813], Train Loss: 0.03787940368056297, Train Acc: 0.9795138888888889, Train F1: 0.9795200702840333, Train ROC AUC: 0.9796363065451226
Batch [1000/1813], Train Loss: 0.022192522883415222, Train Acc: 0.9793125, Train F1: 0.9793185380996201, Train ROC AUC: 0.9794303717649148
Batch [1100/1813], Train Loss: 0.022225620225071907, Train Acc: 0.9796875, Train F1: 0.9796934982677745, Train ROC AUC: 0.9798106113844037
Batch [1200/1813], Train Loss: 0.031094970181584358, Train Acc: 0.9798697916666667, Train F1: 0.9798755062357827, Train ROC AUC: 0.9799871879035421
Batch [1300/1813], Train Loss: 0.05091322958469391, Train Acc: 0.9798798076923076, Train F1: 0.9798856041133538, Train ROC AUC: 0.9799964551279271
Batch [1400/1813], Train Loss: 0.0720001831650734, Train Acc: 0.9798660714285714, Train F1: 0.9798720806565785, Train ROC AUC: 0.9799881401462317
Batch [1500/1813], Train Loss: 0.01534946821630001, Train Acc: 0.97996875, Train F1: 0.9799747330777653, Train ROC AUC: 0.980094756302986
Batch [1600/1813], Train Loss: 0.01152313593775034, Train Acc: 0.97998046875, Train F1: 0.9799864091480369, Train ROC AUC: 0.9801073465951535
Batch [1700/1813], Train Loss: 0.05445044860243797, Train Acc: 0.9803768382352941, Train F1: 0.9803825480348378, Train ROC AUC: 0.9805025425136171
Batch [1800/1813], Train Loss: 0.06592005491256714, Train Acc: 0.9805034722222222, Train F1: 0.9805091110610636, Train ROC AUC: 0.9806330493834382
--------------------------------------------------
Train Loss: 0.058270007631380856, Train Acc: 0.9805125375090539, Train F1: 0.9805181808653392, Train ROC AUC: 0.9806435284438252
Valid Loss: 0.05678874100989248, Valid Acc: 0.9813741721854304, Valid F1: 0.9813593982597502, Valid ROC AUC: 0.9804045139874848
Confusion Matrix for the validation set:
 [[6274  184]
 [  86 7952]]
Epoch time: 564.1948688030243 seconds.
==================================================
Epoch 3/5
Batch [100/1813], Train Loss: 0.07504155486822128, Train Acc: 0.97359375, Train F1: 0.9736058645458288, Train ROC AUC: 0.973847208425828
Batch [200/1813], Train Loss: 0.13850200176239014, Train Acc: 0.976015625, Train F1: 0.9760267048206175, Train ROC AUC: 0.9762972612418834
Batch [300/1813], Train Loss: 0.0077157532796263695, Train Acc: 0.9781770833333333, Train F1: 0.9781856000063359, Train ROC AUC: 0.978372586938324
Batch [400/1813], Train Loss: 0.11872684210538864, Train Acc: 0.97859375, Train F1: 0.9786014643196341, Train ROC AUC: 0.9787732192687244
Batch [500/1813], Train Loss: 0.03395387902855873, Train Acc: 0.97990625, Train F1: 0.9799136169868805, Train ROC AUC: 0.9800917136656465
Batch [600/1813], Train Loss: 0.14451223611831665, Train Acc: 0.9800520833333334, Train F1: 0.9800593321112829, Train ROC AUC: 0.9802498801685209
Batch [700/1813], Train Loss: 0.01819862239062786, Train Acc: 0.98046875, Train F1: 0.9804757988365673, Train ROC AUC: 0.9806613106813705
Batch [800/1813], Train Loss: 0.021204493939876556, Train Acc: 0.98103515625, Train F1: 0.9810418245783643, Train ROC AUC: 0.9812240318907504
Batch [900/1813], Train Loss: 0.02935381978750229, Train Acc: 0.9815451388888888, Train F1: 0.9815513041875968, Train ROC AUC: 0.9817216648264965
Batch [1000/1813], Train Loss: 0.00319664622657001, Train Acc: 0.982, Train F1: 0.9820058193057921, Train ROC AUC: 0.9821686604545334
Batch [1100/1813], Train Loss: 0.03770333528518677, Train Acc: 0.9821875, Train F1: 0.9821932203268278, Train ROC AUC: 0.9823575752417583
Batch [1200/1813], Train Loss: 0.16284312307834625, Train Acc: 0.9823307291666666, Train F1: 0.9823362034554848, Train ROC AUC: 0.9824930780508404
Batch [1300/1813], Train Loss: 0.13440297544002533, Train Acc: 0.9826322115384616, Train F1: 0.9826372851486641, Train ROC AUC: 0.9827839907141768
Batch [1400/1813], Train Loss: 0.023236099630594254, Train Acc: 0.9828236607142857, Train F1: 0.9828285514831113, Train ROC AUC: 0.9829680072250362
Batch [1500/1813], Train Loss: 0.016065839678049088, Train Acc: 0.9828125, Train F1: 0.982817268893873, Train ROC AUC: 0.9829518500296823
Batch [1600/1813], Train Loss: 0.03885023668408394, Train Acc: 0.9829296875, Train F1: 0.9829343649843031, Train ROC AUC: 0.983060926759547
Batch [1700/1813], Train Loss: 0.08468005806207657, Train Acc: 0.98296875, Train F1: 0.9829735037889045, Train ROC AUC: 0.9831072400583264
Batch [1800/1813], Train Loss: 0.03354130685329437, Train Acc: 0.9828993055555556, Train F1: 0.9829039789902334, Train ROC AUC: 0.9830335314218818
--------------------------------------------------
Train Loss: 0.05240211455413164, Train Acc: 0.9829182906218742, Train F1: 0.9829229933719273, Train ROC AUC: 0.983054833383802
Valid Loss: 0.03277780507826595, Valid Acc: 0.9898592715231788, Valid F1: 0.9898598092277419, Valid ROC AUC: 0.9897906167445112
Confusion Matrix for the validation set:
 [[6388   70]
 [  77 7961]]
Saved the new best model to ../data/models/80_20_split/cnr/cnr_park_ext/5_epochs/mobilenet.pth with accuracy 0.9898592715231788
Epoch time: 637.8576617240906 seconds.
==================================================
Epoch 4/5
Batch [100/1813], Train Loss: 0.03491982817649841, Train Acc: 0.98640625, Train F1: 0.9864119830614344, Train ROC AUC: 0.9866449390711939
Batch [200/1813], Train Loss: 0.042873140424489975, Train Acc: 0.985390625, Train F1: 0.9853960133390831, Train ROC AUC: 0.9856163200442203
Batch [300/1813], Train Loss: 0.027083758264780045, Train Acc: 0.9843229166666667, Train F1: 0.9843282480597857, Train ROC AUC: 0.9844965326915148
Batch [400/1813], Train Loss: 0.007000430952757597, Train Acc: 0.985390625, Train F1: 0.9853950603584639, Train ROC AUC: 0.985551050309379
Batch [500/1813], Train Loss: 0.009510064497590065, Train Acc: 0.98553125, Train F1: 0.9855357173692277, Train ROC AUC: 0.9857039328373146
Batch [600/1813], Train Loss: 0.010272344574332237, Train Acc: 0.9849739583333333, Train F1: 0.9849788062140916, Train ROC AUC: 0.9851562321490315
Batch [700/1813], Train Loss: 0.011931370943784714, Train Acc: 0.9848883928571428, Train F1: 0.9848928765967643, Train ROC AUC: 0.9850568919992004
Batch [800/1813], Train Loss: 0.028314650058746338, Train Acc: 0.98515625, Train F1: 0.9851606563734577, Train ROC AUC: 0.9853248125812867
Batch [900/1813], Train Loss: 0.026855168864130974, Train Acc: 0.98546875, Train F1: 0.9854729108824606, Train ROC AUC: 0.9856341228172179
Batch [1000/1813], Train Loss: 0.006369549315422773, Train Acc: 0.985515625, Train F1: 0.9855197162732985, Train ROC AUC: 0.9856757919686702
Batch [1100/1813], Train Loss: 0.005043688230216503, Train Acc: 0.9854545454545455, Train F1: 0.9854585708118723, Train ROC AUC: 0.9856105130408057
Batch [1200/1813], Train Loss: 0.014636751264333725, Train Acc: 0.9854166666666667, Train F1: 0.9854206051824398, Train ROC AUC: 0.9855657304750152
Batch [1300/1813], Train Loss: 0.0021061680745333433, Train Acc: 0.9855889423076923, Train F1: 0.9855927670428565, Train ROC AUC: 0.9857372202441386
Batch [1400/1813], Train Loss: 0.15084509551525116, Train Acc: 0.9856473214285715, Train F1: 0.9856512239795695, Train ROC AUC: 0.9858046095955116
Batch [1500/1813], Train Loss: 0.007047545164823532, Train Acc: 0.9859375, Train F1: 0.9859411575980414, Train ROC AUC: 0.9860861498389032
Batch [1600/1813], Train Loss: 0.10351777076721191, Train Acc: 0.985947265625, Train F1: 0.9859509020801599, Train ROC AUC: 0.9860946069219272
Batch [1700/1813], Train Loss: 0.017447661608457565, Train Acc: 0.985827205882353, Train F1: 0.9858309473383198, Train ROC AUC: 0.9859775911390124
Batch [1800/1813], Train Loss: 0.04944109544157982, Train Acc: 0.9859809027777777, Train F1: 0.9859846265230526, Train ROC AUC: 0.9861344597100592
--------------------------------------------------
Train Loss: 0.042762073454174446, Train Acc: 0.9860397337288311, Train F1: 0.9860434086465886, Train ROC AUC: 0.9861904608402647
Valid Loss: 0.031518900355412355, Valid Acc: 0.9901352097130243, Valid F1: 0.9901346818719754, Valid ROC AUC: 0.9899633407465052
Confusion Matrix for the validation set:
 [[6383   75]
 [  68 7970]]
Saved the new best model to ../data/models/80_20_split/cnr/cnr_park_ext/5_epochs/mobilenet.pth with accuracy 0.9901352097130243
Epoch time: 637.9728722572327 seconds.
==================================================
Epoch 5/5
Batch [100/1813], Train Loss: 0.030180269852280617, Train Acc: 0.9828125, Train F1: 0.9828140498769338, Train ROC AUC: 0.9827428631809372
Batch [200/1813], Train Loss: 0.06119528412818909, Train Acc: 0.985078125, Train F1: 0.9850792055299163, Train ROC AUC: 0.9850438997466247
Batch [300/1813], Train Loss: 0.065986767411232, Train Acc: 0.9854166666666667, Train F1: 0.9854184522016556, Train ROC AUC: 0.9854190972037282
Batch [400/1813], Train Loss: 0.028345298022031784, Train Acc: 0.9862890625, Train F1: 0.9862910272014154, Train ROC AUC: 0.9863104930656218
Batch [500/1813], Train Loss: 0.01828266680240631, Train Acc: 0.98634375, Train F1: 0.986345875468345, Train ROC AUC: 0.9863783324464743
Batch [600/1813], Train Loss: 0.02461446076631546, Train Acc: 0.98640625, Train F1: 0.986408368725561, Train ROC AUC: 0.9864565026231987
Batch [700/1813], Train Loss: 0.026049859821796417, Train Acc: 0.9866071428571429, Train F1: 0.9866094720797294, Train ROC AUC: 0.9866710473220116
Batch [800/1813], Train Loss: 0.026736916974186897, Train Acc: 0.986640625, Train F1: 0.9866430578877273, Train ROC AUC: 0.9867154685975665
Batch [900/1813], Train Loss: 0.08262437582015991, Train Acc: 0.9867534722222222, Train F1: 0.9867558643520505, Train ROC AUC: 0.986829520558811
Batch [1000/1813], Train Loss: 0.02110288292169571, Train Acc: 0.986890625, Train F1: 0.9868932645311884, Train ROC AUC: 0.9869829650411394
Batch [1100/1813], Train Loss: 0.0032155520748347044, Train Acc: 0.9869886363636363, Train F1: 0.9869913739727677, Train ROC AUC: 0.9870909937501512
Batch [1200/1813], Train Loss: 0.018017670139670372, Train Acc: 0.9874088541666667, Train F1: 0.9874113766699258, Train ROC AUC: 0.9875054962460048
Batch [1300/1813], Train Loss: 0.04391087591648102, Train Acc: 0.9872475961538462, Train F1: 0.9872503349572328, Train ROC AUC: 0.987356206345874
Batch [1400/1813], Train Loss: 0.13454899191856384, Train Acc: 0.987578125, Train F1: 0.987580877745881, Train ROC AUC: 0.9876969727879245
Batch [1500/1813], Train Loss: 0.06769808381795883, Train Acc: 0.9876875, Train F1: 0.9876902513072964, Train ROC AUC: 0.9878088045072394
Batch [1600/1813], Train Loss: 0.016087116673588753, Train Acc: 0.987724609375, Train F1: 0.9877273086398349, Train ROC AUC: 0.9878420316003497
Batch [1700/1813], Train Loss: 0.024398531764745712, Train Acc: 0.9877757352941177, Train F1: 0.9877784406554225, Train ROC AUC: 0.987895074132983
Batch [1800/1813], Train Loss: 0.02011880837380886, Train Acc: 0.9879774305555555, Train F1: 0.9879800151115907, Train ROC AUC: 0.9880932229668934
--------------------------------------------------
Train Loss: 0.0386390123593118, Train Acc: 0.9879712344358983, Train F1: 0.987973815568561, Train ROC AUC: 0.988087089894369
Valid Loss: 0.03212587662566339, Valid Acc: 0.9896523178807947, Valid F1: 0.989647069194474, Valid ROC AUC: 0.9890409067305029
Confusion Matrix for the validation set:
 [[6351  107]
 [  43 7995]]
Epoch time: 637.3956763744354 seconds.
==================================================
Average Train Loss: 0.05900790765500443
Average Train Accuracy: 0.9811161314800124
Average Train F1: 0.9811750255711725
Average Train ROC AUC: 0.9812509324313226

Best Validation Accuracy: 0.9901352097130243

Average Valid Loss: 0.04403038180534756
Average Valid Accuracy: 0.9865342163355407
Average Valid F1: 0.9865297052443871
Average Valid ROC AUC: 0.9860983801701904

Total training time: 2990.8413639068604 seconds.
