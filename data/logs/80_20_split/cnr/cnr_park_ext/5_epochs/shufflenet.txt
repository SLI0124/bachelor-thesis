Train split file: ../data/splits/cnr/cnr_park_ext_train_80_20.txt
Validation split file: ../data/splits/cnr/cnr_park_ext_valid_80_20.txt

**************************************************
Train dataset size: 115972
Train dataset class distribution: {'empty': 52607, 'occupied': 63365}
Valid dataset size: 14496
Valid dataset class distribution: {'empty': 6458, 'occupied': 8038}
Training the model...
**************************************************
Epoch 1/5
Batch [100/1813], Train Loss: 0.11516916006803513, Train Acc: 0.89671875, Train F1: 0.9024469695556485, Train ROC AUC: 0.8990387628246739
Batch [200/1813], Train Loss: 0.1447373777627945, Train Acc: 0.919296875, Train F1: 0.9222394827853898, Train ROC AUC: 0.9203207102021294
Batch [300/1813], Train Loss: 0.241045743227005, Train Acc: 0.9276041666666667, Train F1: 0.9295948824551091, Train ROC AUC: 0.9282715165417392
Batch [400/1813], Train Loss: 0.13284063339233398, Train Acc: 0.9339453125, Train F1: 0.9354453847223926, Train ROC AUC: 0.9344263742975668
Batch [500/1813], Train Loss: 0.08847806602716446, Train Acc: 0.9398125, Train F1: 0.9410179609264567, Train ROC AUC: 0.9401626219024024
Batch [600/1813], Train Loss: 0.04196703061461449, Train Acc: 0.943203125, Train F1: 0.944214056480887, Train ROC AUC: 0.9434564928937008
Batch [700/1813], Train Loss: 0.055125683546066284, Train Acc: 0.9463169642857143, Train F1: 0.9471869967530321, Train ROC AUC: 0.9465289915497083
Batch [800/1813], Train Loss: 0.11105260252952576, Train Acc: 0.94876953125, Train F1: 0.9495329594387991, Train ROC AUC: 0.9489411614721204
Batch [900/1813], Train Loss: 0.040788356214761734, Train Acc: 0.9514930555555555, Train F1: 0.9521740667427494, Train ROC AUC: 0.9516509906063851
Batch [1000/1813], Train Loss: 0.11789337545633316, Train Acc: 0.953109375, Train F1: 0.9537245214691809, Train ROC AUC: 0.9532590000288536
Batch [1100/1813], Train Loss: 0.05248347669839859, Train Acc: 0.9543607954545454, Train F1: 0.9549217740743914, Train ROC AUC: 0.9544923967056169
Batch [1200/1813], Train Loss: 0.022689059376716614, Train Acc: 0.9559114583333334, Train F1: 0.9564263457024599, Train ROC AUC: 0.9560285868514243
Batch [1300/1813], Train Loss: 0.014662698842585087, Train Acc: 0.9570432692307692, Train F1: 0.957519674386519, Train ROC AUC: 0.9571565491257839
Batch [1400/1813], Train Loss: 0.062210410833358765, Train Acc: 0.9583258928571429, Train F1: 0.9587693850746223, Train ROC AUC: 0.9584355720097597
Batch [1500/1813], Train Loss: 0.012437073513865471, Train Acc: 0.95940625, Train F1: 0.9598211173842318, Train ROC AUC: 0.9595196034876627
Batch [1600/1813], Train Loss: 0.03839839994907379, Train Acc: 0.96044921875, Train F1: 0.9608385990395988, Train ROC AUC: 0.9605553482741466
Batch [1700/1813], Train Loss: 0.02249651774764061, Train Acc: 0.9615165441176471, Train F1: 0.9618835262105667, Train ROC AUC: 0.9616179702167319
Batch [1800/1813], Train Loss: 0.01992979645729065, Train Acc: 0.9623697916666667, Train F1: 0.9627165940754256, Train ROC AUC: 0.9624713304864769
--------------------------------------------------
Train Loss: 0.11915876465886564, Train Acc: 0.9623874728382713, Train F1: 0.9627319695434463, Train ROC AUC: 0.9624878896405641
Valid Loss: 0.057459285652002375, Valid Acc: 0.9797185430463576, Valid F1: 0.9797280110420455, Valid ROC AUC: 0.9799617040488464
Confusion Matrix for the validation set:
 [[6343  115]
 [ 179 7859]]
Saved the new best model to ../data/models/80_20_split/cnr/cnr_park_ext/5_epochs/shufflenet.pth with accuracy 0.9797185430463576
Epoch time: 304.8240156173706 seconds.
==================================================
Epoch 2/5
Batch [100/1813], Train Loss: 0.16056695580482483, Train Acc: 0.97546875, Train F1: 0.9754722734476476, Train ROC AUC: 0.9753539530947012
Batch [200/1813], Train Loss: 0.20056438446044922, Train Acc: 0.9771875, Train F1: 0.9771920412785333, Train ROC AUC: 0.9771266248583923
Batch [300/1813], Train Loss: 0.023237962275743484, Train Acc: 0.9784895833333334, Train F1: 0.9784940238730663, Train ROC AUC: 0.9785108610723692
Batch [400/1813], Train Loss: 0.009852196089923382, Train Acc: 0.978828125, Train F1: 0.9788324645321671, Train ROC AUC: 0.9788448691923045
Batch [500/1813], Train Loss: 0.04135776683688164, Train Acc: 0.97859375, Train F1: 0.9785985110998194, Train ROC AUC: 0.9786310204180563
Batch [600/1813], Train Loss: 0.09113184362649918, Train Acc: 0.9783333333333334, Train F1: 0.978338613374998, Train ROC AUC: 0.9784064495294454
Batch [700/1813], Train Loss: 0.05006788671016693, Train Acc: 0.9783482142857143, Train F1: 0.9783537198728048, Train ROC AUC: 0.9784294159662731
Batch [800/1813], Train Loss: 0.08280926197767258, Train Acc: 0.97853515625, Train F1: 0.9785404364123105, Train ROC AUC: 0.9786130822053978
Batch [900/1813], Train Loss: 0.07948008179664612, Train Acc: 0.9786979166666666, Train F1: 0.9787032716623119, Train ROC AUC: 0.9787797376921951
Batch [1000/1813], Train Loss: 0.03460320457816124, Train Acc: 0.9786875, Train F1: 0.9786925713895043, Train ROC AUC: 0.9787526199762044
Batch [1100/1813], Train Loss: 0.07928729802370071, Train Acc: 0.9787357954545455, Train F1: 0.9787409503272122, Train ROC AUC: 0.978806764638046
Batch [1200/1813], Train Loss: 0.09481804817914963, Train Acc: 0.97875, Train F1: 0.9787551745626756, Train ROC AUC: 0.9788233591976152
Batch [1300/1813], Train Loss: 0.04694978520274162, Train Acc: 0.9789663461538461, Train F1: 0.9789714467365099, Train ROC AUC: 0.9790365534030904
Batch [1400/1813], Train Loss: 0.01049424335360527, Train Acc: 0.9792075892857143, Train F1: 0.9792128821637249, Train ROC AUC: 0.9792918397977435
Batch [1500/1813], Train Loss: 0.00781852938234806, Train Acc: 0.9793229166666667, Train F1: 0.9793282759815259, Train ROC AUC: 0.9794141362492134
Batch [1600/1813], Train Loss: 0.16341076791286469, Train Acc: 0.9796484375, Train F1: 0.9796537182099498, Train ROC AUC: 0.9797406524953898
Batch [1700/1813], Train Loss: 0.018709572032094002, Train Acc: 0.9797610294117647, Train F1: 0.979766422556893, Train ROC AUC: 0.9798626564144636
Batch [1800/1813], Train Loss: 0.05037927255034447, Train Acc: 0.9796961805555555, Train F1: 0.9797017324623741, Train ROC AUC: 0.9798015731323128
--------------------------------------------------
Train Loss: 0.06209311548952307, Train Acc: 0.979693374262753, Train F1: 0.9796989036714172, Train ROC AUC: 0.9797986980759595
Valid Loss: 0.06831744070357688, Valid Acc: 0.9757174392935982, Valid F1: 0.9757596061936046, Valid ROC AUC: 0.9775409095430955
Confusion Matrix for the validation set:
 [[6421   37]
 [ 315 7723]]
Epoch time: 322.309850692749 seconds.
==================================================
Epoch 3/5
Batch [100/1813], Train Loss: 0.03059324622154236, Train Acc: 0.9721875, Train F1: 0.9721989129577021, Train ROC AUC: 0.9723104031538405
Batch [200/1813], Train Loss: 0.03244701400399208, Train Acc: 0.974296875, Train F1: 0.9743080330370113, Train ROC AUC: 0.9745037397634143
Batch [300/1813], Train Loss: 0.12985225021839142, Train Acc: 0.9769791666666666, Train F1: 0.9769863014117921, Train ROC AUC: 0.9770885198389634
Batch [400/1813], Train Loss: 0.08016672730445862, Train Acc: 0.9780859375, Train F1: 0.9780935963807476, Train ROC AUC: 0.9782574375047223
Batch [500/1813], Train Loss: 0.12538772821426392, Train Acc: 0.97909375, Train F1: 0.9791006922199363, Train ROC AUC: 0.9792603017453367
Batch [600/1813], Train Loss: 0.021264899522066116, Train Acc: 0.9798958333333333, Train F1: 0.9799022000757388, Train ROC AUC: 0.980057721047339
Batch [700/1813], Train Loss: 0.025442220270633698, Train Acc: 0.9808258928571428, Train F1: 0.9808317012318795, Train ROC AUC: 0.9809791388834008
Batch [800/1813], Train Loss: 0.02323015220463276, Train Acc: 0.9809375, Train F1: 0.9809430737427269, Train ROC AUC: 0.98109357640157
Batch [900/1813], Train Loss: 0.03535260632634163, Train Acc: 0.9813541666666666, Train F1: 0.9813596438500987, Train ROC AUC: 0.9815074995876543
Batch [1000/1813], Train Loss: 0.08473420143127441, Train Acc: 0.981625, Train F1: 0.9816302644512346, Train ROC AUC: 0.9817781928574046
Batch [1100/1813], Train Loss: 0.023698439821600914, Train Acc: 0.9821164772727272, Train F1: 0.9821215358391135, Train ROC AUC: 0.9822630141462458
Batch [1200/1813], Train Loss: 0.016597263514995575, Train Acc: 0.9821614583333333, Train F1: 0.9821662059197361, Train ROC AUC: 0.9822922799423311
Batch [1300/1813], Train Loss: 0.07305672764778137, Train Acc: 0.9822596153846154, Train F1: 0.9822644668844815, Train ROC AUC: 0.9823982925854279
Batch [1400/1813], Train Loss: 0.013664902187883854, Train Acc: 0.9823214285714286, Train F1: 0.9823259953217062, Train ROC AUC: 0.9824444164154987
Batch [1500/1813], Train Loss: 0.01051123347133398, Train Acc: 0.9821875, Train F1: 0.9821920842941687, Train ROC AUC: 0.9823065505060966
Batch [1600/1813], Train Loss: 0.020441371947526932, Train Acc: 0.98248046875, Train F1: 0.9824848917782029, Train ROC AUC: 0.9825959301068453
Batch [1700/1813], Train Loss: 0.007765568792819977, Train Acc: 0.9827849264705882, Train F1: 0.9827893517178071, Train ROC AUC: 0.9829068447105184
Batch [1800/1813], Train Loss: 0.09025026112794876, Train Acc: 0.9828472222222222, Train F1: 0.9828517420183873, Train ROC AUC: 0.9829713039754255
--------------------------------------------------
Train Loss: 0.05048274716811323, Train Acc: 0.9828579312247784, Train F1: 0.9828624307727207, Train ROC AUC: 0.9829802340781602
Valid Loss: 0.043646991605735035, Valid Acc: 0.9865480132450332, Valid F1: 0.9865468792367542, Valid ROC AUC: 0.9863025782380396
Confusion Matrix for the validation set:
 [[6355  103]
 [  92 7946]]
Saved the new best model to ../data/models/80_20_split/cnr/cnr_park_ext/5_epochs/shufflenet.pth with accuracy 0.9865480132450332
Epoch time: 339.0997440814972 seconds.
==================================================
Epoch 4/5
Batch [100/1813], Train Loss: 0.14192627370357513, Train Acc: 0.9865625, Train F1: 0.9865645526925458, Train ROC AUC: 0.9866260561320187
Batch [200/1813], Train Loss: 0.02955075167119503, Train Acc: 0.986328125, Train F1: 0.9863306905686798, Train ROC AUC: 0.9864226235321782
Batch [300/1813], Train Loss: 0.007870403118431568, Train Acc: 0.98734375, Train F1: 0.9873459200611948, Train ROC AUC: 0.9874151794522711
Batch [400/1813], Train Loss: 0.02159544825553894, Train Acc: 0.986015625, Train F1: 0.9860185307391629, Train ROC AUC: 0.9861140361733629
Batch [500/1813], Train Loss: 0.007882704958319664, Train Acc: 0.9856875, Train F1: 0.9856905739084736, Train ROC AUC: 0.9857918033823176
Batch [600/1813], Train Loss: 0.08567450940608978, Train Acc: 0.9853125, Train F1: 0.9853156327886378, Train ROC AUC: 0.9854097683602275
Batch [700/1813], Train Loss: 0.03599708527326584, Train Acc: 0.9851785714285715, Train F1: 0.9851818801049051, Train ROC AUC: 0.9852797052996065
Batch [800/1813], Train Loss: 0.08332807570695877, Train Acc: 0.98490234375, Train F1: 0.9849054348933217, Train ROC AUC: 0.9849815220273289
Batch [900/1813], Train Loss: 0.016036810353398323, Train Acc: 0.9847743055555556, Train F1: 0.9847775390090208, Train ROC AUC: 0.984861701091132
Batch [1000/1813], Train Loss: 0.020917966961860657, Train Acc: 0.984984375, Train F1: 0.9849876519616653, Train ROC AUC: 0.9850809729352985
Batch [1100/1813], Train Loss: 0.022622080519795418, Train Acc: 0.9848295454545455, Train F1: 0.9848329840347573, Train ROC AUC: 0.984925837698957
Batch [1200/1813], Train Loss: 0.007341061718761921, Train Acc: 0.9852083333333334, Train F1: 0.9852116349378867, Train ROC AUC: 0.985303392747088
Batch [1300/1813], Train Loss: 0.10833091288805008, Train Acc: 0.9853605769230769, Train F1: 0.9853638723282089, Train ROC AUC: 0.9854576100500033
Batch [1400/1813], Train Loss: 0.00930484663695097, Train Acc: 0.9854017857142857, Train F1: 0.9854050147260359, Train ROC AUC: 0.985498081062709
Batch [1500/1813], Train Loss: 0.016299037262797356, Train Acc: 0.9855625, Train F1: 0.9855656903158025, Train ROC AUC: 0.9856588250631816
Batch [1600/1813], Train Loss: 0.01721971482038498, Train Acc: 0.985517578125, Train F1: 0.9855207668625147, Train ROC AUC: 0.9856154855284336
Batch [1700/1813], Train Loss: 0.02128852903842926, Train Acc: 0.9856066176470588, Train F1: 0.9856097761483592, Train ROC AUC: 0.9857050980171166
Batch [1800/1813], Train Loss: 0.0262056365609169, Train Acc: 0.9857204861111111, Train F1: 0.9857235926728607, Train ROC AUC: 0.9858199025889829
--------------------------------------------------
Train Loss: 0.04258546520410962, Train Acc: 0.985703445659297, Train F1: 0.985706524352804, Train ROC AUC: 0.9858004239704079
Valid Loss: 0.03438453354599931, Valid Acc: 0.9884795805739515, Valid F1: 0.988486465960116, Valid ROC AUC: 0.9889726532017203
Confusion Matrix for the validation set:
 [[6416   42]
 [ 125 7913]]
Saved the new best model to ../data/models/80_20_split/cnr/cnr_park_ext/5_epochs/shufflenet.pth with accuracy 0.9884795805739515
Epoch time: 346.75905442237854 seconds.
==================================================
Epoch 5/5
Batch [100/1813], Train Loss: 0.0047857197932899, Train Acc: 0.98796875, Train F1: 0.9879700136199063, Train ROC AUC: 0.9879625073532776
Batch [200/1813], Train Loss: 0.024339845404028893, Train Acc: 0.987578125, Train F1: 0.9875802199959338, Train ROC AUC: 0.9876373410811525
Batch [300/1813], Train Loss: 0.003740971442312002, Train Acc: 0.9879166666666667, Train F1: 0.9879187127089066, Train ROC AUC: 0.9879876724051033
Batch [400/1813], Train Loss: 0.1549181491136551, Train Acc: 0.98796875, Train F1: 0.9879705647050205, Train ROC AUC: 0.9880178039520316
Batch [500/1813], Train Loss: 0.17375074326992035, Train Acc: 0.9875, Train F1: 0.9875023918134925, Train ROC AUC: 0.9875771902258006
Batch [600/1813], Train Loss: 0.024929232895374298, Train Acc: 0.9878645833333334, Train F1: 0.9878667377177434, Train ROC AUC: 0.9879394000726026
Batch [700/1813], Train Loss: 0.00800508912652731, Train Acc: 0.9879017857142857, Train F1: 0.9879040148628103, Train ROC AUC: 0.9879799259293582
Batch [800/1813], Train Loss: 0.09899403154850006, Train Acc: 0.98734375, Train F1: 0.987346479307361, Train ROC AUC: 0.9874454556411479
Batch [900/1813], Train Loss: 0.03159233182668686, Train Acc: 0.9875520833333333, Train F1: 0.9875546415312135, Train ROC AUC: 0.9876428159777215
Batch [1000/1813], Train Loss: 0.0070953755639493465, Train Acc: 0.987640625, Train F1: 0.9876430810478178, Train ROC AUC: 0.9877267713421313
Batch [1100/1813], Train Loss: 0.03880066052079201, Train Acc: 0.98765625, Train F1: 0.9876588197524753, Train ROC AUC: 0.987760415041832
Batch [1200/1813], Train Loss: 0.09814362227916718, Train Acc: 0.988046875, Train F1: 0.9880493296980933, Train ROC AUC: 0.9881526949090249
Batch [1300/1813], Train Loss: 0.011439358815550804, Train Acc: 0.9880769230769231, Train F1: 0.9880795493901134, Train ROC AUC: 0.9881963531787551
Batch [1400/1813], Train Loss: 0.004321427550166845, Train Acc: 0.9879241071428572, Train F1: 0.9879266667764308, Train ROC AUC: 0.9880365160555349
Batch [1500/1813], Train Loss: 0.009947456419467926, Train Acc: 0.9878541666666667, Train F1: 0.9878569349522651, Train ROC AUC: 0.9879844477550656
Batch [1600/1813], Train Loss: 0.054521407932043076, Train Acc: 0.987783203125, Train F1: 0.9877859343257452, Train ROC AUC: 0.9879082180418446
Batch [1700/1813], Train Loss: 0.11650741845369339, Train Acc: 0.9877573529411765, Train F1: 0.9877601649707546, Train ROC AUC: 0.9878867894835878
Batch [1800/1813], Train Loss: 0.013830237090587616, Train Acc: 0.9878819444444444, Train F1: 0.9878847035127054, Train ROC AUC: 0.9880107027293746
--------------------------------------------------
Train Loss: 0.036539962944167295, Train Acc: 0.9878591384127203, Train F1: 0.9878619197798262, Train ROC AUC: 0.9879893505469453
Valid Loss: 0.029993043261137074, Valid Acc: 0.9904801324503312, Valid F1: 0.9904833654715719, Valid ROC AUC: 0.9907157092383492
Confusion Matrix for the validation set:
 [[6412   46]
 [  92 7946]]
Saved the new best model to ../data/models/80_20_split/cnr/cnr_park_ext/5_epochs/shufflenet.pth with accuracy 0.9904801324503312
Epoch time: 348.4178192615509 seconds.
==================================================
Average Train Loss: 0.06217201109295577
Average Train Accuracy: 0.9797002724795639
Average Train F1: 0.9797723496240429
Average Train ROC AUC: 0.9798113192624074

Best Validation Accuracy: 0.9904801324503312

Average Valid Loss: 0.04676025895369014
Average Valid Accuracy: 0.9841887417218544
Average Valid F1: 0.9842008655808183
Average Valid ROC AUC: 0.9846987108540102

Total training time: 1661.4155054092407 seconds.
