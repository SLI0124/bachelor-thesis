Train split file: ../data/splits/cnr/all_train_80_20.txt
Validation split file: ../data/splits/cnr/all_valid_80_20.txt

**************************************************
Train dataset size: 126039
Train dataset class distribution: {'empty': 55925, 'occupied': 70114}
Valid dataset size: 15755
Valid dataset class distribution: {'empty': 6945, 'occupied': 8810}
Training the model...
**************************************************
Epoch 1/5
Batch [100/1970], Train Loss: 0.13867662847042084, Train Acc: 0.88484375, Train F1: 0.8895107056964402, Train ROC AUC: 0.8860412631742353
Batch [200/1970], Train Loss: 0.08291848748922348, Train Acc: 0.911640625, Train F1: 0.9140461749628573, Train ROC AUC: 0.9116846617294245
Batch [300/1970], Train Loss: 0.11477159708738327, Train Acc: 0.9222916666666666, Train F1: 0.9239221247028244, Train ROC AUC: 0.9223055260175098
Batch [400/1970], Train Loss: 0.0632522851228714, Train Acc: 0.9302734375, Train F1: 0.9315094630915435, Train ROC AUC: 0.9302042465621405
Batch [500/1970], Train Loss: 0.09982310235500336, Train Acc: 0.93521875, Train F1: 0.9362212785641827, Train ROC AUC: 0.9352408954165796
Batch [600/1970], Train Loss: 0.13629372417926788, Train Acc: 0.9392708333333334, Train F1: 0.9401119906469919, Train ROC AUC: 0.9392691817166483
Batch [700/1970], Train Loss: 0.05329994857311249, Train Acc: 0.9427008928571429, Train F1: 0.9434260991977917, Train ROC AUC: 0.9427180101912161
Batch [800/1970], Train Loss: 0.06297732889652252, Train Acc: 0.94517578125, Train F1: 0.9458116793002259, Train ROC AUC: 0.9451672028699164
Batch [900/1970], Train Loss: 0.024621590971946716, Train Acc: 0.9480729166666667, Train F1: 0.9486401591569378, Train ROC AUC: 0.9480508372254793
Batch [1000/1970], Train Loss: 0.10594072192907333, Train Acc: 0.9494375, Train F1: 0.9499492235075918, Train ROC AUC: 0.9494117587559987
Batch [1100/1970], Train Loss: 0.10251733660697937, Train Acc: 0.9505539772727273, Train F1: 0.9510216793191425, Train ROC AUC: 0.9505592960547513
Batch [1200/1970], Train Loss: 0.04176516458392143, Train Acc: 0.952109375, Train F1: 0.9525389392561736, Train ROC AUC: 0.9521102129856506
Batch [1300/1970], Train Loss: 0.03606720268726349, Train Acc: 0.9533774038461539, Train F1: 0.953775886778625, Train ROC AUC: 0.9534058841970797
Batch [1400/1970], Train Loss: 0.015785980969667435, Train Acc: 0.9544866071428572, Train F1: 0.9548577890406889, Train ROC AUC: 0.9545170653690784
Batch [1500/1970], Train Loss: 0.06708791851997375, Train Acc: 0.955625, Train F1: 0.955972829120514, Train ROC AUC: 0.9556665977094345
Batch [1600/1970], Train Loss: 0.21718266606330872, Train Acc: 0.956357421875, Train F1: 0.9566849208285036, Train ROC AUC: 0.9564013949200645
Batch [1700/1970], Train Loss: 0.0564989410340786, Train Acc: 0.9573069852941176, Train F1: 0.9576158758268045, Train ROC AUC: 0.9573523998280419
Batch [1800/1970], Train Loss: 0.0884750708937645, Train Acc: 0.9580729166666667, Train F1: 0.9583657539970707, Train ROC AUC: 0.9581241379097925
Batch [1900/1970], Train Loss: 0.029002681374549866, Train Acc: 0.9586759868421053, Train F1: 0.9589541475977003, Train ROC AUC: 0.9587353573779887
--------------------------------------------------
Train Loss: 0.12424192606651124, Train Acc: 0.9591554994882536, Train F1: 0.9594240687571987, Train ROC AUC: 0.9592050564207274
Valid Loss: 0.06807401202249563, Valid Acc: 0.9776578863852745, Valid F1: 0.9776683985861698, Valid ROC AUC: 0.977828062063775
Confusion Matrix for the validation set:
 [[6801  144]
 [ 208 8602]]
Saved the new best model to ../data/models/80_20_split/cnr/all/5_epochs/shufflenet.pth with accuracy 0.9776578863852745
Epoch time: 337.039767742157 seconds.
==================================================
Epoch 2/5
Batch [100/1970], Train Loss: 0.03332192078232765, Train Acc: 0.97453125, Train F1: 0.9745463837766338, Train ROC AUC: 0.9748622360908246
Batch [200/1970], Train Loss: 0.09574839472770691, Train Acc: 0.976015625, Train F1: 0.9760285303869694, Train ROC AUC: 0.9762687867833613
Batch [300/1970], Train Loss: 0.1228521466255188, Train Acc: 0.9758333333333333, Train F1: 0.9758438731733817, Train ROC AUC: 0.975989425205685
Batch [400/1970], Train Loss: 0.15681001543998718, Train Acc: 0.9765625, Train F1: 0.9765713413730893, Train ROC AUC: 0.9766675240746847
Batch [500/1970], Train Loss: 0.1119336485862732, Train Acc: 0.9769375, Train F1: 0.9769462626450645, Train ROC AUC: 0.9770623585608883
Batch [600/1970], Train Loss: 0.035329125821590424, Train Acc: 0.9765625, Train F1: 0.9765711921875788, Train ROC AUC: 0.9766662816741287
Batch [700/1970], Train Loss: 0.021508360281586647, Train Acc: 0.9770535714285714, Train F1: 0.9770625221007104, Train ROC AUC: 0.9771679042393276
Batch [800/1970], Train Loss: 0.07627971470355988, Train Acc: 0.97720703125, Train F1: 0.9772155427562863, Train ROC AUC: 0.9772997226278194
Batch [900/1970], Train Loss: 0.0933946892619133, Train Acc: 0.97734375, Train F1: 0.9773519976251641, Train ROC AUC: 0.9774323880842652
Batch [1000/1970], Train Loss: 0.03577915206551552, Train Acc: 0.977546875, Train F1: 0.977555403870728, Train ROC AUC: 0.977647980964865
Batch [1100/1970], Train Loss: 0.009872318245470524, Train Acc: 0.9776704545454545, Train F1: 0.9776790947733335, Train ROC AUC: 0.9777906429705493
Batch [1200/1970], Train Loss: 0.028444968163967133, Train Acc: 0.97796875, Train F1: 0.977977248811087, Train ROC AUC: 0.9780876973111806
Batch [1300/1970], Train Loss: 0.12497105449438095, Train Acc: 0.978233173076923, Train F1: 0.978241491064426, Train ROC AUC: 0.9783503799514788
Batch [1400/1970], Train Loss: 0.07133610546588898, Train Acc: 0.9781696428571428, Train F1: 0.9781778060675387, Train ROC AUC: 0.9782767032461092
Batch [1500/1970], Train Loss: 0.1334511786699295, Train Acc: 0.9780520833333334, Train F1: 0.9780604500944525, Train ROC AUC: 0.9781698311598844
Batch [1600/1970], Train Loss: 0.061074722558259964, Train Acc: 0.97822265625, Train F1: 0.978230756121954, Train ROC AUC: 0.9783321117490532
Batch [1700/1970], Train Loss: 0.03096115216612816, Train Acc: 0.9783180147058823, Train F1: 0.9783262463555052, Train ROC AUC: 0.9784359484284743
Batch [1800/1970], Train Loss: 0.12735943496227264, Train Acc: 0.9783246527777778, Train F1: 0.978332983969059, Train ROC AUC: 0.9784433084327632
Batch [1900/1970], Train Loss: 0.07909898459911346, Train Acc: 0.9786677631578947, Train F1: 0.978675765400828, Train ROC AUC: 0.9787799756994585
--------------------------------------------------
Train Loss: 0.06271246093677517, Train Acc: 0.9788081466847564, Train F1: 0.9788160084313391, Train ROC AUC: 0.9789187934550779
Valid Loss: 0.060481891081751386, Valid Acc: 0.9809584258965408, Valid F1: 0.9809800783107451, Valid ROC AUC: 0.9819375358030381
Confusion Matrix for the validation set:
 [[6877   68]
 [ 232 8578]]
Saved the new best model to ../data/models/80_20_split/cnr/all/5_epochs/shufflenet.pth with accuracy 0.9809584258965408
Epoch time: 368.7872545719147 seconds.
==================================================
Epoch 3/5
Batch [100/1970], Train Loss: 0.11873143911361694, Train Acc: 0.97734375, Train F1: 0.9773503882345739, Train ROC AUC: 0.9774549113985985
Batch [200/1970], Train Loss: 0.016616860404610634, Train Acc: 0.979609375, Train F1: 0.9796155155603447, Train ROC AUC: 0.9797101987623711
Batch [300/1970], Train Loss: 0.01902640610933304, Train Acc: 0.9798958333333333, Train F1: 0.9799031325320967, Train ROC AUC: 0.9800477346073795
Batch [400/1970], Train Loss: 0.06325985491275787, Train Acc: 0.9798046875, Train F1: 0.9798116781085221, Train ROC AUC: 0.9799409965827319
Batch [500/1970], Train Loss: 0.010693784803152084, Train Acc: 0.9805, Train F1: 0.9805065291039736, Train ROC AUC: 0.9806430729892285
Batch [600/1970], Train Loss: 0.018137942999601364, Train Acc: 0.9811458333333334, Train F1: 0.981151569962805, Train ROC AUC: 0.9812713017407524
Batch [700/1970], Train Loss: 0.008923746645450592, Train Acc: 0.9816071428571429, Train F1: 0.9816126493227885, Train ROC AUC: 0.9817275383623375
Batch [800/1970], Train Loss: 0.022415222600102425, Train Acc: 0.98150390625, Train F1: 0.9815097625242108, Train ROC AUC: 0.981628148263169
Batch [900/1970], Train Loss: 0.017072251066565514, Train Acc: 0.9817534722222222, Train F1: 0.9817593370549619, Train ROC AUC: 0.9818704183531515
Batch [1000/1970], Train Loss: 0.0416649729013443, Train Acc: 0.981984375, Train F1: 0.9819903099964188, Train ROC AUC: 0.9821157290695227
Batch [1100/1970], Train Loss: 0.017313463613390923, Train Acc: 0.9821590909090909, Train F1: 0.9821647214649271, Train ROC AUC: 0.9822823977569566
Batch [1200/1970], Train Loss: 0.06640373915433884, Train Acc: 0.9822135416666666, Train F1: 0.9822189435907063, Train ROC AUC: 0.9823205844533477
Batch [1300/1970], Train Loss: 0.06883996725082397, Train Acc: 0.9821274038461538, Train F1: 0.9821328987452994, Train ROC AUC: 0.9822296846049657
Batch [1400/1970], Train Loss: 0.06315357983112335, Train Acc: 0.9820200892857143, Train F1: 0.9820256330924962, Train ROC AUC: 0.9821234020058216
Batch [1500/1970], Train Loss: 0.14764972031116486, Train Acc: 0.9820625, Train F1: 0.9820680194063319, Train ROC AUC: 0.9821612053559209
Batch [1600/1970], Train Loss: 0.01294663269072771, Train Acc: 0.98189453125, Train F1: 0.9819000553876103, Train ROC AUC: 0.9819797568128105
Batch [1700/1970], Train Loss: 0.15985824167728424, Train Acc: 0.9819485294117647, Train F1: 0.9819539847564653, Train ROC AUC: 0.9820301823820036
Batch [1800/1970], Train Loss: 0.03614382818341255, Train Acc: 0.9820399305555556, Train F1: 0.9820453372626872, Train ROC AUC: 0.9821197035110005
Batch [1900/1970], Train Loss: 0.02955433912575245, Train Acc: 0.9822368421052632, Train F1: 0.9822422389921209, Train ROC AUC: 0.9823226814913668
--------------------------------------------------
Train Loss: 0.05136794957189306, Train Acc: 0.9821483826434675, Train F1: 0.9821539534061883, Train ROC AUC: 0.9822394840746552
Valid Loss: 0.03644889213619867, Valid Acc: 0.9880672802284989, Valid F1: 0.9880618373503756, Valid ROC AUC: 0.9874557186389902
Confusion Matrix for the validation set:
 [[6822  123]
 [  65 8745]]
Saved the new best model to ../data/models/80_20_split/cnr/all/5_epochs/shufflenet.pth with accuracy 0.9880672802284989
Epoch time: 398.8315398693085 seconds.
==================================================
Epoch 4/5
Batch [100/1970], Train Loss: 0.022635584697127342, Train Acc: 0.983125, Train F1: 0.9831270711985871, Train ROC AUC: 0.9829599886767434
Batch [200/1970], Train Loss: 0.022855257615447044, Train Acc: 0.985625, Train F1: 0.9856279759251555, Train ROC AUC: 0.9856234122757968
Batch [300/1970], Train Loss: 0.011482413858175278, Train Acc: 0.98484375, Train F1: 0.9848470253092013, Train ROC AUC: 0.9848465338035051
Batch [400/1970], Train Loss: 0.035871800035238266, Train Acc: 0.984921875, Train F1: 0.984925757793398, Train ROC AUC: 0.9849546218224127
Batch [500/1970], Train Loss: 0.017182521522045135, Train Acc: 0.98475, Train F1: 0.9847539096513465, Train ROC AUC: 0.9847707236594018
Batch [600/1970], Train Loss: 0.06109027564525604, Train Acc: 0.98453125, Train F1: 0.9845353794852884, Train ROC AUC: 0.9845782303564057
Batch [700/1970], Train Loss: 0.03967902064323425, Train Acc: 0.9845535714285715, Train F1: 0.984557881667927, Train ROC AUC: 0.984625575940719
Batch [800/1970], Train Loss: 0.010801593773066998, Train Acc: 0.984609375, Train F1: 0.9846139259944647, Train ROC AUC: 0.9846964717834366
Batch [900/1970], Train Loss: 0.0034449815284460783, Train Acc: 0.9846701388888889, Train F1: 0.9846747911987942, Train ROC AUC: 0.9847684708293349
Batch [1000/1970], Train Loss: 0.024346359074115753, Train Acc: 0.984703125, Train F1: 0.9847078599269765, Train ROC AUC: 0.9848125290335241
Batch [1100/1970], Train Loss: 0.07872547209262848, Train Acc: 0.985028409090909, Train F1: 0.9850329705034876, Train ROC AUC: 0.9851387360604402
Batch [1200/1970], Train Loss: 0.0014948968309909105, Train Acc: 0.9851041666666667, Train F1: 0.9851085662030145, Train ROC AUC: 0.9852121644156053
Batch [1300/1970], Train Loss: 0.02498088963329792, Train Acc: 0.9850841346153846, Train F1: 0.9850885577073516, Train ROC AUC: 0.985191838394405
Batch [1400/1970], Train Loss: 0.0108257494866848, Train Acc: 0.985234375, Train F1: 0.9852387398209159, Train ROC AUC: 0.9853396635681422
Batch [1500/1970], Train Loss: 0.03379415348172188, Train Acc: 0.9852291666666667, Train F1: 0.9852334789687438, Train ROC AUC: 0.9853329100063724
Batch [1600/1970], Train Loss: 0.12208863347768784, Train Acc: 0.985390625, Train F1: 0.985394946807378, Train ROC AUC: 0.9854975314757191
Batch [1700/1970], Train Loss: 0.009894018061459064, Train Acc: 0.9853860294117647, Train F1: 0.9853905216406046, Train ROC AUC: 0.985507656701812
Batch [1800/1970], Train Loss: 0.03614343702793121, Train Acc: 0.9853732638888889, Train F1: 0.9853776772673395, Train ROC AUC: 0.9854906152332088
Batch [1900/1970], Train Loss: 0.08201021701097488, Train Acc: 0.9855263157894737, Train F1: 0.9855306542495794, Train ROC AUC: 0.9856459017757699
--------------------------------------------------
Train Loss: 0.04336221398591291, Train Acc: 0.9856076293845556, Train F1: 0.9856119475080356, Train ROC AUC: 0.9857304689142247
Valid Loss: 0.03404903508485238, Valid Acc: 0.9892097746747064, Valid F1: 0.9892148515899115, Valid ROC AUC: 0.9895441236437749
Confusion Matrix for the validation set:
 [[6892   53]
 [ 117 8693]]
Saved the new best model to ../data/models/80_20_split/cnr/all/5_epochs/shufflenet.pth with accuracy 0.9892097746747064
Epoch time: 396.86071133613586 seconds.
==================================================
Epoch 5/5
Batch [100/1970], Train Loss: 0.018115898594260216, Train Acc: 0.9853125, Train F1: 0.9853159215225976, Train ROC AUC: 0.9853786887215383
Batch [200/1970], Train Loss: 0.015141470357775688, Train Acc: 0.987265625, Train F1: 0.9872680858300033, Train ROC AUC: 0.9873115714934482
Batch [300/1970], Train Loss: 0.005226541310548782, Train Acc: 0.9878645833333334, Train F1: 0.9878670310822015, Train ROC AUC: 0.9878994735652434
Batch [400/1970], Train Loss: 0.029622580856084824, Train Acc: 0.986796875, Train F1: 0.9867987461155097, Train ROC AUC: 0.9867688220553974
Batch [500/1970], Train Loss: 0.02362421154975891, Train Acc: 0.98690625, Train F1: 0.9869088552954128, Train ROC AUC: 0.9869418048224434
Batch [600/1970], Train Loss: 0.003776620840653777, Train Acc: 0.9873697916666667, Train F1: 0.9873723812101768, Train ROC AUC: 0.9874196378715444
Batch [700/1970], Train Loss: 0.02147180587053299, Train Acc: 0.9873660714285715, Train F1: 0.9873686345159652, Train ROC AUC: 0.9874138385335154
Batch [800/1970], Train Loss: 0.06716460734605789, Train Acc: 0.98736328125, Train F1: 0.987366193454836, Train ROC AUC: 0.9874404697036896
Batch [900/1970], Train Loss: 0.053745418787002563, Train Acc: 0.9874131944444444, Train F1: 0.9874162186998245, Train ROC AUC: 0.9874997196827762
Batch [1000/1970], Train Loss: 0.01114011462777853, Train Acc: 0.987, Train F1: 0.9870032588044805, Train ROC AUC: 0.9870898532734345
Batch [1100/1970], Train Loss: 0.01712353155016899, Train Acc: 0.9867755681818182, Train F1: 0.9867790893943292, Train ROC AUC: 0.9868758980303969
Batch [1200/1970], Train Loss: 0.01819729246199131, Train Acc: 0.9867447916666666, Train F1: 0.9867482475256649, Train ROC AUC: 0.9868420935149076
Batch [1300/1970], Train Loss: 0.015704242512583733, Train Acc: 0.9871033653846154, Train F1: 0.9871067392861151, Train ROC AUC: 0.9872083258437064
Batch [1400/1970], Train Loss: 0.04654238745570183, Train Acc: 0.9870982142857143, Train F1: 0.9871015427849771, Train ROC AUC: 0.9872006113250008
Batch [1500/1970], Train Loss: 0.017630822956562042, Train Acc: 0.9872083333333334, Train F1: 0.987211725934107, Train ROC AUC: 0.9873148845542035
Batch [1600/1970], Train Loss: 0.006040374282747507, Train Acc: 0.987333984375, Train F1: 0.9873372012454672, Train ROC AUC: 0.9874335675334446
Batch [1700/1970], Train Loss: 0.04592666029930115, Train Acc: 0.9873621323529411, Train F1: 0.9873654070329945, Train ROC AUC: 0.9874676182169255
Batch [1800/1970], Train Loss: 0.016850899904966354, Train Acc: 0.9874131944444444, Train F1: 0.9874165036408158, Train ROC AUC: 0.987523240523567
Batch [1900/1970], Train Loss: 0.17092998325824738, Train Acc: 0.9874917763157894, Train F1: 0.9874950871072695, Train ROC AUC: 0.9876044350091174
--------------------------------------------------
Train Loss: 0.03825555272429335, Train Acc: 0.9875435381112195, Train F1: 0.9875468023477529, Train ROC AUC: 0.9876514225016698
Valid Loss: 0.028615016370035166, Valid Acc: 0.9911139320850524, Valid F1: 0.9911151388490084, Valid ROC AUC: 0.9911248099017006
Confusion Matrix for the validation set:
 [[6884   61]
 [  79 8731]]
Saved the new best model to ../data/models/80_20_split/cnr/all/5_epochs/shufflenet.pth with accuracy 0.9911139320850524
Epoch time: 399.3339536190033 seconds.
==================================================
Average Train Loss: 0.06398802065707715
Average Train Accuracy: 0.9786526392624506
Average Train F1: 0.9787105560901029
Average Train ROC AUC: 0.978749045073271

Best Validation Accuracy: 0.9911139320850524

Average Valid Loss: 0.04553376933906665
Average Valid Accuracy: 0.9854014598540145
Average Valid F1: 0.9854080609372421
Average Valid ROC AUC: 0.9855780500102558

Total training time: 1900.8562190532684 seconds.
