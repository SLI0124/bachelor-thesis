Train split file: ../data/splits/cnr/all_train_80_20.txt
Validation split file: ../data/splits/cnr/all_valid_80_20.txt

**************************************************
Train dataset size: 126039
Train dataset class distribution: {'empty': 55925, 'occupied': 70114}
Valid dataset size: 15755
Valid dataset class distribution: {'empty': 6945, 'occupied': 8810}
Training the model...
**************************************************
Epoch 1/5
Batch [100/1970], Train Loss: 0.13996532559394836, Train Acc: 0.90875, Train F1: 0.913403072149745, Train ROC AUC: 0.9117743171530839
Batch [200/1970], Train Loss: 0.11454135924577713, Train Acc: 0.9271875, Train F1: 0.929568459401373, Train ROC AUC: 0.9286420651172441
Batch [300/1970], Train Loss: 0.08861039578914642, Train Acc: 0.9359895833333334, Train F1: 0.9375935445093554, Train ROC AUC: 0.9368351325597206
Batch [400/1970], Train Loss: 0.07075817137956619, Train Acc: 0.941953125, Train F1: 0.9431650645507749, Train ROC AUC: 0.9425551756058572
Batch [500/1970], Train Loss: 0.04350633919239044, Train Acc: 0.946125, Train F1: 0.947103364823505, Train ROC AUC: 0.9466854867228148
Batch [600/1970], Train Loss: 0.0399872362613678, Train Acc: 0.9494791666666667, Train F1: 0.9502989092003069, Train ROC AUC: 0.9499422984535258
Batch [700/1970], Train Loss: 0.0999753475189209, Train Acc: 0.9522991071428571, Train F1: 0.9530058023117275, Train ROC AUC: 0.9526773525004083
Batch [800/1970], Train Loss: 0.1571132242679596, Train Acc: 0.95447265625, Train F1: 0.955092548961717, Train ROC AUC: 0.9547900281226284
Batch [900/1970], Train Loss: 0.08084180951118469, Train Acc: 0.9565277777777778, Train F1: 0.9570807727169828, Train ROC AUC: 0.956794089058087
Batch [1000/1970], Train Loss: 0.03449047729372978, Train Acc: 0.957984375, Train F1: 0.9584837116332457, Train ROC AUC: 0.9582143756403165
Batch [1100/1970], Train Loss: 0.051094576716423035, Train Acc: 0.9596448863636363, Train F1: 0.9600996511952117, Train ROC AUC: 0.9598509103612068
Batch [1200/1970], Train Loss: 0.13424858450889587, Train Acc: 0.9606640625, Train F1: 0.9610821531983106, Train ROC AUC: 0.9608486532141725
Batch [1300/1970], Train Loss: 0.08497252315282822, Train Acc: 0.9615745192307692, Train F1: 0.9619612528184308, Train ROC AUC: 0.9617275885136755
Batch [1400/1970], Train Loss: 0.0300977174192667, Train Acc: 0.962421875, Train F1: 0.962782282828808, Train ROC AUC: 0.9625826414004444
Batch [1500/1970], Train Loss: 0.16581952571868896, Train Acc: 0.9630729166666666, Train F1: 0.9634094375104186, Train ROC AUC: 0.9632237775579771
Batch [1600/1970], Train Loss: 0.04441823065280914, Train Acc: 0.963828125, Train F1: 0.9641445002808539, Train ROC AUC: 0.9639681125552907
Batch [1700/1970], Train Loss: 0.07888717204332352, Train Acc: 0.9645220588235294, Train F1: 0.9648204878660797, Train ROC AUC: 0.9646511662602831
Batch [1800/1970], Train Loss: 0.14371028542518616, Train Acc: 0.9651388888888889, Train F1: 0.965421636973379, Train ROC AUC: 0.9652689159279688
Batch [1900/1970], Train Loss: 0.07233860343694687, Train Acc: 0.9656332236842106, Train F1: 0.9659016515866284, Train ROC AUC: 0.965751974630122
--------------------------------------------------
Train Loss: 0.10512459690961513, Train Acc: 0.9658677076143098, Train F1: 0.9661272452461637, Train ROC AUC: 0.9659891324058504
Valid Loss: 0.06866617632373745, Valid Acc: 0.9799428752776896, Valid F1: 0.9799394719669409, Valid ROC AUC: 0.9794901810806328
Confusion Matrix for the validation set:
 [[6776  169]
 [ 147 8663]]
Saved the new best model to ../data/models/80_20_split/cnr/all/5_epochs/mobilenet.pth with accuracy 0.9799428752776896
Epoch time: 511.4444193840027 seconds.
==================================================
Epoch 2/5
Batch [100/1970], Train Loss: 0.018556442111730576, Train Acc: 0.9746875, Train F1: 0.9746978040389598, Train ROC AUC: 0.9746611550538573
Batch [200/1970], Train Loss: 0.03401849791407585, Train Acc: 0.976875, Train F1: 0.9768790496489237, Train ROC AUC: 0.9766906976728039
Batch [300/1970], Train Loss: 0.06758730858564377, Train Acc: 0.9763020833333333, Train F1: 0.9763076758409659, Train ROC AUC: 0.9761802992378787
Batch [400/1970], Train Loss: 0.20551960170269012, Train Acc: 0.976875, Train F1: 0.9768803407268394, Train ROC AUC: 0.9768041400168687
Batch [500/1970], Train Loss: 0.14416207373142242, Train Acc: 0.97703125, Train F1: 0.9770379202276613, Train ROC AUC: 0.9770305591503402
Batch [600/1970], Train Loss: 0.1526332050561905, Train Acc: 0.976640625, Train F1: 0.9766482539922583, Train ROC AUC: 0.976686274408511
Batch [700/1970], Train Loss: 0.07412755489349365, Train Acc: 0.9764508928571428, Train F1: 0.9764598701390969, Train ROC AUC: 0.9765509267761825
Batch [800/1970], Train Loss: 0.1080218106508255, Train Acc: 0.9767578125, Train F1: 0.9767668796993432, Train ROC AUC: 0.9768719138376624
Batch [900/1970], Train Loss: 0.0837613120675087, Train Acc: 0.9768229166666667, Train F1: 0.9768327288474156, Train ROC AUC: 0.9769727412802766
Batch [1000/1970], Train Loss: 0.08271970599889755, Train Acc: 0.97728125, Train F1: 0.9772905348679469, Train ROC AUC: 0.9774186785200631
Batch [1100/1970], Train Loss: 0.02124309353530407, Train Acc: 0.9775142045454546, Train F1: 0.9775230851570652, Train ROC AUC: 0.9776314470818077
Batch [1200/1970], Train Loss: 0.033710867166519165, Train Acc: 0.9774609375, Train F1: 0.9774699047859553, Train ROC AUC: 0.977582831995876
Batch [1300/1970], Train Loss: 0.022729147225618362, Train Acc: 0.9776802884615384, Train F1: 0.9776889925701008, Train ROC AUC: 0.9777947955591979
Batch [1400/1970], Train Loss: 0.2041006088256836, Train Acc: 0.9778683035714286, Train F1: 0.9778768064602867, Train ROC AUC: 0.9779795940874151
Batch [1500/1970], Train Loss: 0.08590546250343323, Train Acc: 0.9779375, Train F1: 0.977945343531077, Train ROC AUC: 0.9780234576267054
Batch [1600/1970], Train Loss: 0.16319262981414795, Train Acc: 0.977822265625, Train F1: 0.9778300746874615, Train ROC AUC: 0.9779024692335598
Batch [1700/1970], Train Loss: 0.02470352128148079, Train Acc: 0.9778768382352941, Train F1: 0.9778847393114504, Train ROC AUC: 0.9779574969025641
Batch [1800/1970], Train Loss: 0.04708370566368103, Train Acc: 0.9779427083333333, Train F1: 0.9779503243367627, Train ROC AUC: 0.978014886124773
Batch [1900/1970], Train Loss: 0.020416701212525368, Train Acc: 0.9781332236842105, Train F1: 0.9781410559955923, Train ROC AUC: 0.9782207848006154
--------------------------------------------------
Train Loss: 0.06371962708364322, Train Acc: 0.9781258181991288, Train F1: 0.9781337471292866, Train ROC AUC: 0.9782186600278244
Valid Loss: 0.049875336092131344, Valid Acc: 0.9824817518248176, Valid F1: 0.9824670703489877, Valid ROC AUC: 0.9814402770593336
Confusion Matrix for the validation set:
 [[6755  190]
 [  86 8724]]
Saved the new best model to ../data/models/80_20_split/cnr/all/5_epochs/mobilenet.pth with accuracy 0.9824817518248176
Epoch time: 522.8330211639404 seconds.
==================================================
Epoch 3/5
Batch [100/1970], Train Loss: 0.058709051460027695, Train Acc: 0.97953125, Train F1: 0.9795363046534046, Train ROC AUC: 0.9795487705654414
Batch [200/1970], Train Loss: 0.0709032341837883, Train Acc: 0.98203125, Train F1: 0.9820358370260953, Train ROC AUC: 0.9820721353375848
Batch [300/1970], Train Loss: 0.06771677732467651, Train Acc: 0.98109375, Train F1: 0.9810977880294228, Train ROC AUC: 0.981096581309999
Batch [400/1970], Train Loss: 0.05298995226621628, Train Acc: 0.9809765625, Train F1: 0.9809814328023486, Train ROC AUC: 0.981025165263499
Batch [500/1970], Train Loss: 0.04998604953289032, Train Acc: 0.9814375, Train F1: 0.9814423622881356, Train ROC AUC: 0.9814836931547928
Batch [600/1970], Train Loss: 0.004758157767355442, Train Acc: 0.981640625, Train F1: 0.9816464296486613, Train ROC AUC: 0.9817364715628768
Batch [700/1970], Train Loss: 0.028042219579219818, Train Acc: 0.9819196428571428, Train F1: 0.9819248771589485, Train ROC AUC: 0.9820040106875958
Batch [800/1970], Train Loss: 0.12571276724338531, Train Acc: 0.98216796875, Train F1: 0.9821736367154478, Train ROC AUC: 0.982272722135349
Batch [900/1970], Train Loss: 0.026915330439805984, Train Acc: 0.9822048611111112, Train F1: 0.9822105734305392, Train ROC AUC: 0.9823175941283139
Batch [1000/1970], Train Loss: 0.0797218382358551, Train Acc: 0.98203125, Train F1: 0.9820367464683865, Train ROC AUC: 0.9821332599163962
Batch [1100/1970], Train Loss: 0.04473691061139107, Train Acc: 0.98234375, Train F1: 0.9823492189412055, Train ROC AUC: 0.982449450066912
Batch [1200/1970], Train Loss: 0.08583370596170425, Train Acc: 0.9823958333333334, Train F1: 0.9824013292388384, Train ROC AUC: 0.982502403772959
Batch [1300/1970], Train Loss: 0.08096740394830704, Train Acc: 0.9824038461538461, Train F1: 0.9824094043545372, Train ROC AUC: 0.982508418882682
Batch [1400/1970], Train Loss: 0.0721302479505539, Train Acc: 0.9824441964285714, Train F1: 0.9824496724572799, Train ROC AUC: 0.982544869954167
Batch [1500/1970], Train Loss: 0.03099529817700386, Train Acc: 0.9823125, Train F1: 0.9823179148965734, Train ROC AUC: 0.9824054057938393
Batch [1600/1970], Train Loss: 0.013482967391610146, Train Acc: 0.98232421875, Train F1: 0.9823297064777521, Train ROC AUC: 0.9824218088437511
Batch [1700/1970], Train Loss: 0.008129008114337921, Train Acc: 0.9822610294117647, Train F1: 0.9822666576774913, Train ROC AUC: 0.9823607351587541
Batch [1800/1970], Train Loss: 0.017384374514222145, Train Acc: 0.9823524305555555, Train F1: 0.9823581826231406, Train ROC AUC: 0.9824616370213917
Batch [1900/1970], Train Loss: 0.047976069152355194, Train Acc: 0.9824013157894737, Train F1: 0.9824068601477693, Train ROC AUC: 0.9824976733902276
--------------------------------------------------
Train Loss: 0.05274951206272005, Train Acc: 0.9823546679995875, Train F1: 0.9823602349588803, Train ROC AUC: 0.9824520359326937
Valid Loss: 0.04692405885319237, Valid Acc: 0.983941605839416, Valid F1: 0.9839547881874791, Valid ROC AUC: 0.9845897186340871
Confusion Matrix for the validation set:
 [[6876   69]
 [ 184 8626]]
Saved the new best model to ../data/models/80_20_split/cnr/all/5_epochs/mobilenet.pth with accuracy 0.983941605839416
Epoch time: 527.7874524593353 seconds.
==================================================
Epoch 4/5
Batch [100/1970], Train Loss: 0.034295108169317245, Train Acc: 0.981875, Train F1: 0.9818779736039701, Train ROC AUC: 0.9817276006592814
Batch [200/1970], Train Loss: 0.2887907326221466, Train Acc: 0.983515625, Train F1: 0.9835184786366041, Train ROC AUC: 0.983463975532407
Batch [300/1970], Train Loss: 0.05619967728853226, Train Acc: 0.9831770833333333, Train F1: 0.9831805394238802, Train ROC AUC: 0.9831678958737183
Batch [400/1970], Train Loss: 0.033294711261987686, Train Acc: 0.9834765625, Train F1: 0.9834803092202329, Train ROC AUC: 0.9835042090809936
Batch [500/1970], Train Loss: 0.013083646073937416, Train Acc: 0.984, Train F1: 0.9840038012105308, Train ROC AUC: 0.9840585982912989
Batch [600/1970], Train Loss: 0.016887230798602104, Train Acc: 0.9841666666666666, Train F1: 0.9841711043215643, Train ROC AUC: 0.9842635474305229
Batch [700/1970], Train Loss: 0.0043671815656125546, Train Acc: 0.9846205357142858, Train F1: 0.9846249984446549, Train ROC AUC: 0.9847274799404792
Batch [800/1970], Train Loss: 0.004919382277876139, Train Acc: 0.9846484375, Train F1: 0.9846530214544464, Train ROC AUC: 0.9847644518766909
Batch [900/1970], Train Loss: 0.06870953738689423, Train Acc: 0.9844618055555555, Train F1: 0.9844662641964059, Train ROC AUC: 0.9845627544371675
Batch [1000/1970], Train Loss: 0.03860567882657051, Train Acc: 0.98459375, Train F1: 0.9845981240801408, Train ROC AUC: 0.9846886574022278
Batch [1100/1970], Train Loss: 0.034201011061668396, Train Acc: 0.9847301136363636, Train F1: 0.9847341763664582, Train ROC AUC: 0.9848129083240865
Batch [1200/1970], Train Loss: 0.10963835567235947, Train Acc: 0.9848828125, Train F1: 0.9848868400254831, Train ROC AUC: 0.9849682624505492
Batch [1300/1970], Train Loss: 0.05182528495788574, Train Acc: 0.984891826923077, Train F1: 0.984895834183106, Train ROC AUC: 0.9849749437392317
Batch [1400/1970], Train Loss: 0.10918650031089783, Train Acc: 0.9847321428571428, Train F1: 0.9847362292496259, Train ROC AUC: 0.9848149851448649
Batch [1500/1970], Train Loss: 0.052612725645303726, Train Acc: 0.98465625, Train F1: 0.9846606005072072, Train ROC AUC: 0.9847595830182168
Batch [1600/1970], Train Loss: 0.012693959288299084, Train Acc: 0.9846484375, Train F1: 0.9846526910295714, Train ROC AUC: 0.9847456138860091
Batch [1700/1970], Train Loss: 0.01889435015618801, Train Acc: 0.9847518382352941, Train F1: 0.9847561126494175, Train ROC AUC: 0.9848527520139668
Batch [1800/1970], Train Loss: 0.021495921537280083, Train Acc: 0.9848350694444444, Train F1: 0.9848393950947588, Train ROC AUC: 0.9849374338132324
Batch [1900/1970], Train Loss: 0.013053173199295998, Train Acc: 0.9848766447368421, Train F1: 0.9848809685187989, Train ROC AUC: 0.9849786213362698
--------------------------------------------------
Train Loss: 0.04549757259756653, Train Acc: 0.9849808392640373, Train F1: 0.9849851773152248, Train ROC AUC: 0.9850838727947355
Valid Loss: 0.0308637738370182, Valid Acc: 0.9907965725166614, Valid F1: 0.9907992489193818, Valid ROC AUC: 0.9909629658685194
Confusion Matrix for the validation set:
 [[6892   53]
 [  92 8718]]
Saved the new best model to ../data/models/80_20_split/cnr/all/5_epochs/mobilenet.pth with accuracy 0.9907965725166614
Epoch time: 544.7948787212372 seconds.
==================================================
Epoch 5/5
Batch [100/1970], Train Loss: 0.041241299360990524, Train Acc: 0.989375, Train F1: 0.9893790374534412, Train ROC AUC: 0.9896531887151795
Batch [200/1970], Train Loss: 0.002581941895186901, Train Acc: 0.98859375, Train F1: 0.9885968328202133, Train ROC AUC: 0.9887323943661972
Batch [300/1970], Train Loss: 0.00871241744607687, Train Acc: 0.9875, Train F1: 0.987503286117657, Train ROC AUC: 0.9876133806178817
Batch [400/1970], Train Loss: 0.00644909031689167, Train Acc: 0.987890625, Train F1: 0.9878934202683305, Train ROC AUC: 0.9879873196796555
Batch [500/1970], Train Loss: 0.06216038018465042, Train Acc: 0.9875625, Train F1: 0.9875657661256245, Train ROC AUC: 0.9876740260056908
Batch [600/1970], Train Loss: 0.06631062924861908, Train Acc: 0.9874479166666666, Train F1: 0.9874514506981386, Train ROC AUC: 0.9875780272125863
Batch [700/1970], Train Loss: 0.11638224124908447, Train Acc: 0.9875223214285714, Train F1: 0.9875261256464946, Train ROC AUC: 0.9876752097751395
Batch [800/1970], Train Loss: 0.05637529492378235, Train Acc: 0.98728515625, Train F1: 0.9872887766370201, Train ROC AUC: 0.9874137027219496
Batch [900/1970], Train Loss: 0.01854603923857212, Train Acc: 0.9871527777777778, Train F1: 0.9871562161104562, Train ROC AUC: 0.9872609655247836
Batch [1000/1970], Train Loss: 0.007901040837168694, Train Acc: 0.986953125, Train F1: 0.9869565763132716, Train ROC AUC: 0.9870628305672208
Batch [1100/1970], Train Loss: 0.01246607769280672, Train Acc: 0.9870170454545455, Train F1: 0.9870205636262214, Train ROC AUC: 0.987132924200209
Batch [1200/1970], Train Loss: 0.019934404641389847, Train Acc: 0.9870833333333333, Train F1: 0.9870868426604508, Train ROC AUC: 0.98720352048003
Batch [1300/1970], Train Loss: 0.008823889307677746, Train Acc: 0.9872235576923077, Train F1: 0.987226940339755, Train ROC AUC: 0.9873357923714913
Batch [1400/1970], Train Loss: 0.0033625748474150896, Train Acc: 0.9872991071428572, Train F1: 0.987302627235418, Train ROC AUC: 0.9874213101188754
Batch [1500/1970], Train Loss: 0.12784825265407562, Train Acc: 0.9873125, Train F1: 0.9873160128823372, Train ROC AUC: 0.987437513299876
Batch [1600/1970], Train Loss: 0.021109456196427345, Train Acc: 0.987470703125, Train F1: 0.9874741024283711, Train ROC AUC: 0.9875944797193166
Batch [1700/1970], Train Loss: 0.012445594184100628, Train Acc: 0.9874080882352941, Train F1: 0.9874114850092996, Train ROC AUC: 0.9875256145588974
Batch [1800/1970], Train Loss: 0.041357241570949554, Train Acc: 0.9874913194444445, Train F1: 0.9874946535808082, Train ROC AUC: 0.9876051713229038
Batch [1900/1970], Train Loss: 0.09674175828695297, Train Acc: 0.9873930921052632, Train F1: 0.9873964475375117, Train ROC AUC: 0.9875042614671639
--------------------------------------------------
Train Loss: 0.038791655242173616, Train Acc: 0.9874007251723673, Train F1: 0.9874040704631755, Train ROC AUC: 0.9875103950066173
Valid Loss: 0.03209841409735834, Valid Acc: 0.9898444938114884, Valid F1: 0.9898455688785922, Valid ROC AUC: 0.989806849504253
Confusion Matrix for the validation set:
 [[6872   73]
 [  87 8723]]
Epoch time: 535.5424308776855 seconds.
==================================================
Average Train Loss: 0.0611765927791437
Average Train Accuracy: 0.9797459516498861
Average Train F1: 0.979802095022546
Average Train ROC AUC: 0.9798508192335442

Best Validation Accuracy: 0.9907965725166614

Average Valid Loss: 0.04568555184068754
Average Valid Accuracy: 0.9854014598540146
Average Valid F1: 0.9854012296602763
Average Valid ROC AUC: 0.9852579984293651

Total training time: 2642.4042847156525 seconds.
