Train split file: ../data/splits/cnr/all_train_80_20.txt
Validation split file: ../data/splits/cnr/all_valid_80_20.txt

**************************************************
Train dataset size: 126039
Train dataset class distribution: {'empty': 55925, 'occupied': 70114}
Valid dataset size: 15755
Valid dataset class distribution: {'empty': 6945, 'occupied': 8810}
Training the model...
**************************************************
Epoch 1/5
Batch [100/1970], Train Loss: 0.2749615013599396, Train Acc: 0.709375, Train F1: 0.7052960255680449, Train ROC AUC: 0.6982602372165451
Batch [200/1970], Train Loss: 0.1733405441045761, Train Acc: 0.8134375, Train F1: 0.813745079879162, Train ROC AUC: 0.8060291542415103
Batch [300/1970], Train Loss: 0.1930483877658844, Train Acc: 0.8540625, Train F1: 0.8547729595952304, Train ROC AUC: 0.8490835007049985
Batch [400/1970], Train Loss: 0.19353839755058289, Train Acc: 0.874375, Train F1: 0.8750551329739095, Train ROC AUC: 0.8703397127706637
Batch [500/1970], Train Loss: 0.1322949230670929, Train Acc: 0.88921875, Train F1: 0.8898446143729056, Train ROC AUC: 0.885919841202572
Batch [600/1970], Train Loss: 0.11538952589035034, Train Acc: 0.8992708333333334, Train F1: 0.8998401116768487, Train ROC AUC: 0.896544760221901
Batch [700/1970], Train Loss: 0.12426729500293732, Train Acc: 0.9072767857142857, Train F1: 0.9077969875140353, Train ROC AUC: 0.9049467439987433
Batch [800/1970], Train Loss: 0.1635519415140152, Train Acc: 0.9133203125, Train F1: 0.913797560970604, Train ROC AUC: 0.9112400465578666
Batch [900/1970], Train Loss: 0.12955552339553833, Train Acc: 0.9180555555555555, Train F1: 0.9184964009253733, Train ROC AUC: 0.9162437582611717
Batch [1000/1970], Train Loss: 0.08288975805044174, Train Acc: 0.922453125, Train F1: 0.9228626944846983, Train ROC AUC: 0.9208896256458847
Batch [1100/1970], Train Loss: 0.1102597787976265, Train Acc: 0.9255965909090909, Train F1: 0.9259766991685062, Train ROC AUC: 0.9241617867209013
Batch [1200/1970], Train Loss: 0.11754924058914185, Train Acc: 0.9285026041666666, Train F1: 0.9288577013037271, Train ROC AUC: 0.9272166478887779
Batch [1300/1970], Train Loss: 0.07209901511669159, Train Acc: 0.9307932692307692, Train F1: 0.9311284745057229, Train ROC AUC: 0.9296332377896647
Batch [1400/1970], Train Loss: 0.07050840556621552, Train Acc: 0.9331584821428571, Train F1: 0.9334755360214396, Train ROC AUC: 0.9320966403134967
Batch [1500/1970], Train Loss: 0.1689373254776001, Train Acc: 0.935125, Train F1: 0.9354258965657491, Train ROC AUC: 0.9341336332066035
Batch [1600/1970], Train Loss: 0.03620623052120209, Train Acc: 0.93712890625, Train F1: 0.9374147386780638, Train ROC AUC: 0.9362287831206968
Batch [1700/1970], Train Loss: 0.06311836838722229, Train Acc: 0.9387408088235294, Train F1: 0.9390128600368588, Train ROC AUC: 0.9378967007924969
Batch [1800/1970], Train Loss: 0.04912249371409416, Train Acc: 0.9400694444444444, Train F1: 0.9403291835019102, Train ROC AUC: 0.9392924616940069
Batch [1900/1970], Train Loss: 0.09534601122140884, Train Acc: 0.94125, Train F1: 0.941498930436266, Train ROC AUC: 0.9405431556846289
--------------------------------------------------
Train Loss: 0.16300435347818215, Train Acc: 0.9420496830346162, Train F1: 0.9422914814138731, Train ROC AUC: 0.9413764326259951
Valid Loss: 0.1038046230369734, Valid Acc: 0.966867661059981, Valid F1: 0.9669381578910442, Valid ROC AUC: 0.9690181652664155
Confusion Matrix for the validation set:
 [[6856   89]
 [ 433 8377]]
Saved the new best model to ../data/models/80_20_split/cnr/all/5_epochs/squeezenet.pth with accuracy 0.966867661059981
Epoch time: 437.33626794815063 seconds.
==================================================
Epoch 2/5
Batch [100/1970], Train Loss: 0.11514149606227875, Train Acc: 0.96765625, Train F1: 0.9676764734679637, Train ROC AUC: 0.9677985346201229
Batch [200/1970], Train Loss: 0.08192403614521027, Train Acc: 0.96484375, Train F1: 0.9648618592537794, Train ROC AUC: 0.9649246464178067
Batch [300/1970], Train Loss: 0.053003840148448944, Train Acc: 0.96515625, Train F1: 0.9651731403486413, Train ROC AUC: 0.9652330295487342
Batch [400/1970], Train Loss: 0.04959763586521149, Train Acc: 0.9638671875, Train F1: 0.9638883654828853, Train ROC AUC: 0.9639972614383753
Batch [500/1970], Train Loss: 0.14112012088298798, Train Acc: 0.96375, Train F1: 0.9637710115434037, Train ROC AUC: 0.9638554661087813
Batch [600/1970], Train Loss: 0.1974858045578003, Train Acc: 0.9640364583333333, Train F1: 0.9640595268331983, Train ROC AUC: 0.9641966019511572
Batch [700/1970], Train Loss: 0.11437898874282837, Train Acc: 0.9647544642857143, Train F1: 0.9647765740340521, Train ROC AUC: 0.9649091706714851
Batch [800/1970], Train Loss: 0.10000547766685486, Train Acc: 0.96541015625, Train F1: 0.9654315867205548, Train ROC AUC: 0.9655539772727274
Batch [900/1970], Train Loss: 0.13562065362930298, Train Acc: 0.9657118055555556, Train F1: 0.9657321719580629, Train ROC AUC: 0.965860562974356
Batch [1000/1970], Train Loss: 0.24118947982788086, Train Acc: 0.965375, Train F1: 0.9653957230591188, Train ROC AUC: 0.9655203911133116
Batch [1100/1970], Train Loss: 0.1934451311826706, Train Acc: 0.9656392045454546, Train F1: 0.9656584471813077, Train ROC AUC: 0.9657620621837979
Batch [1200/1970], Train Loss: 0.030673041939735413, Train Acc: 0.965859375, Train F1: 0.9658787734357844, Train ROC AUC: 0.9659827337369755
Batch [1300/1970], Train Loss: 0.059291448444128036, Train Acc: 0.96609375, Train F1: 0.9661123298465157, Train ROC AUC: 0.9661991030278478
Batch [1400/1970], Train Loss: 0.08219296485185623, Train Acc: 0.9659821428571429, Train F1: 0.9660004380775883, Train ROC AUC: 0.9660840191686938
Batch [1500/1970], Train Loss: 0.0839131772518158, Train Acc: 0.9658229166666666, Train F1: 0.9658417648438281, Train ROC AUC: 0.9659450149110976
Batch [1600/1970], Train Loss: 0.07802697271108627, Train Acc: 0.965498046875, Train F1: 0.9655175059237802, Train ROC AUC: 0.9656297023653178
Batch [1700/1970], Train Loss: 0.08232183754444122, Train Acc: 0.9656893382352941, Train F1: 0.9657085480299364, Train ROC AUC: 0.9658279242851465
Batch [1800/1970], Train Loss: 0.11566189676523209, Train Acc: 0.9659548611111111, Train F1: 0.9659738524989159, Train ROC AUC: 0.9661013039770339
Batch [1900/1970], Train Loss: 0.09678541123867035, Train Acc: 0.966233552631579, Train F1: 0.9662522279792813, Train ROC AUC: 0.9663794256865763
--------------------------------------------------
Train Loss: 0.09856705300103362, Train Acc: 0.9663516847959759, Train F1: 0.9663701837169072, Train ROC AUC: 0.9664960345759914
Valid Loss: 0.09845703262609509, Valid Acc: 0.9669946048873374, Valid F1: 0.9669204267154664, Valid ROC AUC: 0.9645595072031015
Confusion Matrix for the validation set:
 [[6556  389]
 [ 131 8679]]
Saved the new best model to ../data/models/80_20_split/cnr/all/5_epochs/squeezenet.pth with accuracy 0.9669946048873374
Epoch time: 446.99466609954834 seconds.
==================================================
Epoch 3/5
Batch [100/1970], Train Loss: 0.038827989250421524, Train Acc: 0.9696875, Train F1: 0.9697004889138914, Train ROC AUC: 0.9697131069191954
Batch [200/1970], Train Loss: 0.06379731744527817, Train Acc: 0.971171875, Train F1: 0.9711864179919678, Train ROC AUC: 0.9712424811808675
Batch [300/1970], Train Loss: 0.03357625752687454, Train Acc: 0.9722916666666667, Train F1: 0.9723071524161071, Train ROC AUC: 0.9725442714768141
Batch [400/1970], Train Loss: 0.04602671414613724, Train Acc: 0.9715234375, Train F1: 0.9715396172563672, Train ROC AUC: 0.9717494396784914
Batch [500/1970], Train Loss: 0.015347955748438835, Train Acc: 0.97178125, Train F1: 0.97179689657704, Train ROC AUC: 0.9719996907922842
Batch [600/1970], Train Loss: 0.056909315288066864, Train Acc: 0.971640625, Train F1: 0.9716555320338538, Train ROC AUC: 0.9718257990363819
Batch [700/1970], Train Loss: 0.06717477738857269, Train Acc: 0.9713169642857142, Train F1: 0.971331285389189, Train ROC AUC: 0.9714842972705435
Batch [800/1970], Train Loss: 0.08078617602586746, Train Acc: 0.9709375, Train F1: 0.9709524514673445, Train ROC AUC: 0.9711210537623116
Batch [900/1970], Train Loss: 0.0763554498553276, Train Acc: 0.9709027777777778, Train F1: 0.9709179310851821, Train ROC AUC: 0.9710762485324437
Batch [1000/1970], Train Loss: 0.03774454817175865, Train Acc: 0.971265625, Train F1: 0.9712801455272179, Train ROC AUC: 0.9714492731897676
Batch [1100/1970], Train Loss: 0.08760999888181686, Train Acc: 0.9709801136363636, Train F1: 0.9709942438697741, Train ROC AUC: 0.9711363458373091
Batch [1200/1970], Train Loss: 0.08595435321331024, Train Acc: 0.9708463541666666, Train F1: 0.9708608937258737, Train ROC AUC: 0.971005572600541
Batch [1300/1970], Train Loss: 0.058646898716688156, Train Acc: 0.9709615384615384, Train F1: 0.97097599440154, Train ROC AUC: 0.971117534358838
Batch [1400/1970], Train Loss: 0.05302989482879639, Train Acc: 0.9712388392857143, Train F1: 0.971253511820799, Train ROC AUC: 0.9714029966314742
Batch [1500/1970], Train Loss: 0.18997535109519958, Train Acc: 0.97134375, Train F1: 0.9713580218525776, Train ROC AUC: 0.9715043360624519
Batch [1600/1970], Train Loss: 0.05061120167374611, Train Acc: 0.971357421875, Train F1: 0.9713717060536533, Train ROC AUC: 0.9715156657484102
Batch [1700/1970], Train Loss: 0.0987936407327652, Train Acc: 0.97140625, Train F1: 0.9714206399139459, Train ROC AUC: 0.9715697844773085
Batch [1800/1970], Train Loss: 0.09182629734277725, Train Acc: 0.9715190972222222, Train F1: 0.9715338516913954, Train ROC AUC: 0.9716923092834543
Batch [1900/1970], Train Loss: 0.08097316324710846, Train Acc: 0.9717351973684211, Train F1: 0.9717498435067169, Train ROC AUC: 0.9719108178442123
--------------------------------------------------
Train Loss: 0.08259657597840589, Train Acc: 0.971730972159411, Train F1: 0.9717456285127775, Train ROC AUC: 0.9719099942339259
Valid Loss: 0.07205009381645001, Valid Acc: 0.9767058076801015, Valid F1: 0.976708448286198, Valid ROC AUC: 0.9764890590818569
Confusion Matrix for the validation set:
 [[6769  176]
 [ 191 8619]]
Saved the new best model to ../data/models/80_20_split/cnr/all/5_epochs/squeezenet.pth with accuracy 0.9767058076801015
Epoch time: 452.4902608394623 seconds.
==================================================
Epoch 4/5
Batch [100/1970], Train Loss: 0.026430318132042885, Train Acc: 0.97328125, Train F1: 0.9732970767476979, Train ROC AUC: 0.9735975861734096
Batch [200/1970], Train Loss: 0.0899009183049202, Train Acc: 0.97421875, Train F1: 0.9742323918825161, Train ROC AUC: 0.9744783553098173
Batch [300/1970], Train Loss: 0.06524886935949326, Train Acc: 0.97375, Train F1: 0.9737644364199363, Train ROC AUC: 0.9740434401053094
Batch [400/1970], Train Loss: 0.02844562940299511, Train Acc: 0.97390625, Train F1: 0.9739214650874283, Train ROC AUC: 0.9742043330929248
Batch [500/1970], Train Loss: 0.034672681242227554, Train Acc: 0.9741875, Train F1: 0.9742018979961556, Train ROC AUC: 0.9744323962539462
Batch [600/1970], Train Loss: 0.10408305376768112, Train Acc: 0.9738020833333333, Train F1: 0.9738154856557186, Train ROC AUC: 0.9739853409212034
Batch [700/1970], Train Loss: 0.05597080662846565, Train Acc: 0.974375, Train F1: 0.9743882969256089, Train ROC AUC: 0.9745725973055884
Batch [800/1970], Train Loss: 0.05401134490966797, Train Acc: 0.97400390625, Train F1: 0.97401804234922, Train ROC AUC: 0.9742273464864026
Batch [900/1970], Train Loss: 0.07334090024232864, Train Acc: 0.9736111111111111, Train F1: 0.973624834061527, Train ROC AUC: 0.9738096415852955
Batch [1000/1970], Train Loss: 0.057753901928663254, Train Acc: 0.97340625, Train F1: 0.9734199253542024, Train ROC AUC: 0.9735896101284983
Batch [1100/1970], Train Loss: 0.10497383773326874, Train Acc: 0.9738494318181818, Train F1: 0.973862634099878, Train ROC AUC: 0.974035931119513
Batch [1200/1970], Train Loss: 0.10145772993564606, Train Acc: 0.9738932291666667, Train F1: 0.9739059980167039, Train ROC AUC: 0.9740709559999738
Batch [1300/1970], Train Loss: 0.027577903121709824, Train Acc: 0.9743389423076924, Train F1: 0.9743515642812541, Train ROC AUC: 0.9745203069401436
Batch [1400/1970], Train Loss: 0.02284941077232361, Train Acc: 0.9742633928571428, Train F1: 0.9742758126890083, Train ROC AUC: 0.9744240339441851
Batch [1500/1970], Train Loss: 0.05411380156874657, Train Acc: 0.9741875, Train F1: 0.9741997940803737, Train ROC AUC: 0.9743402043087139
Batch [1600/1970], Train Loss: 0.019211042672395706, Train Acc: 0.974208984375, Train F1: 0.9742212332524288, Train ROC AUC: 0.9743527326276661
Batch [1700/1970], Train Loss: 0.032965321093797684, Train Acc: 0.9744393382352942, Train F1: 0.9744514130686138, Train ROC AUC: 0.9745915763815373
Batch [1800/1970], Train Loss: 0.05344109609723091, Train Acc: 0.9746788194444445, Train F1: 0.9746907149521912, Train ROC AUC: 0.9748389077203405
Batch [1900/1970], Train Loss: 0.04101959988474846, Train Acc: 0.9746957236842105, Train F1: 0.974707558748132, Train ROC AUC: 0.9748575838544984
--------------------------------------------------
Train Loss: 0.07469361225559097, Train Acc: 0.9746269011972485, Train F1: 0.9746387707674334, Train ROC AUC: 0.9747879119756292
Valid Loss: 0.06958922866245483, Valid Acc: 0.9763884481117105, Valid F1: 0.9764243390948191, Valid ROC AUC: 0.9777903079898899
Confusion Matrix for the validation set:
 [[6873   72]
 [ 300 8510]]
Epoch time: 454.72310185432434 seconds.
==================================================
Epoch 5/5
Batch [100/1970], Train Loss: 0.05139216408133507, Train Acc: 0.9765625, Train F1: 0.9765755105382147, Train ROC AUC: 0.9768311930231539
Batch [200/1970], Train Loss: 0.07735548913478851, Train Acc: 0.97546875, Train F1: 0.9754790006274172, Train ROC AUC: 0.9754447429762674
Batch [300/1970], Train Loss: 0.03719530999660492, Train Acc: 0.9758333333333333, Train F1: 0.9758432902936227, Train ROC AUC: 0.9758727300531842
Batch [400/1970], Train Loss: 0.07203749567270279, Train Acc: 0.976015625, Train F1: 0.9760257612634139, Train ROC AUC: 0.9761035996678532
Batch [500/1970], Train Loss: 0.024231137707829475, Train Acc: 0.97671875, Train F1: 0.9767286300930426, Train ROC AUC: 0.9768576759750779
Batch [600/1970], Train Loss: 0.03744548186659813, Train Acc: 0.9769270833333333, Train F1: 0.9769377077751884, Train ROC AUC: 0.9770900703656424
Batch [700/1970], Train Loss: 0.1303684413433075, Train Acc: 0.97640625, Train F1: 0.9764171002457236, Train ROC AUC: 0.9765588835339869
Batch [800/1970], Train Loss: 0.06587399542331696, Train Acc: 0.97666015625, Train F1: 0.9766708181287743, Train ROC AUC: 0.9768176970434816
Batch [900/1970], Train Loss: 0.11265110224485397, Train Acc: 0.9769270833333333, Train F1: 0.9769378890028418, Train ROC AUC: 0.977090305621991
Batch [1000/1970], Train Loss: 0.022320061922073364, Train Acc: 0.977125, Train F1: 0.9771350070298481, Train ROC AUC: 0.9772646338253097
Batch [1100/1970], Train Loss: 0.06592826545238495, Train Acc: 0.9770738636363636, Train F1: 0.9770840464389154, Train ROC AUC: 0.977217995269013
Batch [1200/1970], Train Loss: 0.09544642269611359, Train Acc: 0.9769140625, Train F1: 0.9769241468577899, Train ROC AUC: 0.9770547465095365
Batch [1300/1970], Train Loss: 0.07237505912780762, Train Acc: 0.9767307692307692, Train F1: 0.9767408075126476, Train ROC AUC: 0.9768639032374076
Batch [1400/1970], Train Loss: 0.03735299035906792, Train Acc: 0.9765401785714286, Train F1: 0.9765500863267185, Train ROC AUC: 0.976662830600496
Batch [1500/1970], Train Loss: 0.08820386230945587, Train Acc: 0.9765416666666666, Train F1: 0.9765513660722427, Train ROC AUC: 0.9766613421851139
Batch [1600/1970], Train Loss: 0.13385550677776337, Train Acc: 0.97642578125, Train F1: 0.9764352969038422, Train ROC AUC: 0.9765327763195908
Batch [1700/1970], Train Loss: 0.08066686242818832, Train Acc: 0.9764705882352941, Train F1: 0.976480280117219, Train ROC AUC: 0.9765878260922151
Batch [1800/1970], Train Loss: 0.19300511479377747, Train Acc: 0.9765190972222222, Train F1: 0.9765286999763193, Train ROC AUC: 0.9766373249316189
Batch [1900/1970], Train Loss: 0.08009568601846695, Train Acc: 0.9766858552631579, Train F1: 0.9766953475815859, Train ROC AUC: 0.9768048931789253
--------------------------------------------------
Train Loss: 0.06852077719162167, Train Acc: 0.9767770293321908, Train F1: 0.976786235002116, Train ROC AUC: 0.976888744021184
Valid Loss: 0.05526984528768506, Valid Acc: 0.9829895271342431, Valid F1: 0.9829928490793828, Valid ROC AUC: 0.9829459046227493
Confusion Matrix for the validation set:
 [[6824  121]
 [ 147 8663]]
Saved the new best model to ../data/models/80_20_split/cnr/all/5_epochs/squeezenet.pth with accuracy 0.9829895271342431
Epoch time: 452.9859232902527 seconds.
==================================================
Average Train Loss: 0.09747647438096688
Average Train Accuracy: 0.9663072541038884
Average Train F1: 0.9663664598826214
Average Train ROC AUC: 0.9662918234865451

Best Validation Accuracy: 0.9829895271342431

Average Valid Loss: 0.07983416468593167
Average Valid Accuracy: 0.9739892097746747
Average Valid F1: 0.9739968442133821
Average Valid ROC AUC: 0.9741605888328027

Total training time: 2244.532196044922 seconds.
