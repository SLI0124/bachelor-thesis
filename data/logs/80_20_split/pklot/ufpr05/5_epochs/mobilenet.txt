Dataset: pklot
Camera view: ufpr05
Model: mobilenet
Train size split: 80
Valid size split: 20
Number of epochs: 5
**************************************************
Train split file: ../data/splits/pklot/ufpr05_train_80_20.txt
Validation split file: ../data/splits/pklot/ufpr05_valid_80_20.txt

**************************************************
Train dataset size: 132628
Train dataset class distribution: {'empty': 54636, 'occupied': 77992}
Valid dataset size: 16578
Valid dataset class distribution: {'empty': 6810, 'occupied': 9768}
Training the model...
**************************************************
Epoch 1/5
Batch [100/2073], Train Loss: 0.07664577662944794, Train Acc: 0.95609375, Train F1: 0.9609165120295918, Train ROC AUC: 0.9544426044640406
Batch [200/2073], Train Loss: 0.059152357280254364, Train Acc: 0.970703125, Train F1: 0.9731338297506398, Train ROC AUC: 0.9694663470871975
Batch [300/2073], Train Loss: 0.036987971514463425, Train Acc: 0.9761979166666667, Train F1: 0.9778256526230056, Train ROC AUC: 0.9752010343596262
Batch [400/2073], Train Loss: 0.03717052936553955, Train Acc: 0.9790625, Train F1: 0.9802850078782365, Train ROC AUC: 0.9781227275821727
Batch [500/2073], Train Loss: 0.0019452304113656282, Train Acc: 0.98134375, Train F1: 0.9823237059020608, Train ROC AUC: 0.980496536531779
Batch [600/2073], Train Loss: 0.008368386887013912, Train Acc: 0.9832552083333334, Train F1: 0.9840736156443582, Train ROC AUC: 0.9824994278174939
Batch [700/2073], Train Loss: 0.0010103167733177543, Train Acc: 0.9843973214285714, Train F1: 0.9850998755695579, Train ROC AUC: 0.9837184546009201
Batch [800/2073], Train Loss: 0.026040228083729744, Train Acc: 0.98552734375, Train F1: 0.9861433040501584, Train ROC AUC: 0.9849572419140746
Batch [900/2073], Train Loss: 0.004935025703161955, Train Acc: 0.9865798611111111, Train F1: 0.9871279450033869, Train ROC AUC: 0.9860396420723466
Batch [1000/2073], Train Loss: 0.008183371275663376, Train Acc: 0.98728125, Train F1: 0.9877748320601586, Train ROC AUC: 0.9867778348296647
Batch [1100/2073], Train Loss: 0.017321094870567322, Train Acc: 0.9877272727272727, Train F1: 0.9881762331480106, Train ROC AUC: 0.9872427292870655
Batch [1200/2073], Train Loss: 0.021931031718850136, Train Acc: 0.9882942708333333, Train F1: 0.9887060186866895, Train ROC AUC: 0.9878282853203475
Batch [1300/2073], Train Loss: 0.009472161531448364, Train Acc: 0.9886658653846154, Train F1: 0.9890459363004701, Train ROC AUC: 0.9882148745079143
Batch [1400/2073], Train Loss: 0.0004278847191017121, Train Acc: 0.9890848214285715, Train F1: 0.9894378784624444, Train ROC AUC: 0.988659892572687
Batch [1500/2073], Train Loss: 0.000752661086153239, Train Acc: 0.9894375, Train F1: 0.9897671790176843, Train ROC AUC: 0.9890362016207378
Batch [1600/2073], Train Loss: 0.0011159240966662765, Train Acc: 0.989736328125, Train F1: 0.990045445006252, Train ROC AUC: 0.989347744382184
Batch [1700/2073], Train Loss: 0.1038496121764183, Train Acc: 0.9900459558823529, Train F1: 0.9903369835336303, Train ROC AUC: 0.9896727499864425
Batch [1800/2073], Train Loss: 0.013250140473246574, Train Acc: 0.9903472222222223, Train F1: 0.9906221817079063, Train ROC AUC: 0.9899867732322785
Batch [1900/2073], Train Loss: 0.02050994336605072, Train Acc: 0.9905921052631579, Train F1: 0.9908526313573238, Train ROC AUC: 0.9902381749970628
Batch [2000/2073], Train Loss: 0.0027386846486479044, Train Acc: 0.9908046875, Train F1: 0.9910522043028698, Train ROC AUC: 0.990456279611252
--------------------------------------------------
Train Loss: 0.03709979885154815, Train Acc: 0.99090689748771, Train F1: 0.9911458384898681, Train ROC AUC: 0.9905682967592735
Valid Loss: 0.012523918284792811, Valid Acc: 0.9965617082880927, Valid F1: 0.9965621270785537, Valid ROC AUC: 0.9965709301612385
Confusion Matrix for the validation set:
 [[6787   23]
 [  34 9734]]
Saved the new best model to ../data/models/80_20_split/pklot/ufpr05/5_epochs/mobilenet.pth with accuracy 0.9965617082880927
Epoch time: 786.9732346534729 seconds.
==================================================
Epoch 2/5
Batch [100/2073], Train Loss: 0.005156173836439848, Train Acc: 0.99546875, Train F1: 0.9954686108104127, Train ROC AUC: 0.9952695111520948
Batch [200/2073], Train Loss: 0.003879479831084609, Train Acc: 0.99640625, Train F1: 0.9964064662944222, Train ROC AUC: 0.9963374009993541
Batch [300/2073], Train Loss: 0.007069799117743969, Train Acc: 0.9964583333333333, Train F1: 0.9964584010743499, Train ROC AUC: 0.996361698278726
Batch [400/2073], Train Loss: 0.027799265459179878, Train Acc: 0.9965625, Train F1: 0.996562596273744, Train ROC AUC: 0.9964832304657506
Batch [500/2073], Train Loss: 0.00824225228279829, Train Acc: 0.9964375, Train F1: 0.9964377448429909, Train ROC AUC: 0.9963899839662951
Batch [600/2073], Train Loss: 0.024486351758241653, Train Acc: 0.99625, Train F1: 0.9962502808269835, Train ROC AUC: 0.9962070415914926
Batch [700/2073], Train Loss: 0.008518385700881481, Train Acc: 0.9961160714285714, Train F1: 0.9961161954821391, Train ROC AUC: 0.9960272725834256
Batch [800/2073], Train Loss: 0.0011834806064143777, Train Acc: 0.99595703125, Train F1: 0.9959571625224624, Train ROC AUC: 0.9958557299722062
Batch [900/2073], Train Loss: 0.03914153203368187, Train Acc: 0.9956944444444444, Train F1: 0.995694554749602, Train ROC AUC: 0.9955780321129007
Batch [1000/2073], Train Loss: 0.032098282128572464, Train Acc: 0.995546875, Train F1: 0.995546939173915, Train ROC AUC: 0.9954144713611885
Batch [1100/2073], Train Loss: 0.0013956031762063503, Train Acc: 0.9955539772727273, Train F1: 0.9955540584527702, Train ROC AUC: 0.9954268947522286
Batch [1200/2073], Train Loss: 0.0005504313157871366, Train Acc: 0.995625, Train F1: 0.9956251254613708, Train ROC AUC: 0.9955107321962218
Batch [1300/2073], Train Loss: 0.0030278468038886786, Train Acc: 0.9956370192307692, Train F1: 0.9956371827447342, Train ROC AUC: 0.9955320534868988
Batch [1400/2073], Train Loss: 0.016979027539491653, Train Acc: 0.9956138392857142, Train F1: 0.9956139727545422, Train ROC AUC: 0.9955036058623334
Batch [1500/2073], Train Loss: 0.05901582911610603, Train Acc: 0.9955520833333333, Train F1: 0.9955522610207639, Train ROC AUC: 0.995448018915396
Batch [1600/2073], Train Loss: 0.0034363530576229095, Train Acc: 0.995498046875, Train F1: 0.995498215141902, Train ROC AUC: 0.9953902441128784
Batch [1700/2073], Train Loss: 0.055900689214468, Train Acc: 0.9954871323529412, Train F1: 0.9954872457976659, Train ROC AUC: 0.9953667040503555
Batch [1800/2073], Train Loss: 0.005176172591745853, Train Acc: 0.9955381944444445, Train F1: 0.9955383212178459, Train ROC AUC: 0.9954234143439668
Batch [1900/2073], Train Loss: 0.007469714619219303, Train Acc: 0.9954605263157895, Train F1: 0.9954606754709204, Train ROC AUC: 0.9953480243323253
Batch [2000/2073], Train Loss: 0.0034338952973484993, Train Acc: 0.9955, Train F1: 0.9955001404896656, Train ROC AUC: 0.9953870880516904
--------------------------------------------------
Train Loss: 0.015296755396771165, Train Acc: 0.995551467261815, Train F1: 0.9955516498840654, Train ROC AUC: 0.9954502036176482
Valid Loss: 0.022732532311759385, Valid Acc: 0.9930630956689589, Valid F1: 0.9930701718061793, Valid ROC AUC: 0.993891092734705
Confusion Matrix for the validation set:
 [[6800   10]
 [ 105 9663]]
Epoch time: 775.2183744907379 seconds.
==================================================
Epoch 3/5
Batch [100/2073], Train Loss: 0.014548915438354015, Train Acc: 0.996875, Train F1: 0.996875, Train ROC AUC: 0.996779517408671
Batch [200/2073], Train Loss: 0.0013038067845627666, Train Acc: 0.99640625, Train F1: 0.9964066397557275, Train ROC AUC: 0.9964091888953687
Batch [300/2073], Train Loss: 0.002066450659185648, Train Acc: 0.99625, Train F1: 0.9962502753067732, Train ROC AUC: 0.996210023391213
Batch [400/2073], Train Loss: 0.00729997456073761, Train Acc: 0.996328125, Train F1: 0.9963283849205602, Train ROC AUC: 0.9962816820345616
Batch [500/2073], Train Loss: 0.0005260012112557888, Train Acc: 0.99653125, Train F1: 0.9965314629320294, Train ROC AUC: 0.9964850272770235
Batch [600/2073], Train Loss: 0.000334098789608106, Train Acc: 0.9963020833333334, Train F1: 0.996302220434602, Train ROC AUC: 0.9962253006010591
Batch [700/2073], Train Loss: 0.06472218781709671, Train Acc: 0.99625, Train F1: 0.99625015082534, Train ROC AUC: 0.9961719274449036
Batch [800/2073], Train Loss: 0.008130867034196854, Train Acc: 0.99630859375, Train F1: 0.9963087364643249, Train ROC AUC: 0.9962311139872915
Batch [900/2073], Train Loss: 9.529044473310933e-05, Train Acc: 0.9964236111111111, Train F1: 0.9964236784504946, Train ROC AUC: 0.9963290480577702
Batch [1000/2073], Train Loss: 0.0001354451960651204, Train Acc: 0.996390625, Train F1: 0.9963907174576383, Train ROC AUC: 0.9963000374124458
Batch [1100/2073], Train Loss: 0.0019107498228549957, Train Acc: 0.9964346590909091, Train F1: 0.9964347416806799, Train ROC AUC: 0.9963442203288507
Batch [1200/2073], Train Loss: 0.001597472932189703, Train Acc: 0.996484375, Train F1: 0.9964845402789532, Train ROC AUC: 0.9964200533266315
Batch [1300/2073], Train Loss: 0.006404704414308071, Train Acc: 0.9964543269230769, Train F1: 0.9964544888987019, Train ROC AUC: 0.9963871718867299
Batch [1400/2073], Train Loss: 0.019383277744054794, Train Acc: 0.9964174107142857, Train F1: 0.9964175629053236, Train ROC AUC: 0.9963455738813466
Batch [1500/2073], Train Loss: 0.0008793242159299552, Train Acc: 0.99646875, Train F1: 0.9964688892307636, Train ROC AUC: 0.9963967243604701
Batch [1600/2073], Train Loss: 0.0019336857367306948, Train Acc: 0.996416015625, Train F1: 0.9964161616141269, Train ROC AUC: 0.9963422699385995
Batch [1700/2073], Train Loss: 0.00021554129489231855, Train Acc: 0.9964246323529412, Train F1: 0.9964247931837136, Train ROC AUC: 0.9963555004714282
Batch [1800/2073], Train Loss: 0.010096913203597069, Train Acc: 0.9964322916666667, Train F1: 0.9964324556777708, Train ROC AUC: 0.9963627388637764
Batch [1900/2073], Train Loss: 0.0022301175631582737, Train Acc: 0.996389802631579, Train F1: 0.9963899701042883, Train ROC AUC: 0.996320095960245
Batch [2000/2073], Train Loss: 0.0018675317987799644, Train Acc: 0.9964375, Train F1: 0.9964376715298906, Train ROC AUC: 0.9963719301088548
--------------------------------------------------
Train Loss: 0.011660876551864919, Train Acc: 0.9964864131254335, Train F1: 0.9964865765683198, Train ROC AUC: 0.9964205528679811
Valid Loss: 0.009372921805219482, Valid Acc: 0.9978887682470744, Valid F1: 0.9978888385823093, Valid ROC AUC: 0.9978526935024732
Confusion Matrix for the validation set:
 [[6794   16]
 [  19 9749]]
Saved the new best model to ../data/models/80_20_split/pklot/ufpr05/5_epochs/mobilenet.pth with accuracy 0.9978887682470744
Epoch time: 755.9174664020538 seconds.
==================================================
Epoch 4/5
Batch [100/2073], Train Loss: 0.00017126215971074998, Train Acc: 0.99734375, Train F1: 0.9973436742904428, Train ROC AUC: 0.9972298031151801
Batch [200/2073], Train Loss: 0.0006966630462557077, Train Acc: 0.996640625, Train F1: 0.9966406737552583, Train ROC AUC: 0.996542858281095
Batch [300/2073], Train Loss: 0.002938034711405635, Train Acc: 0.9963541666666667, Train F1: 0.9963545059994635, Train ROC AUC: 0.9963339070581466
Batch [400/2073], Train Loss: 0.0007275737007148564, Train Acc: 0.996640625, Train F1: 0.9966409535140134, Train ROC AUC: 0.9966338783071709
Batch [500/2073], Train Loss: 0.0015469969948753715, Train Acc: 0.99678125, Train F1: 0.996781558286805, Train ROC AUC: 0.9967752745288067
Batch [600/2073], Train Loss: 0.002901294268667698, Train Acc: 0.996640625, Train F1: 0.9966409582871141, Train ROC AUC: 0.9966323315278803
Batch [700/2073], Train Loss: 0.0010663876309990883, Train Acc: 0.9968526785714286, Train F1: 0.9968529722113663, Train ROC AUC: 0.9968449408609652
Batch [800/2073], Train Loss: 0.027074839919805527, Train Acc: 0.99689453125, Train F1: 0.9968948061955661, Train ROC AUC: 0.9968838132299148
Batch [900/2073], Train Loss: 0.03216024860739708, Train Acc: 0.9969618055555556, Train F1: 0.9969620458984938, Train ROC AUC: 0.996942841758211
Batch [1000/2073], Train Loss: 0.0001784389460226521, Train Acc: 0.997078125, Train F1: 0.9970783464969113, Train ROC AUC: 0.9970621908069569
Batch [1100/2073], Train Loss: 0.05490056052803993, Train Acc: 0.9970880681818182, Train F1: 0.9970882531381519, Train ROC AUC: 0.9970609863089143
Batch [1200/2073], Train Loss: 0.00017657400167081505, Train Acc: 0.9971614583333334, Train F1: 0.997161616066536, Train ROC AUC: 0.997129726225635
Batch [1300/2073], Train Loss: 0.0023082424886524677, Train Acc: 0.9972235576923076, Train F1: 0.9972237287443277, Train ROC AUC: 0.9972007588660206
Batch [1400/2073], Train Loss: 0.0007609350141137838, Train Acc: 0.9971763392857143, Train F1: 0.99717651310677, Train ROC AUC: 0.9971509448144656
Batch [1500/2073], Train Loss: 0.00025774328969419, Train Acc: 0.9972395833333333, Train F1: 0.9972397425953462, Train ROC AUC: 0.9972115913752665
Batch [1600/2073], Train Loss: 0.000902069266885519, Train Acc: 0.997314453125, Train F1: 0.9973146096897574, Train ROC AUC: 0.9972873572561293
Batch [1700/2073], Train Loss: 0.0008474364294670522, Train Acc: 0.9973161764705882, Train F1: 0.9973163301309264, Train ROC AUC: 0.9972859685557286
Batch [1800/2073], Train Loss: 0.008627038449048996, Train Acc: 0.9973003472222223, Train F1: 0.997300505282812, Train ROC AUC: 0.9972717704659884
Batch [1900/2073], Train Loss: 0.0001014992012642324, Train Acc: 0.9972615131578947, Train F1: 0.9972616560437472, Train ROC AUC: 0.9972262724495055
Batch [2000/2073], Train Loss: 0.0023313891142606735, Train Acc: 0.997203125, Train F1: 0.9972032677899164, Train ROC AUC: 0.9971646631068584
--------------------------------------------------
Train Loss: 0.009761175132442474, Train Acc: 0.997134843321169, Train F1: 0.9971349922535514, Train ROC AUC: 0.9970952167243181
Valid Loss: 0.008571022448701953, Valid Acc: 0.99728555917481, Valid F1: 0.9972859496298571, Valid ROC AUC: 0.9973408179905976
Confusion Matrix for the validation set:
 [[6794   16]
 [  29 9739]]
Epoch time: 800.2708930969238 seconds.
==================================================
Epoch 5/5
Batch [100/2073], Train Loss: 0.003410406643524766, Train Acc: 0.99546875, Train F1: 0.9954686115498103, Train ROC AUC: 0.9952714002513671
Batch [200/2073], Train Loss: 0.013795346952974796, Train Acc: 0.99671875, Train F1: 0.996718651167966, Train ROC AUC: 0.9965711525671469
Batch [300/2073], Train Loss: 0.00292569724842906, Train Acc: 0.9963541666666667, Train F1: 0.996354093655336, Train ROC AUC: 0.9962041977349337
Batch [400/2073], Train Loss: 0.002262632828205824, Train Acc: 0.99671875, Train F1: 0.99671875, Train ROC AUC: 0.9966111319059604
Batch [500/2073], Train Loss: 0.005490080453455448, Train Acc: 0.9969375, Train F1: 0.9969375352904487, Train ROC AUC: 0.996848165272582
Batch [600/2073], Train Loss: 0.014562591910362244, Train Acc: 0.996875, Train F1: 0.9968750297552369, Train ROC AUC: 0.9967832954049292
Batch [700/2073], Train Loss: 0.0017561226850375533, Train Acc: 0.9967410714285714, Train F1: 0.9967412311994452, Train ROC AUC: 0.9966841040241077
Batch [800/2073], Train Loss: 0.0005813424359075725, Train Acc: 0.99697265625, Train F1: 0.9969727968782783, Train ROC AUC: 0.9969207414989704
Batch [900/2073], Train Loss: 0.009719162248075008, Train Acc: 0.9969965277777778, Train F1: 0.9969966898505312, Train ROC AUC: 0.9969529971974354
Batch [1000/2073], Train Loss: 0.00029002741212025285, Train Acc: 0.99703125, Train F1: 0.9970314017652558, Train ROC AUC: 0.9969871054965133
Batch [1100/2073], Train Loss: 0.0023404662497341633, Train Acc: 0.9971306818181818, Train F1: 0.9971308321310095, Train ROC AUC: 0.9970883895551187
Batch [1200/2073], Train Loss: 0.00040243874536827207, Train Acc: 0.9970052083333333, Train F1: 0.9970053809541843, Train ROC AUC: 0.9969639608254847
Batch [1300/2073], Train Loss: 0.0020543457940220833, Train Acc: 0.9969711538461539, Train F1: 0.9969713288704868, Train ROC AUC: 0.9969284366981817
Batch [1400/2073], Train Loss: 7.723865564912558e-05, Train Acc: 0.9969977678571429, Train F1: 0.9969979332085037, Train ROC AUC: 0.9969554551063066
Batch [1500/2073], Train Loss: 0.005517187993973494, Train Acc: 0.9969895833333333, Train F1: 0.9969897486178771, Train ROC AUC: 0.9969478853926206
Batch [1600/2073], Train Loss: 0.00039300258504226804, Train Acc: 0.997041015625, Train F1: 0.997041187987866, Train ROC AUC: 0.997005316303429
Batch [1700/2073], Train Loss: 0.03465436026453972, Train Acc: 0.9970955882352941, Train F1: 0.9970957811327261, Train ROC AUC: 0.9970698763281187
Batch [1800/2073], Train Loss: 0.002289696829393506, Train Acc: 0.9971006944444445, Train F1: 0.9971008771421619, Train ROC AUC: 0.9970709272530028
Batch [1900/2073], Train Loss: 0.05749630555510521, Train Acc: 0.9971299342105263, Train F1: 0.997130109581, Train ROC AUC: 0.9970994490931114
Batch [2000/2073], Train Loss: 9.144665818894282e-05, Train Acc: 0.9971484375, Train F1: 0.9971486110362588, Train ROC AUC: 0.9971183645343179
--------------------------------------------------
Train Loss: 0.009227114064826434, Train Acc: 0.9971650028651566, Train F1: 0.9971651579717117, Train ROC AUC: 0.9971290820639114
Valid Loss: 0.01168805169416793, Valid Acc: 0.9964410664736397, Valid F1: 0.996442970960361, Valid ROC AUC: 0.9968687650405713
Confusion Matrix for the validation set:
 [[6805    5]
 [  54 9714]]
Epoch time: 782.9208500385284 seconds.
==================================================
Average Train Loss: 0.01660914399949063
Average Train Accuracy: 0.9954489248122569
Average Train F1: 0.9954968430335033
Average Train ROC AUC: 0.9953326704066265

Best Validation Accuracy: 0.9978887682470744

Average Valid Loss: 0.012977689308928314
Average Valid Accuracy: 0.9962480395705151
Average Valid F1: 0.9962500116114521
Average Valid ROC AUC: 0.9965048598859172

Total training time: 3901.3043553829193 seconds.
