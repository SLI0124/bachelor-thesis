Dataset: pklot
Camera view: ufpr05_sunny
Model: mobilenet
Train size split: 80
Valid size split: 20
Number of epochs: 5
**************************************************
Train split file: ../data/splits/pklot/ufpr05_sunny_train_80_20.txt
Validation split file: ../data/splits/pklot/ufpr05_sunny_valid_80_20.txt

**************************************************
Train dataset size: 79912
Train dataset class distribution: {'empty': 33864, 'occupied': 46048}
Valid dataset size: 9989
Valid dataset class distribution: {'empty': 4170, 'occupied': 5819}
Training the model...
**************************************************
Epoch 1/5
Batch [100/1249], Train Loss: 0.03137217089533806, Train Acc: 0.954375, Train F1: 0.9591863499306202, Train ROC AUC: 0.9556600374434996
Batch [200/1249], Train Loss: 0.046608153730630875, Train Acc: 0.9671875, Train F1: 0.9696082315232201, Train ROC AUC: 0.9671748533114493
Batch [300/1249], Train Loss: 0.009694129228591919, Train Acc: 0.9736458333333333, Train F1: 0.9752678910873205, Train ROC AUC: 0.9733922739935398
Batch [400/1249], Train Loss: 0.010341840796172619, Train Acc: 0.977734375, Train F1: 0.9789563328625506, Train ROC AUC: 0.9774919029980792
Batch [500/1249], Train Loss: 0.002974514150992036, Train Acc: 0.980375, Train F1: 0.981354600212346, Train ROC AUC: 0.9800992995044314
Batch [600/1249], Train Loss: 0.0027671256102621555, Train Acc: 0.9820833333333333, Train F1: 0.9829012011098429, Train ROC AUC: 0.981824896547942
Batch [700/1249], Train Loss: 0.0013021311024203897, Train Acc: 0.9838169642857143, Train F1: 0.9845195861076363, Train ROC AUC: 0.9835862882947833
Batch [800/1249], Train Loss: 0.021622957661747932, Train Acc: 0.9851171875, Train F1: 0.9857329862251188, Train ROC AUC: 0.9849131124947028
Batch [900/1249], Train Loss: 0.006148234475404024, Train Acc: 0.9859375, Train F1: 0.9864851617122488, Train ROC AUC: 0.9857149206137875
Batch [1000/1249], Train Loss: 0.003299871226772666, Train Acc: 0.98678125, Train F1: 0.9872743771957471, Train ROC AUC: 0.9865476043797603
Batch [1100/1249], Train Loss: 0.0015623244689777493, Train Acc: 0.9873863636363637, Train F1: 0.9878349955211566, Train ROC AUC: 0.9871744892228798
Batch [1200/1249], Train Loss: 0.018559515476226807, Train Acc: 0.9878645833333334, Train F1: 0.988275982894923, Train ROC AUC: 0.9876571272174587
--------------------------------------------------
Train Loss: 0.052568204847316474, Train Acc: 0.9880868955851436, Train F1: 0.9884823227346875, Train ROC AUC: 0.9878810998039084
Valid Loss: 0.0253515548293722, Valid Acc: 0.9916908599459405, Valid F1: 0.9916910010222634, Valid ROC AUC: 0.9914750653507096
Confusion Matrix for the validation set:
 [[4129   41]
 [  42 5777]]
Saved the new best model to ../data/models/80_20_split/pklot/ufpr05_sunny/5_epochs/mobilenet.pth with accuracy 0.9916908599459405
Epoch time: 316.4270565509796 seconds.
==================================================
Epoch 2/5
Batch [100/1249], Train Loss: 0.08208215981721878, Train Acc: 0.99171875, Train F1: 0.99172020524026, Train ROC AUC: 0.9916842555940302
Batch [200/1249], Train Loss: 0.0008837947971187532, Train Acc: 0.99375, Train F1: 0.9937501552573574, Train ROC AUC: 0.9936203785233069
Batch [300/1249], Train Loss: 0.03696564957499504, Train Acc: 0.9940625, Train F1: 0.994062202619787, Train ROC AUC: 0.9938643397777632
Batch [400/1249], Train Loss: 0.01608305051922798, Train Acc: 0.9940625, Train F1: 0.9940621386569837, Train ROC AUC: 0.9938617653551968
Batch [500/1249], Train Loss: 0.001294190646149218, Train Acc: 0.9943125, Train F1: 0.9943122768570176, Train ROC AUC: 0.9941370031057013
Batch [600/1249], Train Loss: 0.06266125291585922, Train Acc: 0.99453125, Train F1: 0.9945310679728651, Train ROC AUC: 0.9943621827765566
Batch [700/1249], Train Loss: 0.09609620273113251, Train Acc: 0.9945982142857143, Train F1: 0.994597980601039, Train ROC AUC: 0.9944181031771593
Batch [800/1249], Train Loss: 0.0007115012849681079, Train Acc: 0.9944921875, Train F1: 0.9944918781893878, Train ROC AUC: 0.9942996674686009
Batch [900/1249], Train Loss: 0.010616502724587917, Train Acc: 0.9945138888888889, Train F1: 0.9945137080973728, Train ROC AUC: 0.9943473546112074
Batch [1000/1249], Train Loss: 0.011996543034911156, Train Acc: 0.99440625, Train F1: 0.9944060300660826, Train ROC AUC: 0.9942323549783872
Batch [1100/1249], Train Loss: 0.003333645174279809, Train Acc: 0.9943607954545455, Train F1: 0.9943605553954667, Train ROC AUC: 0.9941818226572323
Batch [1200/1249], Train Loss: 0.011691346764564514, Train Acc: 0.9945963541666667, Train F1: 0.9945961215949813, Train ROC AUC: 0.9944231542346212
--------------------------------------------------
Train Loss: 0.017560468845104617, Train Acc: 0.994543998398238, Train F1: 0.9945437634896588, Train ROC AUC: 0.9943711736329285
Valid Loss: 0.008543005376827315, Valid Acc: 0.9975973570928021, Valid F1: 0.9975976010677694, Valid ROC AUC: 0.9976319820582785
Confusion Matrix for the validation set:
 [[4161    9]
 [  15 5804]]
Saved the new best model to ../data/models/80_20_split/pklot/ufpr05_sunny/5_epochs/mobilenet.pth with accuracy 0.9975973570928021
Epoch time: 320.61535143852234 seconds.
==================================================
Epoch 3/5
Batch [100/1249], Train Loss: 0.00028876823489554226, Train Acc: 0.994375, Train F1: 0.9943760390867168, Train ROC AUC: 0.994438984740535
Batch [200/1249], Train Loss: 0.011709248647093773, Train Acc: 0.993828125, Train F1: 0.9938286721130237, Train ROC AUC: 0.9937578536317822
Batch [300/1249], Train Loss: 0.00031791816581971943, Train Acc: 0.99453125, Train F1: 0.9945316566893465, Train ROC AUC: 0.994470674495754
Batch [400/1249], Train Loss: 0.0175014715641737, Train Acc: 0.99484375, Train F1: 0.994844200675184, Train ROC AUC: 0.9948020431540056
Batch [500/1249], Train Loss: 0.001346485922113061, Train Acc: 0.994875, Train F1: 0.9948753572997536, Train ROC AUC: 0.9948171949571809
Batch [600/1249], Train Loss: 0.005378791131079197, Train Acc: 0.9947135416666667, Train F1: 0.9947137845872711, Train ROC AUC: 0.994626382064181
Batch [700/1249], Train Loss: 0.0009725510608404875, Train Acc: 0.995, Train F1: 0.9950001438156102, Train ROC AUC: 0.9949019805969722
Batch [800/1249], Train Loss: 0.04867951571941376, Train Acc: 0.995234375, Train F1: 0.9952344637878013, Train ROC AUC: 0.9951352835692542
Batch [900/1249], Train Loss: 0.004862106405198574, Train Acc: 0.9953298611111111, Train F1: 0.9953299757618166, Train ROC AUC: 0.995241627849469
Batch [1000/1249], Train Loss: 0.0011375289177522063, Train Acc: 0.99509375, Train F1: 0.9950938956035222, Train ROC AUC: 0.995003189102524
Batch [1100/1249], Train Loss: 0.004782676696777344, Train Acc: 0.9952414772727273, Train F1: 0.9952416149344193, Train ROC AUC: 0.9951561032521157
Batch [1200/1249], Train Loss: 0.014828352257609367, Train Acc: 0.9952994791666666, Train F1: 0.9952995651779287, Train ROC AUC: 0.9952056770656359
--------------------------------------------------
Train Loss: 0.015405823512861284, Train Acc: 0.9953198518370208, Train F1: 0.9953199431782646, Train ROC AUC: 0.9952279994359156
Valid Loss: 0.012148028977445526, Valid Acc: 0.9964961457603364, Valid F1: 0.9964967959595766, Valid ROC AUC: 0.9965848664941565
Confusion Matrix for the validation set:
 [[4158   12]
 [  23 5796]]
Epoch time: 322.5002443790436 seconds.
==================================================
Epoch 4/5
Batch [100/1249], Train Loss: 0.0030933511443436146, Train Acc: 0.9971875, Train F1: 0.9971873654233494, Train ROC AUC: 0.997075567776149
Batch [200/1249], Train Loss: 0.003735720179975033, Train Acc: 0.99625, Train F1: 0.9962499166200872, Train ROC AUC: 0.9961535029484865
Batch [300/1249], Train Loss: 0.00013608575682155788, Train Acc: 0.9964583333333333, Train F1: 0.9964583883447422, Train ROC AUC: 0.9963966940917262
Batch [400/1249], Train Loss: 0.0036280329804867506, Train Acc: 0.9964453125, Train F1: 0.9964452911749164, Train ROC AUC: 0.9963574063199183
Batch [500/1249], Train Loss: 0.0035033326130360365, Train Acc: 0.99665625, Train F1: 0.996656201235159, Train ROC AUC: 0.9965627275384444
Batch [600/1249], Train Loss: 0.020731128752231598, Train Acc: 0.99640625, Train F1: 0.9964062212775735, Train ROC AUC: 0.99631559874317
Batch [700/1249], Train Loss: 0.020280985161662102, Train Acc: 0.9961160714285714, Train F1: 0.9961160714285714, Train ROC AUC: 0.9960229843343112
Batch [800/1249], Train Loss: 0.0075304461643099785, Train Acc: 0.99615234375, Train F1: 0.9961523791243241, Train ROC AUC: 0.9960689648456501
Batch [900/1249], Train Loss: 0.005002738442271948, Train Acc: 0.9959027777777778, Train F1: 0.9959028224242304, Train ROC AUC: 0.9958150758547364
Batch [1000/1249], Train Loss: 0.0011798281921073794, Train Acc: 0.996046875, Train F1: 0.9960469231208496, Train ROC AUC: 0.9959652068169802
Batch [1100/1249], Train Loss: 0.001969778211787343, Train Acc: 0.9960511363636364, Train F1: 0.99605117120297, Train ROC AUC: 0.9959668700905265
Batch [1200/1249], Train Loss: 0.049397703260183334, Train Acc: 0.996015625, Train F1: 0.9960156892327688, Train ROC AUC: 0.9959383763466156
--------------------------------------------------
Train Loss: 0.01264142607701604, Train Acc: 0.9960581639803784, Train F1: 0.9960582178465371, Train ROC AUC: 0.9959780230967611
Valid Loss: 0.0056537103352702674, Valid Acc: 0.9986985684252678, Valid F1: 0.9986986786236167, Valid ROC AUC: 0.9987470549424012
Confusion Matrix for the validation set:
 [[4166    4]
 [   9 5810]]
Saved the new best model to ../data/models/80_20_split/pklot/ufpr05_sunny/5_epochs/mobilenet.pth with accuracy 0.9986985684252678
Epoch time: 325.469603061676 seconds.
==================================================
Epoch 5/5
Batch [100/1249], Train Loss: 0.14165659248828888, Train Acc: 0.9959375, Train F1: 0.9959375, Train ROC AUC: 0.9958599368879224
Batch [200/1249], Train Loss: 0.0004636081284843385, Train Acc: 0.99625, Train F1: 0.9962500857135145, Train ROC AUC: 0.9961941084933085
Batch [300/1249], Train Loss: 0.013514951802790165, Train Acc: 0.9969791666666666, Train F1: 0.9969792600205286, Train ROC AUC: 0.9969448577462413
Batch [400/1249], Train Loss: 0.00020505150314420462, Train Acc: 0.9968359375, Train F1: 0.9968359564816677, Train ROC AUC: 0.9967689528841933
Batch [500/1249], Train Loss: 0.003828513901680708, Train Acc: 0.99675, Train F1: 0.9967501587067424, Train ROC AUC: 0.9967210998922849
Batch [600/1249], Train Loss: 0.004935360513627529, Train Acc: 0.99671875, Train F1: 0.9967188876702768, Train ROC AUC: 0.9966774269053112
Batch [700/1249], Train Loss: 0.021191412582993507, Train Acc: 0.9965178571428571, Train F1: 0.9965179807710053, Train ROC AUC: 0.9964671896171226
Batch [800/1249], Train Loss: 0.00019958177290391177, Train Acc: 0.99662109375, Train F1: 0.9966211859240866, Train ROC AUC: 0.9965687120582843
Batch [900/1249], Train Loss: 0.0014783272054046392, Train Acc: 0.9966145833333333, Train F1: 0.9966147200788843, Train ROC AUC: 0.9965751915708907
Batch [1000/1249], Train Loss: 0.00032800514600239694, Train Acc: 0.996484375, Train F1: 0.9964844698990427, Train ROC AUC: 0.996426529901292
Batch [1100/1249], Train Loss: 0.00256702140904963, Train Acc: 0.9965767045454546, Train F1: 0.9965767881154108, Train ROC AUC: 0.9965193541931073
Batch [1200/1249], Train Loss: 0.0004795013228431344, Train Acc: 0.9966015625, Train F1: 0.9966016109097059, Train ROC AUC: 0.9965346445193631
--------------------------------------------------
Train Loss: 0.011371444081623012, Train Acc: 0.9966713384723196, Train F1: 0.9966714034369476, Train ROC AUC: 0.9966116509942807
Valid Loss: 0.005318258721811495, Valid Acc: 0.9988987886675343, Valid F1: 0.9988988073643963, Valid ROC AUC: 0.9988849271158773
Confusion Matrix for the validation set:
 [[4165    5]
 [   6 5813]]
Saved the new best model to ../data/models/80_20_split/pklot/ufpr05_sunny/5_epochs/mobilenet.pth with accuracy 0.9988987886675343
Epoch time: 325.41634035110474 seconds.
==================================================
Average Train Loss: 0.021909473472784286
Average Train Accuracy: 0.9941360496546201
Average Train F1: 0.9942151301372192
Average Train ROC AUC: 0.9940139893927589

Best Validation Accuracy: 0.9988987886675343

Average Valid Loss: 0.011402911648145362
Average Valid Accuracy: 0.9966763439783761
Average Valid F1: 0.9966765768075245
Average Valid ROC AUC: 0.9966647791922846

Total training time: 1610.430611371994 seconds.
