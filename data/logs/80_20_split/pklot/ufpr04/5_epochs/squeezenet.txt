Dataset: pklot
Camera view: ufpr04
Model: squeezenet
Train size split: 80
Valid size split: 20
Number of epochs: 5
**************************************************
Train split file: ../data/splits/pklot/ufpr04_train_80_20.txt
Validation split file: ../data/splits/pklot/ufpr04_valid_80_20.txt

**************************************************
Train dataset size: 84674
Train dataset class distribution: {'empty': 47856, 'occupied': 36818}
Valid dataset size: 10584
Valid dataset class distribution: {'empty': 5926, 'occupied': 4658}
Training the model...
**************************************************
Epoch 1/5
Batch [100/1324], Train Loss: 0.7408561110496521, Train Acc: 0.8071875, Train F1: 0.8113052548756682, Train ROC AUC: 0.8054606901723569
Batch [200/1324], Train Loss: 0.11764568835496902, Train Acc: 0.871171875, Train F1: 0.8733874822088135, Train ROC AUC: 0.8695273486174157
Batch [300/1324], Train Loss: 0.025777526199817657, Train Acc: 0.90234375, Train F1: 0.9038748106873352, Train ROC AUC: 0.9010984831060631
Batch [400/1324], Train Loss: 0.010808317922055721, Train Acc: 0.9216015625, Train F1: 0.9227734659980914, Train ROC AUC: 0.9205100706653522
Batch [500/1324], Train Loss: 0.0711856409907341, Train Acc: 0.93378125, Train F1: 0.9347307257068606, Train ROC AUC: 0.9328365471782736
Batch [600/1324], Train Loss: 0.10911549627780914, Train Acc: 0.9418489583333334, Train F1: 0.9426461932072613, Train ROC AUC: 0.9409964753267681
Batch [700/1324], Train Loss: 0.02032552845776081, Train Acc: 0.9441517857142857, Train F1: 0.9448418626661177, Train ROC AUC: 0.9434222944105956
Batch [800/1324], Train Loss: 0.00832315906882286, Train Acc: 0.94947265625, Train F1: 0.9500801082926708, Train ROC AUC: 0.9488359023050784
Batch [900/1324], Train Loss: 0.03756757080554962, Train Acc: 0.9532638888888889, Train F1: 0.9538051247608388, Train ROC AUC: 0.952665505654968
Batch [1000/1324], Train Loss: 0.013472691178321838, Train Acc: 0.95671875, Train F1: 0.9572066264012222, Train ROC AUC: 0.9561548844176398
Batch [1100/1324], Train Loss: 0.07137094438076019, Train Acc: 0.95953125, Train F1: 0.959976339639547, Train ROC AUC: 0.959033907202186
Batch [1200/1324], Train Loss: 0.08078982681035995, Train Acc: 0.9620442708333333, Train F1: 0.9624529698074821, Train ROC AUC: 0.9615900348286175
Batch [1300/1324], Train Loss: 0.10272064805030823, Train Acc: 0.9645192307692307, Train F1: 0.9648967702362048, Train ROC AUC: 0.9640748630378486
--------------------------------------------------
Train Loss: 0.11127135633848227, Train Acc: 0.9649597278975837, Train F1: 0.96533075694839, Train ROC AUC: 0.9645144440578148
Valid Loss: 0.023392119568335003, Valid Acc: 0.9928193499622071, Valid F1: 0.992816815758739, Valid ROC AUC: 0.9923702622888534
Confusion Matrix for the validation set:
 [[5903   23]
 [  53 4605]]
Saved the new best model to ../data/models/80_20_split/pklot/ufpr04/5_epochs/squeezenet.pth with accuracy 0.9928193499622071
Epoch time: 311.16209149360657 seconds.
==================================================
Epoch 2/5
Batch [100/1324], Train Loss: 0.008733157068490982, Train Acc: 0.991875, Train F1: 0.991875, Train ROC AUC: 0.9917537674974746
Batch [200/1324], Train Loss: 0.07643620669841766, Train Acc: 0.987265625, Train F1: 0.9872673192989271, Train ROC AUC: 0.9871813833810796
Batch [300/1324], Train Loss: 0.039726708084344864, Train Acc: 0.9882291666666667, Train F1: 0.9882299605697671, Train ROC AUC: 0.9881010919823339
Batch [400/1324], Train Loss: 0.24224717915058136, Train Acc: 0.989375, Train F1: 0.9893752180297636, Train ROC AUC: 0.9892149007788438
Batch [500/1324], Train Loss: 0.11085912585258484, Train Acc: 0.98965625, Train F1: 0.9896565489838042, Train ROC AUC: 0.9895070426799762
Batch [600/1324], Train Loss: 0.006452556699514389, Train Acc: 0.9901041666666667, Train F1: 0.9901044331919687, Train ROC AUC: 0.9899678893353702
Batch [700/1324], Train Loss: 0.006362625863403082, Train Acc: 0.9906026785714286, Train F1: 0.9906029259512453, Train ROC AUC: 0.9904698615613363
Batch [800/1324], Train Loss: 0.007371244020760059, Train Acc: 0.9909765625, Train F1: 0.9909768420721801, Train ROC AUC: 0.9908520111189999
Batch [900/1324], Train Loss: 0.001233333139680326, Train Acc: 0.9910243055555555, Train F1: 0.9910245728030401, Train ROC AUC: 0.9909000044977087
Batch [1000/1324], Train Loss: 0.0011859136866405606, Train Acc: 0.991328125, Train F1: 0.9913285361303679, Train ROC AUC: 0.9912264506220002
Batch [1100/1324], Train Loss: 0.013129670172929764, Train Acc: 0.9912215909090909, Train F1: 0.9912219515311476, Train ROC AUC: 0.9911128733403339
Batch [1200/1324], Train Loss: 0.0006165733211673796, Train Acc: 0.9912239583333333, Train F1: 0.991224138609389, Train ROC AUC: 0.9910950105427485
Batch [1300/1324], Train Loss: 0.0018421168206259608, Train Acc: 0.9913341346153847, Train F1: 0.9913343699465534, Train ROC AUC: 0.9912103957657314
--------------------------------------------------
Train Loss: 0.028813759395921158, Train Acc: 0.9913314594798875, Train F1: 0.9913316492979828, Train ROC AUC: 0.9912035309669933
Valid Loss: 0.05733019280537026, Valid Acc: 0.9845049130763417, Valid F1: 0.9844740651690064, Valid ROC AUC: 0.9825107193674032
Confusion Matrix for the validation set:
 [[5921    5]
 [ 159 4499]]
Epoch time: 318.6073696613312 seconds.
==================================================
Epoch 3/5
Batch [100/1324], Train Loss: 0.003583331359550357, Train Acc: 0.9915625, Train F1: 0.991562790174936, Train ROC AUC: 0.9914954232467655
Batch [200/1324], Train Loss: 0.0004217019013594836, Train Acc: 0.993046875, Train F1: 0.9930468057091556, Train ROC AUC: 0.9929257063423066
Batch [300/1324], Train Loss: 0.0055113136768341064, Train Acc: 0.9928645833333334, Train F1: 0.9928642280500333, Train ROC AUC: 0.992684961124873
Batch [400/1324], Train Loss: 0.0003663834067992866, Train Acc: 0.9933203125, Train F1: 0.9933199958829895, Train ROC AUC: 0.993154392178348
Batch [500/1324], Train Loss: 0.009915405884385109, Train Acc: 0.99384375, Train F1: 0.9938435174533519, Train ROC AUC: 0.9936974160149618
Batch [600/1324], Train Loss: 0.002862946130335331, Train Acc: 0.993984375, Train F1: 0.9939841869760352, Train ROC AUC: 0.9938484119840236
Batch [700/1324], Train Loss: 0.00037874054396525025, Train Acc: 0.9943080357142857, Train F1: 0.9943078810926805, Train ROC AUC: 0.9941789886770429
Batch [800/1324], Train Loss: 0.001138945110142231, Train Acc: 0.99439453125, Train F1: 0.9943943375090873, Train ROC AUC: 0.9942584185245272
Batch [900/1324], Train Loss: 0.002084923442453146, Train Acc: 0.9944618055555555, Train F1: 0.9944616627008759, Train ROC AUC: 0.9943370821343319
Batch [1000/1324], Train Loss: 0.0014678582083433867, Train Acc: 0.994328125, Train F1: 0.9943280172050822, Train ROC AUC: 0.9942075896409087
Batch [1100/1324], Train Loss: 0.016611916944384575, Train Acc: 0.9944318181818181, Train F1: 0.9944316684766841, Train ROC AUC: 0.9943052969598576
Batch [1200/1324], Train Loss: 0.012103430926799774, Train Acc: 0.9945052083333333, Train F1: 0.9945050756327214, Train ROC AUC: 0.994386557717137
Batch [1300/1324], Train Loss: 0.000736499612685293, Train Acc: 0.9946394230769231, Train F1: 0.9946392862632389, Train ROC AUC: 0.9945214069677546
--------------------------------------------------
Train Loss: 0.018369027365257584, Train Acc: 0.9946618796797128, Train F1: 0.9946617457142024, Train ROC AUC: 0.9945445401970847
Valid Loss: 0.01148053645265025, Valid Acc: 0.9964096749811036, Valid F1: 0.9964109601672464, Valid ROC AUC: 0.9967248852927337
Confusion Matrix for the validation set:
 [[5891   35]
 [   3 4655]]
Saved the new best model to ../data/models/80_20_split/pklot/ufpr04/5_epochs/squeezenet.pth with accuracy 0.9964096749811036
Epoch time: 318.42746090888977 seconds.
==================================================
Epoch 4/5
Batch [100/1324], Train Loss: 0.010714354924857616, Train Acc: 0.99359375, Train F1: 0.993594199277851, Train ROC AUC: 0.9935228713157869
Batch [200/1324], Train Loss: 0.0022484222427010536, Train Acc: 0.9934375, Train F1: 0.9934378054570808, Train ROC AUC: 0.9933410293302299
Batch [300/1324], Train Loss: 0.007807520218193531, Train Acc: 0.99390625, Train F1: 0.9939063937241955, Train ROC AUC: 0.9937937481923164
Batch [400/1324], Train Loss: 0.001354472478851676, Train Acc: 0.9940625, Train F1: 0.9940627066950302, Train ROC AUC: 0.9939687278381265
Batch [500/1324], Train Loss: 0.004003956448286772, Train Acc: 0.9939375, Train F1: 0.9939376100251948, Train ROC AUC: 0.9938302317194453
Batch [600/1324], Train Loss: 0.01681564375758171, Train Acc: 0.9943489583333334, Train F1: 0.9943490209993213, Train ROC AUC: 0.9942482763355122
Batch [700/1324], Train Loss: 0.0008851702441461384, Train Acc: 0.9943303571428571, Train F1: 0.9943303922693294, Train ROC AUC: 0.9942293123254852
Batch [800/1324], Train Loss: 0.001176046091131866, Train Acc: 0.9940234375, Train F1: 0.9940233738543164, Train ROC AUC: 0.9939038674237017
Batch [900/1324], Train Loss: 0.01935352012515068, Train Acc: 0.9941493055555556, Train F1: 0.994149209518454, Train ROC AUC: 0.9940282431028309
Batch [1000/1324], Train Loss: 0.0751357227563858, Train Acc: 0.994125, Train F1: 0.9941249021171067, Train ROC AUC: 0.9940059733442774
Batch [1100/1324], Train Loss: 0.005612135864794254, Train Acc: 0.9941619318181818, Train F1: 0.9941617882145163, Train ROC AUC: 0.9940358469108012
Batch [1200/1324], Train Loss: 0.022049928084015846, Train Acc: 0.994453125, Train F1: 0.9944529728227809, Train ROC AUC: 0.9943314670144432
Batch [1300/1324], Train Loss: 0.0018604893703013659, Train Acc: 0.9945793269230769, Train F1: 0.9945791450823737, Train ROC AUC: 0.9944521022624412
--------------------------------------------------
Train Loss: 0.017063138441596227, Train Acc: 0.9946146396768784, Train F1: 0.9946144706748179, Train ROC AUC: 0.9944902189411772
Valid Loss: 0.0081795232897411, Valid Acc: 0.9977324263038548, Valid F1: 0.997731843162168, Valid ROC AUC: 0.9974467552946915
Confusion Matrix for the validation set:
 [[5925    1]
 [  23 4635]]
Saved the new best model to ../data/models/80_20_split/pklot/ufpr04/5_epochs/squeezenet.pth with accuracy 0.9977324263038548
Epoch time: 322.0248646736145 seconds.
==================================================
Epoch 5/5
Batch [100/1324], Train Loss: 0.003933116793632507, Train Acc: 0.99421875, Train F1: 0.9942178802789396, Train ROC AUC: 0.9940066805918066
Batch [200/1324], Train Loss: 0.000539989210665226, Train Acc: 0.994375, Train F1: 0.9943745868539219, Train ROC AUC: 0.9942261550287965
Batch [300/1324], Train Loss: 0.010437346994876862, Train Acc: 0.9952604166666666, Train F1: 0.9952600390212258, Train ROC AUC: 0.9951172265056514
Batch [400/1324], Train Loss: 0.001243658596649766, Train Acc: 0.99546875, Train F1: 0.995468358189338, Train ROC AUC: 0.9953160688298657
Batch [500/1324], Train Loss: 7.114891923265532e-05, Train Acc: 0.99578125, Train F1: 0.9957809634191302, Train ROC AUC: 0.9956463107832279
Batch [600/1324], Train Loss: 0.0012633894803002477, Train Acc: 0.9959895833333333, Train F1: 0.9959893490271131, Train ROC AUC: 0.9958705014238328
Batch [700/1324], Train Loss: 0.11971666663885117, Train Acc: 0.9959598214285714, Train F1: 0.9959596275018574, Train ROC AUC: 0.9958487238766781
Batch [800/1324], Train Loss: 0.0004694366070907563, Train Acc: 0.99544921875, Train F1: 0.9954490222008203, Train ROC AUC: 0.9953308026229813
Batch [900/1324], Train Loss: 0.0008055655052885413, Train Acc: 0.99546875, Train F1: 0.9954685980729442, Train ROC AUC: 0.9953616934584014
Batch [1000/1324], Train Loss: 0.04202461615204811, Train Acc: 0.995484375, Train F1: 0.9954841841537161, Train ROC AUC: 0.9953688997280993
Batch [1100/1324], Train Loss: 2.9119355531292967e-05, Train Acc: 0.9955255681818181, Train F1: 0.9955253601822681, Train ROC AUC: 0.9954042328577908
Batch [1200/1324], Train Loss: 0.00011603434541029856, Train Acc: 0.99546875, Train F1: 0.995468517541796, Train ROC AUC: 0.9953412306499457
Batch [1300/1324], Train Loss: 0.008804703131318092, Train Acc: 0.9955408653846154, Train F1: 0.9955407030187021, Train ROC AUC: 0.9954287987671022
--------------------------------------------------
Train Loss: 0.016086971156406584, Train Acc: 0.9955948697356922, Train F1: 0.9955947107142363, Train ROC AUC: 0.9954826959602984
Valid Loss: 0.009157318565583805, Valid Acc: 0.9974489795918368, Valid F1: 0.9974485947204262, Valid ROC AUC: 0.9972625382436047
Confusion Matrix for the validation set:
 [[5919    7]
 [  20 4638]]
Epoch time: 319.585889339447 seconds.
==================================================
Average Train Loss: 0.03832085053953277
Average Train Accuracy: 0.988232515293951
Average Train F1: 0.9883066666699258
Average Train ROC AUC: 0.9880470860246737

Best Validation Accuracy: 0.9977324263038548

Average Valid Loss: 0.021907938136336083
Average Valid Accuracy: 0.9937830687830689
Average Valid F1: 0.9937764557955173
Average Valid ROC AUC: 0.9932630320974573

Total training time: 1589.8096742630005 seconds.
