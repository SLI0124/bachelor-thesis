Dataset: pklot
Camera view: ufpr04
Model: shufflenet
Train size split: 80
Valid size split: 20
Number of epochs: 5
**************************************************
Train split file: ../data/splits/pklot/ufpr04_train_80_20.txt
Validation split file: ../data/splits/pklot/ufpr04_valid_80_20.txt

**************************************************
Train dataset size: 84674
Train dataset class distribution: {'empty': 47856, 'occupied': 36818}
Valid dataset size: 10584
Valid dataset class distribution: {'empty': 5926, 'occupied': 4658}
Training the model...
**************************************************
Epoch 1/5
Batch [100/1324], Train Loss: 0.015236430801451206, Train Acc: 0.9571875, Train F1: 0.9628883504408953, Train ROC AUC: 0.9569275314649943
Batch [200/1324], Train Loss: 0.005749032367020845, Train Acc: 0.9721875, Train F1: 0.9750783563553292, Train ROC AUC: 0.9719257276860278
Batch [300/1324], Train Loss: 0.0022162797395139933, Train Acc: 0.9784895833333334, Train F1: 0.980428779963279, Train ROC AUC: 0.978291039575775
Batch [400/1324], Train Loss: 0.0093394098803401, Train Acc: 0.9813671875, Train F1: 0.9828257550285184, Train ROC AUC: 0.9812022681917016
Batch [500/1324], Train Loss: 0.0037856511771678925, Train Acc: 0.9834375, Train F1: 0.9846067830959933, Train ROC AUC: 0.9832902430883343
Batch [600/1324], Train Loss: 0.011512610130012035, Train Acc: 0.9848958333333333, Train F1: 0.985871939842753, Train ROC AUC: 0.9847844254125757
Batch [700/1324], Train Loss: 0.005992563907057047, Train Acc: 0.98625, Train F1: 0.9870875881085275, Train ROC AUC: 0.9861316783683248
Batch [800/1324], Train Loss: 0.00373840075917542, Train Acc: 0.98724609375, Train F1: 0.9879798377498465, Train ROC AUC: 0.9871441451856685
Batch [900/1324], Train Loss: 0.001699111657217145, Train Acc: 0.9880902777777778, Train F1: 0.9887428479460988, Train ROC AUC: 0.9879765997033897
Batch [1000/1324], Train Loss: 0.001120791188441217, Train Acc: 0.988796875, Train F1: 0.9893847050877048, Train ROC AUC: 0.9886993837174726
Batch [1100/1324], Train Loss: 0.008594674989581108, Train Acc: 0.9896022727272727, Train F1: 0.990137062096434, Train ROC AUC: 0.9895118209228537
Batch [1200/1324], Train Loss: 0.005454963073134422, Train Acc: 0.9902473958333333, Train F1: 0.9907378507194473, Train ROC AUC: 0.9901557016271281
Batch [1300/1324], Train Loss: 0.10023266077041626, Train Acc: 0.9907451923076923, Train F1: 0.9911981585741841, Train ROC AUC: 0.9906612560352933
--------------------------------------------------
Train Loss: 0.04669826666062215, Train Acc: 0.990847249450835, Train F1: 0.991292357112671, Train ROC AUC: 0.9907621338720564
Valid Loss: 0.013768493331806084, Valid Acc: 0.9948034769463341, Valid F1: 0.9948062850455944, Valid ROC AUC: 0.9952905282221971
Confusion Matrix for the validation set:
 [[5874   52]
 [   3 4655]]
Saved the new best model to ../data/models/80_20_split/pklot/ufpr04/5_epochs/shufflenet.pth with accuracy 0.9948034769463341
Epoch time: 194.76218152046204 seconds.
==================================================
Epoch 2/5
Batch [100/1324], Train Loss: 0.0019373971736058593, Train Acc: 0.99765625, Train F1: 0.9976562965629537, Train ROC AUC: 0.997638750857087
Batch [200/1324], Train Loss: 0.0007471542339771986, Train Acc: 0.99671875, Train F1: 0.9967188188083412, Train ROC AUC: 0.996681531507188
Batch [300/1324], Train Loss: 0.014997357502579689, Train Acc: 0.9966666666666667, Train F1: 0.9966666198375791, Train ROC AUC: 0.9965931580714862
Batch [400/1324], Train Loss: 0.008630377240478992, Train Acc: 0.996171875, Train F1: 0.996171875, Train ROC AUC: 0.9961050983566992
Batch [500/1324], Train Loss: 0.0016701798886060715, Train Acc: 0.996125, Train F1: 0.9961250643698195, Train ROC AUC: 0.9960742305123637
Batch [600/1324], Train Loss: 0.006823258008807898, Train Acc: 0.996328125, Train F1: 0.9963281871100389, Train ROC AUC: 0.9962839767402414
Batch [700/1324], Train Loss: 0.01682010106742382, Train Acc: 0.9964955357142857, Train F1: 0.9964955875538066, Train ROC AUC: 0.9964497182730544
Batch [800/1324], Train Loss: 0.0026913643814623356, Train Acc: 0.99650390625, Train F1: 0.9965039336709576, Train ROC AUC: 0.9964501373091599
Batch [900/1324], Train Loss: 8.221366442739964e-05, Train Acc: 0.99671875, Train F1: 0.9967187576735139, Train ROC AUC: 0.996662578093906
Batch [1000/1324], Train Loss: 0.0020589435007423162, Train Acc: 0.996703125, Train F1: 0.9967031182092705, Train ROC AUC: 0.9966447502209002
Batch [1100/1324], Train Loss: 6.292691978160292e-05, Train Acc: 0.9968181818181818, Train F1: 0.9968182058539876, Train ROC AUC: 0.9967704080554651
Batch [1200/1324], Train Loss: 0.0007554771145805717, Train Acc: 0.9968489583333333, Train F1: 0.9968489908592647, Train ROC AUC: 0.9968051410624746
Batch [1300/1324], Train Loss: 0.0066158040426671505, Train Acc: 0.9968629807692307, Train F1: 0.9968630057437999, Train ROC AUC: 0.9968167750970559
--------------------------------------------------
Train Loss: 0.010030191874590108, Train Acc: 0.9968939698136382, Train F1: 0.9968939941248112, Train ROC AUC: 0.9968481060633508
Valid Loss: 0.006994273719298569, Valid Acc: 0.9982048374905518, Valid F1: 0.9982045666551148, Valid ROC AUC: 0.9980294028527306
Confusion Matrix for the validation set:
 [[5923    3]
 [  16 4642]]
Saved the new best model to ../data/models/80_20_split/pklot/ufpr04/5_epochs/shufflenet.pth with accuracy 0.9982048374905518
Epoch time: 203.0822398662567 seconds.
==================================================
Epoch 3/5
Batch [100/1324], Train Loss: 0.002705707447603345, Train Acc: 0.9975, Train F1: 0.997500180571943, Train ROC AUC: 0.9975393137331448
Batch [200/1324], Train Loss: 0.010463228449225426, Train Acc: 0.99734375, Train F1: 0.9973438512001545, Train ROC AUC: 0.9973428337756949
Batch [300/1324], Train Loss: 0.0016149155562743545, Train Acc: 0.9970833333333333, Train F1: 0.997083482090693, Train ROC AUC: 0.9970911495456501
Batch [400/1324], Train Loss: 0.0008066289010457695, Train Acc: 0.997421875, Train F1: 0.9974219979439476, Train ROC AUC: 0.99743160508501
Batch [500/1324], Train Loss: 0.0026788038667291403, Train Acc: 0.99740625, Train F1: 0.9974062999652784, Train ROC AUC: 0.9973865947414527
Batch [600/1324], Train Loss: 0.00020394181774463505, Train Acc: 0.9975520833333333, Train F1: 0.9975520833333333, Train ROC AUC: 0.9975138498660495
Batch [700/1324], Train Loss: 0.0034024666529148817, Train Acc: 0.9975892857142857, Train F1: 0.9975892718162812, Train ROC AUC: 0.9975439972341622
Batch [800/1324], Train Loss: 0.00018353958148509264, Train Acc: 0.9975390625, Train F1: 0.9975390502142295, Train ROC AUC: 0.9974945365686608
Batch [900/1324], Train Loss: 0.0021519423462450504, Train Acc: 0.9976041666666666, Train F1: 0.9976041666666666, Train ROC AUC: 0.9975649038861057
Batch [1000/1324], Train Loss: 0.0006977791781537235, Train Acc: 0.99759375, Train F1: 0.99759375, Train ROC AUC: 0.9975539275365982
Batch [1100/1324], Train Loss: 2.3331313059316017e-05, Train Acc: 0.9976704545454546, Train F1: 0.9976704372049277, Train ROC AUC: 0.9976237298139928
Batch [1200/1324], Train Loss: 0.004266486968845129, Train Acc: 0.9975260416666667, Train F1: 0.9975260331278895, Train ROC AUC: 0.9974798887853523
Batch [1300/1324], Train Loss: 0.0016106837429106236, Train Acc: 0.9974519230769231, Train F1: 0.9974519230769231, Train ROC AUC: 0.9974079388581872
--------------------------------------------------
Train Loss: 0.01021842444154866, Train Acc: 0.9974726598483596, Train F1: 0.9974726598483596, Train ROC AUC: 0.9974289692597085
Valid Loss: 0.0050494627995873766, Valid Acc: 0.998771730914588, Valid F1: 0.9987716601003179, Valid ROC AUC: 0.9986964243560953
Confusion Matrix for the validation set:
 [[5922    4]
 [   9 4649]]
Saved the new best model to ../data/models/80_20_split/pklot/ufpr04/5_epochs/shufflenet.pth with accuracy 0.998771730914588
Epoch time: 205.5908875465393 seconds.
==================================================
Epoch 4/5
Batch [100/1324], Train Loss: 0.022060459479689598, Train Acc: 0.98875, Train F1: 0.9887538766433582, Train ROC AUC: 0.9888834016440563
Batch [200/1324], Train Loss: 0.004076156299561262, Train Acc: 0.9928125, Train F1: 0.9928133347110892, Train ROC AUC: 0.9928192000764687
Batch [300/1324], Train Loss: 0.05094827339053154, Train Acc: 0.99421875, Train F1: 0.994219258402356, Train ROC AUC: 0.9942102032959924
Batch [400/1324], Train Loss: 0.001504651503637433, Train Acc: 0.9948828125, Train F1: 0.9948831073261769, Train ROC AUC: 0.9948496164076369
Batch [500/1324], Train Loss: 0.0016118775820359588, Train Acc: 0.9954375, Train F1: 0.9954376507552759, Train ROC AUC: 0.9953919459570375
Batch [600/1324], Train Loss: 0.00013326597400009632, Train Acc: 0.995859375, Train F1: 0.9958594752453991, Train ROC AUC: 0.9958116260450478
Batch [700/1324], Train Loss: 0.0004492332227528095, Train Acc: 0.9962946428571429, Train F1: 0.9962947303219638, Train ROC AUC: 0.9962544507843716
Batch [800/1324], Train Loss: 0.0012930906377732754, Train Acc: 0.99654296875, Train F1: 0.9965430502687969, Train ROC AUC: 0.9965052858092848
Batch [900/1324], Train Loss: 0.00015211323625408113, Train Acc: 0.9966145833333333, Train F1: 0.9966146707529798, Train ROC AUC: 0.9965794617595747
Batch [1000/1324], Train Loss: 0.0001341099850833416, Train Acc: 0.996734375, Train F1: 0.9967344644946309, Train ROC AUC: 0.9967032425291731
Batch [1100/1324], Train Loss: 0.01177157275378704, Train Acc: 0.9969176136363637, Train F1: 0.9969176905467574, Train ROC AUC: 0.9968871577322816
Batch [1200/1324], Train Loss: 0.0003190496936440468, Train Acc: 0.9969661458333333, Train F1: 0.9969661933486862, Train ROC AUC: 0.9969284711149125
Batch [1300/1324], Train Loss: 0.00018813474162016064, Train Acc: 0.9970673076923077, Train F1: 0.9970673545173657, Train ROC AUC: 0.9970323234122994
--------------------------------------------------
Train Loss: 0.009881008332831422, Train Acc: 0.9970829298249758, Train F1: 0.9970829709074608, Train ROC AUC: 0.9970465972673122
Valid Loss: 0.01594430953658716, Valid Acc: 0.9964096749811036, Valid F1: 0.9964110382208683, Valid ROC AUC: 0.9967478535543639
Confusion Matrix for the validation set:
 [[5890   36]
 [   2 4656]]
Epoch time: 208.4448070526123 seconds.
==================================================
Epoch 5/5
Batch [100/1324], Train Loss: 0.001038882415741682, Train Acc: 0.99140625, Train F1: 0.9914064172152334, Train ROC AUC: 0.9912941295919281
Batch [200/1324], Train Loss: 0.0025608979631215334, Train Acc: 0.993671875, Train F1: 0.9936717008246455, Train ROC AUC: 0.9935586602132018
Batch [300/1324], Train Loss: 0.004316419363021851, Train Acc: 0.9947395833333333, Train F1: 0.9947395504072787, Train ROC AUC: 0.9946584869522435
Batch [400/1324], Train Loss: 0.0008947018068283796, Train Acc: 0.9951953125, Train F1: 0.9951951973641536, Train ROC AUC: 0.9951003535239905
Batch [500/1324], Train Loss: 0.0009484576294198632, Train Acc: 0.9958125, Train F1: 0.9958124351415679, Train ROC AUC: 0.9957338251079084
Batch [600/1324], Train Loss: 0.0001705991307971999, Train Acc: 0.9962760416666666, Train F1: 0.9962759799212044, Train ROC AUC: 0.996200168051227
Batch [700/1324], Train Loss: 0.005590558052062988, Train Acc: 0.9965178571428571, Train F1: 0.996517816686978, Train ROC AUC: 0.996448336144673
Batch [800/1324], Train Loss: 0.007718838285654783, Train Acc: 0.9967578125, Train F1: 0.9967577959036231, Train ROC AUC: 0.996697977521822
Batch [900/1324], Train Loss: 0.03534180298447609, Train Acc: 0.9969444444444444, Train F1: 0.9969444306318005, Train ROC AUC: 0.9968890122602069
Batch [1000/1324], Train Loss: 0.0001941141381394118, Train Acc: 0.997125, Train F1: 0.997124965128794, Train ROC AUC: 0.9970656075016644
Batch [1100/1324], Train Loss: 1.2138983947806992e-05, Train Acc: 0.9972869318181818, Train F1: 0.9972868862387461, Train ROC AUC: 0.9972241710202079
Batch [1200/1324], Train Loss: 0.008289075456559658, Train Acc: 0.9973697916666666, Train F1: 0.9973697285405416, Train ROC AUC: 0.9973011259257472
Batch [1300/1324], Train Loss: 0.0002833257312886417, Train Acc: 0.9975, Train F1: 0.997499944276627, Train ROC AUC: 0.9974347318058705
--------------------------------------------------
Train Loss: 0.009889094846677802, Train Acc: 0.9975080898504854, Train F1: 0.9975080390534432, Train ROC AUC: 0.9974446517754141
Valid Loss: 0.03571417779733247, Valid Acc: 0.9876228269085412, Valid F1: 0.98763947615735, Valid ROC AUC: 0.9889470131623355
Confusion Matrix for the validation set:
 [[5795  131]
 [   0 4658]]
Epoch time: 215.14405488967896 seconds.
==================================================
Average Train Loss: 0.01734339723125403
Average Train Accuracy: 0.9959609797576588
Average Train F1: 0.9960500042093491
Average Train ROC AUC: 0.9959060916475684

Best Validation Accuracy: 0.998771730914588

Average Valid Loss: 0.01549414343692233
Average Valid Accuracy: 0.9951625094482239
Average Valid F1: 0.995166605235849
Average Valid ROC AUC: 0.9955422444295445

Total training time: 1027.025171995163 seconds.
