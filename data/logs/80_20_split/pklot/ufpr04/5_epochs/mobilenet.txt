Dataset: pklot
Camera view: ufpr04
Model: mobilenet
Train size split: 80
Valid size split: 20
Number of epochs: 5
**************************************************
Train split file: ../data/splits/pklot/ufpr04_train_80_20.txt
Validation split file: ../data/splits/pklot/ufpr04_valid_80_20.txt

**************************************************
Train dataset size: 84674
Train dataset class distribution: {'empty': 47856, 'occupied': 36818}
Valid dataset size: 10584
Valid dataset class distribution: {'empty': 5926, 'occupied': 4658}
Training the model...
**************************************************
Epoch 1/5
Batch [100/1324], Train Loss: 0.013470808044075966, Train Acc: 0.96265625, Train F1: 0.9674847124866026, Train ROC AUC: 0.9628742328443148
Batch [200/1324], Train Loss: 0.0954638123512268, Train Acc: 0.975625, Train F1: 0.9780692436713514, Train ROC AUC: 0.9756768462610772
Batch [300/1324], Train Loss: 0.0063441661186516285, Train Acc: 0.98, Train F1: 0.9816367695112064, Train ROC AUC: 0.9800267828380466
Batch [400/1324], Train Loss: 0.018035247921943665, Train Acc: 0.9829296875, Train F1: 0.9841607286408686, Train ROC AUC: 0.9829382804930824
Batch [500/1324], Train Loss: 0.00216751080006361, Train Acc: 0.98440625, Train F1: 0.9853928452784696, Train ROC AUC: 0.9844176100913747
Batch [600/1324], Train Loss: 0.03485580533742905, Train Acc: 0.9860416666666667, Train F1: 0.9868649943162973, Train ROC AUC: 0.9860371056179819
Batch [700/1324], Train Loss: 0.06112563610076904, Train Acc: 0.9869642857142857, Train F1: 0.9876708809048201, Train ROC AUC: 0.9869687278921465
Batch [800/1324], Train Loss: 0.01376340351998806, Train Acc: 0.98751953125, Train F1: 0.9881383934802116, Train ROC AUC: 0.9875317086840059
Batch [900/1324], Train Loss: 0.025109227746725082, Train Acc: 0.9883333333333333, Train F1: 0.9888838212347447, Train ROC AUC: 0.9883331822243699
Batch [1000/1324], Train Loss: 0.024124622344970703, Train Acc: 0.98865625, Train F1: 0.9891520083505891, Train ROC AUC: 0.9886635956073007
Batch [1100/1324], Train Loss: 0.002609559567645192, Train Acc: 0.9892471590909091, Train F1: 0.9896979920796697, Train ROC AUC: 0.9892392334793629
Batch [1200/1324], Train Loss: 0.024214960634708405, Train Acc: 0.9895833333333334, Train F1: 0.9899967825323277, Train ROC AUC: 0.9895745280606669
Batch [1300/1324], Train Loss: 0.0006948751397430897, Train Acc: 0.9901201923076923, Train F1: 0.9905019794081135, Train ROC AUC: 0.9901086072118982
--------------------------------------------------
Train Loss: 0.048225686836419195, Train Acc: 0.9902449394146964, Train F1: 0.9906200576017269, Train ROC AUC: 0.9902264660264496
Valid Loss: 0.0271695729168707, Valid Acc: 0.9914965986394558, Valid F1: 0.9915035637280522, Valid ROC AUC: 0.9922455670892778
Confusion Matrix for the validation set:
 [[5843   83]
 [   7 4651]]
Saved the new best model to ../data/models/80_20_split/pklot/ufpr04/5_epochs/mobilenet.pth with accuracy 0.9914965986394558
Epoch time: 417.4507734775543 seconds.
==================================================
Epoch 2/5
Batch [100/1324], Train Loss: 0.0022174320183694363, Train Acc: 0.98453125, Train F1: 0.9845323131154692, Train ROC AUC: 0.9842723679600824
Batch [200/1324], Train Loss: 0.0008378307102248073, Train Acc: 0.989453125, Train F1: 0.9894534745072986, Train ROC AUC: 0.9892788164924097
Batch [300/1324], Train Loss: 0.01032990962266922, Train Acc: 0.9909895833333333, Train F1: 0.9909901601592962, Train ROC AUC: 0.9908876197006509
Batch [400/1324], Train Loss: 0.0030944847967475653, Train Acc: 0.9926171875, Train F1: 0.992617610249451, Train ROC AUC: 0.9925449197605756
Batch [500/1324], Train Loss: 0.009260360151529312, Train Acc: 0.99340625, Train F1: 0.9934064419191618, Train ROC AUC: 0.9933202754978181
Batch [600/1324], Train Loss: 0.00247849035076797, Train Acc: 0.9935677083333333, Train F1: 0.9935679882436375, Train ROC AUC: 0.9935061965005039
Batch [700/1324], Train Loss: 0.014520079828798771, Train Acc: 0.99390625, Train F1: 0.9939065085629797, Train ROC AUC: 0.993851931723848
Batch [800/1324], Train Loss: 0.00014717070735059679, Train Acc: 0.99427734375, Train F1: 0.9942775305519121, Train ROC AUC: 0.9942166033767273
Batch [900/1324], Train Loss: 0.007629619911313057, Train Acc: 0.9946180555555556, Train F1: 0.994618227912218, Train ROC AUC: 0.9945579256271295
Batch [1000/1324], Train Loss: 0.0010326261399313807, Train Acc: 0.99465625, Train F1: 0.9946564273163921, Train ROC AUC: 0.9945965996700828
Batch [1100/1324], Train Loss: 0.0008469765889458358, Train Acc: 0.9949005681818182, Train F1: 0.994900729378168, Train ROC AUC: 0.9948459753564509
Batch [1200/1324], Train Loss: 0.002196440938860178, Train Acc: 0.9952083333333334, Train F1: 0.9952084816237903, Train ROC AUC: 0.995156900308804
Batch [1300/1324], Train Loss: 0.00591811491176486, Train Acc: 0.9952403846153847, Train F1: 0.9952405353894536, Train ROC AUC: 0.9951905489596803
--------------------------------------------------
Train Loss: 0.015318539662603199, Train Acc: 0.9952996197179772, Train F1: 0.9952997520015906, Train ROC AUC: 0.995246554119054
Valid Loss: 0.004194070770784284, Valid Acc: 0.99848828420257, Valid F1: 0.9984884564014509, Valid ROC AUC: 0.9985811120898989
Confusion Matrix for the validation set:
 [[5913   13]
 [   3 4655]]
Saved the new best model to ../data/models/80_20_split/pklot/ufpr04/5_epochs/mobilenet.pth with accuracy 0.99848828420257
Epoch time: 435.6533408164978 seconds.
==================================================
Epoch 3/5
Batch [100/1324], Train Loss: 0.004229255951941013, Train Acc: 0.99734375, Train F1: 0.9973440274851371, Train ROC AUC: 0.9974016185751995
Batch [200/1324], Train Loss: 0.005632187705487013, Train Acc: 0.996953125, Train F1: 0.9969530254488632, Train ROC AUC: 0.9968626079469751
Batch [300/1324], Train Loss: 0.0011380278738215566, Train Acc: 0.9970833333333333, Train F1: 0.9970831744950234, Train ROC AUC: 0.9969803777506396
Batch [400/1324], Train Loss: 0.0007967654964886606, Train Acc: 0.997421875, Train F1: 0.9974217941531311, Train ROC AUC: 0.9973453833618188
Batch [500/1324], Train Loss: 0.0014864953700453043, Train Acc: 0.9973125, Train F1: 0.9973124327030088, Train ROC AUC: 0.9972405252376754
Batch [600/1324], Train Loss: 0.014736201614141464, Train Acc: 0.9973697916666666, Train F1: 0.9973697289081261, Train ROC AUC: 0.9973017769604734
Batch [700/1324], Train Loss: 0.00046467562788166106, Train Acc: 0.9972767857142857, Train F1: 0.9972767543264849, Train ROC AUC: 0.9972206827045627
Batch [800/1324], Train Loss: 6.243766983971e-05, Train Acc: 0.99712890625, Train F1: 0.9971288693640753, Train ROC AUC: 0.9970672848374159
Batch [900/1324], Train Loss: 0.00045343718375079334, Train Acc: 0.9973958333333334, Train F1: 0.9973957980663875, Train ROC AUC: 0.997339077845063
Batch [1000/1324], Train Loss: 0.014030938036739826, Train Acc: 0.997421875, Train F1: 0.9974218488851753, Train ROC AUC: 0.9973691700361638
Batch [1100/1324], Train Loss: 0.0001355737040285021, Train Acc: 0.9975710227272727, Train F1: 0.9975710002474714, Train ROC AUC: 0.9975212518322434
Batch [1200/1324], Train Loss: 0.004026774782687426, Train Acc: 0.9975260416666667, Train F1: 0.9975260162780072, Train ROC AUC: 0.9974738614260579
Batch [1300/1324], Train Loss: 0.000167854581377469, Train Acc: 0.9975240384615385, Train F1: 0.9975239990644282, Train ROC AUC: 0.9974655627409246
--------------------------------------------------
Train Loss: 0.009157086305196889, Train Acc: 0.9974490398469424, Train F1: 0.9974490078614524, Train ROC AUC: 0.9973924117219204
Valid Loss: 0.022465413958716124, Valid Acc: 0.9933862433862434, Valid F1: 0.9933890407090413, Valid ROC AUC: 0.9937263316411207
Confusion Matrix for the validation set:
 [[5872   54]
 [  16 4642]]
Epoch time: 445.362361907959 seconds.
==================================================
Epoch 4/5
Batch [100/1324], Train Loss: 0.00013302237493917346, Train Acc: 0.9971875, Train F1: 0.9971875, Train ROC AUC: 0.9971379618651307
Batch [200/1324], Train Loss: 0.003299620235338807, Train Acc: 0.996953125, Train F1: 0.99695321573928, Train ROC AUC: 0.9969343546049642
Batch [300/1324], Train Loss: 0.0035412765573710203, Train Acc: 0.9969270833333334, Train F1: 0.996927144120451, Train ROC AUC: 0.9968982790548242
Batch [400/1324], Train Loss: 0.01731853559613228, Train Acc: 0.9969140625, Train F1: 0.9969141089994601, Train ROC AUC: 0.9968788466149795
Batch [500/1324], Train Loss: 0.0021815896034240723, Train Acc: 0.9971875, Train F1: 0.997187476859619, Train ROC AUC: 0.997131399745188
Batch [600/1324], Train Loss: 0.0005657907458953559, Train Acc: 0.99734375, Train F1: 0.99734375, Train ROC AUC: 0.9972981620846914
Batch [700/1324], Train Loss: 0.001302018528804183, Train Acc: 0.9973660714285715, Train F1: 0.9973660561224358, Train ROC AUC: 0.9973163954990497
Batch [800/1324], Train Loss: 0.00010166514402953908, Train Acc: 0.99734375, Train F1: 0.9973437220464849, Train ROC AUC: 0.9972859363884736
Batch [900/1324], Train Loss: 0.003894438501447439, Train Acc: 0.9973958333333334, Train F1: 0.9973958333333334, Train ROC AUC: 0.9973498167370667
Batch [1000/1324], Train Loss: 0.02119646593928337, Train Acc: 0.997359375, Train F1: 0.9973593804254599, Train ROC AUC: 0.9973165231522093
Batch [1100/1324], Train Loss: 6.556714652106166e-05, Train Acc: 0.9972727272727273, Train F1: 0.9972727272727273, Train ROC AUC: 0.9972275163830115
Batch [1200/1324], Train Loss: 0.0003374782972969115, Train Acc: 0.997265625, Train F1: 0.997265625, Train ROC AUC: 0.9972194395910283
Batch [1300/1324], Train Loss: 0.0005271895206533372, Train Acc: 0.9973677884615385, Train F1: 0.9973677842800068, Train ROC AUC: 0.9973210019790361
--------------------------------------------------
Train Loss: 0.009462215123260008, Train Acc: 0.9973663698419822, Train F1: 0.9973663739662597, Train ROC AUC: 0.9973224079503071
Valid Loss: 0.010508139909393047, Valid Acc: 0.9957482993197279, Valid F1: 0.9957464383966722, Valid ROC AUC: 0.9952614737335106
Confusion Matrix for the validation set:
 [[5922    4]
 [  41 4617]]
Epoch time: 396.75529503822327 seconds.
==================================================
Epoch 5/5
Batch [100/1324], Train Loss: 0.008904817514121532, Train Acc: 0.9846875, Train F1: 0.9846843217197925, Train ROC AUC: 0.9843045570372618
Batch [200/1324], Train Loss: 0.019421838223934174, Train Acc: 0.99, Train F1: 0.9899998255134181, Train ROC AUC: 0.9898597421469874
Batch [300/1324], Train Loss: 0.0007554961484856904, Train Acc: 0.99234375, Train F1: 0.9923438912982147, Train ROC AUC: 0.9922565826527738
Batch [400/1324], Train Loss: 0.0022100002970546484, Train Acc: 0.9928515625, Train F1: 0.9928517344836609, Train ROC AUC: 0.9927684412399285
Batch [500/1324], Train Loss: 8.837923087412491e-05, Train Acc: 0.994, Train F1: 0.9940000940105463, Train ROC AUC: 0.9939226583353945
Batch [600/1324], Train Loss: 0.06115330755710602, Train Acc: 0.9946875, Train F1: 0.9946875710267653, Train ROC AUC: 0.994614616755917
Batch [700/1324], Train Loss: 0.00010809120431076735, Train Acc: 0.99515625, Train F1: 0.9951563178508728, Train ROC AUC: 0.9950949950350201
Batch [800/1324], Train Loss: 0.00015886394248809665, Train Acc: 0.9955859375, Train F1: 0.9955860234442028, Train ROC AUC: 0.9955377497857026
Batch [900/1324], Train Loss: 0.0010814400156959891, Train Acc: 0.9959722222222223, Train F1: 0.9959723106618144, Train ROC AUC: 0.9959306025467052
Batch [1000/1324], Train Loss: 0.001431882381439209, Train Acc: 0.996125, Train F1: 0.9961250781153725, Train ROC AUC: 0.9960815646118804
Batch [1100/1324], Train Loss: 0.00042329347343184054, Train Acc: 0.9962926136363637, Train F1: 0.9962926752552076, Train ROC AUC: 0.9962474866295157
Batch [1200/1324], Train Loss: 4.974946932634339e-05, Train Acc: 0.9965234375, Train F1: 0.9965234791977976, Train ROC AUC: 0.9964761623608889
Batch [1300/1324], Train Loss: 0.00017915116040967405, Train Acc: 0.9967548076923077, Train F1: 0.9967548388521458, Train ROC AUC: 0.9967078068709962
--------------------------------------------------
Train Loss: 0.012815433959281176, Train Acc: 0.9967758698065522, Train F1: 0.9967759051296997, Train ROC AUC: 0.9967310967432509
Valid Loss: 0.0035028322037146883, Valid Acc: 0.9989606953892668, Valid F1: 0.9989607548246835, Valid ROC AUC: 0.9990029818165271
Confusion Matrix for the validation set:
 [[5918    8]
 [   3 4655]]
Saved the new best model to ../data/models/80_20_split/pklot/ufpr04/5_epochs/mobilenet.pth with accuracy 0.9989606953892668
Epoch time: 410.2296588420868 seconds.
==================================================
Average Train Loss: 0.018995792377352095
Average Train Accuracy: 0.9954271677256301
Average Train F1: 0.995502219312146
Average Train ROC AUC: 0.9953837873121965

Best Validation Accuracy: 0.9989606953892668

Average Valid Loss: 0.013568005951895768
Average Valid Accuracy: 0.9956160241874528
Average Valid F1: 0.99561765081198
Average Valid ROC AUC: 0.9957634932740671

Total training time: 2105.459421157837 seconds.
