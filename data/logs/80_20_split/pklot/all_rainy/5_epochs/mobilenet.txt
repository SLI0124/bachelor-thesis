Dataset: pklot
Camera view: all_rainy
Model: mobilenet
Train size split: 80
Valid size split: 20
Number of epochs: 5
**************************************************
Train split file: ../data/splits/pklot/all_rainy_train_80_20.txt
Validation split file: ../data/splits/pklot/all_rainy_valid_80_20.txt

**************************************************
Train dataset size: 79954
Train dataset class distribution: {'empty': 29099, 'occupied': 50855}
Valid dataset size: 9994
Valid dataset class distribution: {'empty': 3633, 'occupied': 6361}
Training the model...
**************************************************
Epoch 1/5
Batch [100/1250], Train Loss: 0.03208990767598152, Train Acc: 0.961875, Train F1: 0.966748382369075, Train ROC AUC: 0.961227332556033
Batch [200/1250], Train Loss: 0.04394848644733429, Train Acc: 0.976640625, Train F1: 0.9791026956723118, Train ROC AUC: 0.9759741832014384
Batch [300/1250], Train Loss: 0.0016232618363574147, Train Acc: 0.9821875, Train F1: 0.9838358507277085, Train ROC AUC: 0.9816285051874595
Batch [400/1250], Train Loss: 0.003383550327271223, Train Acc: 0.984453125, Train F1: 0.9856910353490695, Train ROC AUC: 0.9838738869316856
Batch [500/1250], Train Loss: 0.030658824369311333, Train Acc: 0.98646875, Train F1: 0.9874592064027897, Train ROC AUC: 0.9857881450537944
Batch [600/1250], Train Loss: 0.06647530198097229, Train Acc: 0.98765625, Train F1: 0.9884820619242051, Train ROC AUC: 0.9869692431641447
Batch [700/1250], Train Loss: 0.07368796318769455, Train Acc: 0.9888169642857143, Train F1: 0.9895248154021692, Train ROC AUC: 0.9881211351066341
Batch [800/1250], Train Loss: 0.004360440652817488, Train Acc: 0.98953125, Train F1: 0.9901511136214926, Train ROC AUC: 0.9888989906611406
Batch [900/1250], Train Loss: 0.01938520558178425, Train Acc: 0.9902777777777778, Train F1: 0.9908289088886565, Train ROC AUC: 0.9896656799125974
Batch [1000/1250], Train Loss: 0.003851299872621894, Train Acc: 0.990765625, Train F1: 0.9912618733090226, Train ROC AUC: 0.9901694092063493
Batch [1100/1250], Train Loss: 0.00231296312995255, Train Acc: 0.9913352272727273, Train F1: 0.9917864714398716, Train ROC AUC: 0.9907544246980158
Batch [1200/1250], Train Loss: 0.005315179005265236, Train Acc: 0.9915494791666667, Train F1: 0.9919631572636327, Train ROC AUC: 0.9909689649163421
--------------------------------------------------
Train Loss: 0.046502705066720953, Train Acc: 0.9917327463291392, Train F1: 0.992130275608515, Train ROC AUC: 0.9911805997101782
Valid Loss: 0.019018205042904728, Valid Acc: 0.9957974784870922, Valid F1: 0.9957996938318358, Valid ROC AUC: 0.9959903525444261
Confusion Matrix for the validation set:
 [[3621   12]
 [  30 6331]]
Saved the new best model to ../data/models/80_20_split/pklot/all_rainy/5_epochs/mobilenet.pth with accuracy 0.9957974784870922
Epoch time: 318.84861874580383 seconds.
==================================================
Epoch 2/5
Batch [100/1250], Train Loss: 0.0005539217963814735, Train Acc: 0.99875, Train F1: 0.9987496550493185, Train ROC AUC: 0.9983756181839248
Batch [200/1250], Train Loss: 0.007321229670196772, Train Acc: 0.997421875, Train F1: 0.9974210828501975, Train ROC AUC: 0.9969000394997677
Batch [300/1250], Train Loss: 0.05749516934156418, Train Acc: 0.99703125, Train F1: 0.9970306636846469, Train ROC AUC: 0.9966014693762234
Batch [400/1250], Train Loss: 0.003919950220733881, Train Acc: 0.996796875, Train F1: 0.9967964339138231, Train ROC AUC: 0.9964044197271035
Batch [500/1250], Train Loss: 0.001209416426718235, Train Acc: 0.99640625, Train F1: 0.9964058215635095, Train ROC AUC: 0.9960015397367227
Batch [600/1250], Train Loss: 0.0007182891713455319, Train Acc: 0.9961979166666667, Train F1: 0.9961973962363871, Train ROC AUC: 0.9957619709171694
Batch [700/1250], Train Loss: 0.013324388302862644, Train Acc: 0.9958705357142857, Train F1: 0.9958698623568308, Train ROC AUC: 0.9953825743880158
Batch [800/1250], Train Loss: 0.0016075246967375278, Train Acc: 0.99607421875, Train F1: 0.9960736568910536, Train ROC AUC: 0.9956201923561157
Batch [900/1250], Train Loss: 0.022901037707924843, Train Acc: 0.9961458333333333, Train F1: 0.9961452461106425, Train ROC AUC: 0.9956894871803907
Batch [1000/1250], Train Loss: 0.00558417197316885, Train Acc: 0.996125, Train F1: 0.9961244316534835, Train ROC AUC: 0.9956710432552929
Batch [1100/1250], Train Loss: 0.0005412601167336106, Train Acc: 0.9963352272727273, Train F1: 0.9963346771041411, Train ROC AUC: 0.9958941114387998
Batch [1200/1250], Train Loss: 0.009544093161821365, Train Acc: 0.9963671875, Train F1: 0.9963666453450832, Train ROC AUC: 0.9959289161151057
--------------------------------------------------
Train Loss: 0.018851363138924354, Train Acc: 0.9962728568927133, Train F1: 0.996272362788016, Train ROC AUC: 0.995842509966747
Valid Loss: 0.01936091998574223, Valid Acc: 0.9952971783069842, Valid F1: 0.9952992468545159, Valid ROC AUC: 0.995361239330314
Confusion Matrix for the validation set:
 [[3617   16]
 [  31 6330]]
Epoch time: 372.4221568107605 seconds.
==================================================
Epoch 3/5
Batch [100/1250], Train Loss: 0.0453266017138958, Train Acc: 0.99515625, Train F1: 0.9951564658561586, Train ROC AUC: 0.9948340716482553
Batch [200/1250], Train Loss: 0.00024762091925367713, Train Acc: 0.996015625, Train F1: 0.996015183358655, Train ROC AUC: 0.9956074575265995
Batch [300/1250], Train Loss: 0.003944011405110359, Train Acc: 0.9958854166666666, Train F1: 0.9958849732354933, Train ROC AUC: 0.9954461338834316
Batch [400/1250], Train Loss: 0.0019016917794942856, Train Acc: 0.9959375, Train F1: 0.9959367518607571, Train ROC AUC: 0.9954289770479956
Batch [500/1250], Train Loss: 0.00460218358784914, Train Acc: 0.996, Train F1: 0.9959995571697003, Train ROC AUC: 0.9955678231957367
Batch [600/1250], Train Loss: 0.15069431066513062, Train Acc: 0.9961197916666666, Train F1: 0.9961193435752097, Train ROC AUC: 0.9956917160082187
Batch [700/1250], Train Loss: 0.02337593585252762, Train Acc: 0.99609375, Train F1: 0.9960934695236041, Train ROC AUC: 0.9957131099909214
Batch [800/1250], Train Loss: 0.0009791789343580604, Train Acc: 0.9962109375, Train F1: 0.9962105904622399, Train ROC AUC: 0.9958187300043607
Batch [900/1250], Train Loss: 0.0008597542764618993, Train Acc: 0.9961805555555555, Train F1: 0.9961802469401368, Train ROC AUC: 0.9958008503132514
Batch [1000/1250], Train Loss: 0.006295874249190092, Train Acc: 0.99621875, Train F1: 0.9962184024986808, Train ROC AUC: 0.995824943346023
Batch [1100/1250], Train Loss: 0.0027316282503306866, Train Acc: 0.9963068181818182, Train F1: 0.9963064135275326, Train ROC AUC: 0.995897700225916
Batch [1200/1250], Train Loss: 0.0005519468686543405, Train Acc: 0.99640625, Train F1: 0.9964059185052592, Train ROC AUC: 0.9960250923746486
--------------------------------------------------
Train Loss: 0.01764369603662053, Train Acc: 0.9964354503839707, Train F1: 0.9964350961414716, Train ROC AUC: 0.9960511836482366
Valid Loss: 0.014619801612700644, Valid Acc: 0.9975985591354813, Valid F1: 0.9975988421350408, Valid ROC AUC: 0.9975232710442664
Confusion Matrix for the validation set:
 [[3623   10]
 [  14 6347]]
Saved the new best model to ../data/models/80_20_split/pklot/all_rainy/5_epochs/mobilenet.pth with accuracy 0.9975985591354813
Epoch time: 363.7242383956909 seconds.
==================================================
Epoch 4/5
Batch [100/1250], Train Loss: 0.0013034702278673649, Train Acc: 0.9975, Train F1: 0.9974992663993667, Train ROC AUC: 0.996984558146501
Batch [200/1250], Train Loss: 0.0005529442569240928, Train Acc: 0.9971875, Train F1: 0.9971869621006323, Train ROC AUC: 0.996755452733977
Batch [300/1250], Train Loss: 0.0015172666171565652, Train Acc: 0.9976041666666666, Train F1: 0.9976037204082606, Train ROC AUC: 0.9972227072193884
Batch [400/1250], Train Loss: 0.006706025917083025, Train Acc: 0.9973828125, Train F1: 0.9973822377747961, Train ROC AUC: 0.9969531951719626
Batch [500/1250], Train Loss: 0.002079891972243786, Train Acc: 0.9975, Train F1: 0.9974994100214848, Train ROC AUC: 0.9970705004198714
Batch [600/1250], Train Loss: 0.005200480110943317, Train Acc: 0.9973177083333333, Train F1: 0.9973171555773136, Train ROC AUC: 0.9969000167936924
Batch [700/1250], Train Loss: 0.00025941155035980046, Train Acc: 0.9975, Train F1: 0.9974996087640163, Train ROC AUC: 0.9971470027808975
Batch [800/1250], Train Loss: 0.00504087982699275, Train Acc: 0.99740234375, Train F1: 0.9974019712283618, Train ROC AUC: 0.9970525444459545
Batch [900/1250], Train Loss: 0.0024217800237238407, Train Acc: 0.9972569444444445, Train F1: 0.9972565539680492, Train ROC AUC: 0.996897817318433
Batch [1000/1250], Train Loss: 0.004317264072597027, Train Acc: 0.997328125, Train F1: 0.9973277248230656, Train ROC AUC: 0.9969704702116523
Batch [1100/1250], Train Loss: 0.00039741615182720125, Train Acc: 0.9972017045454545, Train F1: 0.9972013425163521, Train ROC AUC: 0.9968496779693575
Batch [1200/1250], Train Loss: 0.000637151300907135, Train Acc: 0.997109375, Train F1: 0.9971089786688057, Train ROC AUC: 0.9967442495036356
--------------------------------------------------
Train Loss: 0.015006376697105589, Train Acc: 0.9971608674988118, Train F1: 0.9971604806413961, Train ROC AUC: 0.9967978527014845
Valid Loss: 0.018022672846675317, Valid Acc: 0.9966980188112867, Valid F1: 0.9966969418721587, Valid ROC AUC: 0.9961075553604267
Confusion Matrix for the validation set:
 [[3611   22]
 [  11 6350]]
Epoch time: 417.1860067844391 seconds.
==================================================
Epoch 5/5
Batch [100/1250], Train Loss: 0.0005422598333097994, Train Acc: 0.99703125, Train F1: 0.9970311146360996, Train ROC AUC: 0.996751661306763
Batch [200/1250], Train Loss: 0.0019120096694678068, Train Acc: 0.996640625, Train F1: 0.996639639664705, Train ROC AUC: 0.996090663452729
Batch [300/1250], Train Loss: 0.010150485672056675, Train Acc: 0.99640625, Train F1: 0.9964054568350266, Train ROC AUC: 0.9959210174328464
Batch [400/1250], Train Loss: 0.0007030140841379762, Train Acc: 0.9969921875, Train F1: 0.9969915359522897, Train ROC AUC: 0.9965401882402849
Batch [500/1250], Train Loss: 0.0019304752349853516, Train Acc: 0.997125, Train F1: 0.9971243750589387, Train ROC AUC: 0.9966856330433311
Batch [600/1250], Train Loss: 0.0035456682089716196, Train Acc: 0.996953125, Train F1: 0.9969524556933135, Train ROC AUC: 0.9964965724321992
Batch [700/1250], Train Loss: 0.0044914474710822105, Train Acc: 0.9971428571428571, Train F1: 0.9971423054747075, Train ROC AUC: 0.9967309969782268
Batch [800/1250], Train Loss: 0.000489753030706197, Train Acc: 0.9973046875, Train F1: 0.9973042264852089, Train ROC AUC: 0.9969222006049169
Batch [900/1250], Train Loss: 0.0007402804912999272, Train Acc: 0.9972743055555555, Train F1: 0.9972739002002199, Train ROC AUC: 0.9969067303077759
Batch [1000/1250], Train Loss: 0.06745996326208115, Train Acc: 0.99725, Train F1: 0.9972496205037537, Train ROC AUC: 0.996892456539097
Batch [1100/1250], Train Loss: 0.00045675988076254725, Train Acc: 0.9971448863636364, Train F1: 0.9971444702810225, Train ROC AUC: 0.9967731198984275
Batch [1200/1250], Train Loss: 0.0647713914513588, Train Acc: 0.9971354166666667, Train F1: 0.9971350427067506, Train ROC AUC: 0.9967753883712223
--------------------------------------------------
Train Loss: 0.015399554625805468, Train Acc: 0.9970608099657303, Train F1: 0.9970603660836981, Train ROC AUC: 0.9966750926252731
Valid Loss: 0.017215918367328182, Valid Acc: 0.9967980788473084, Valid F1: 0.9967992069900229, Valid ROC AUC: 0.9968944390996036
Confusion Matrix for the validation set:
 [[3623   10]
 [  22 6339]]
Epoch time: 423.2000045776367 seconds.
==================================================
Average Train Loss: 0.022680739113035378
Average Train Accuracy: 0.995732546214073
Average Train F1: 0.9958117162526193
Average Train ROC AUC: 0.9953094477303839

Best Validation Accuracy: 0.9975985591354813

Average Valid Loss: 0.01764750357107022
Average Valid Accuracy: 0.9964378627176306
Average Valid F1: 0.9964387863367147
Average Valid ROC AUC: 0.9963753714758073

Total training time: 1895.382025718689 seconds.
