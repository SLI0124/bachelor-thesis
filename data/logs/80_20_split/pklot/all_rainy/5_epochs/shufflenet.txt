Dataset: pklot
Camera view: all_rainy
Model: shufflenet
Train size split: 80
Valid size split: 20
Number of epochs: 5
**************************************************
Train split file: ../data/splits/pklot/all_rainy_train_80_20.txt
Validation split file: ../data/splits/pklot/all_rainy_valid_80_20.txt

**************************************************
Train dataset size: 79954
Train dataset class distribution: {'empty': 29099, 'occupied': 50855}
Valid dataset size: 9994
Valid dataset class distribution: {'empty': 3633, 'occupied': 6361}
Training the model...
**************************************************
Epoch 1/5
Batch [100/1250], Train Loss: 0.02750837244093418, Train Acc: 0.93375, Train F1: 0.9387017443865311, Train ROC AUC: 0.9335164603623931
Batch [200/1250], Train Loss: 0.0740688294172287, Train Acc: 0.96125, Train F1: 0.963748161268156, Train ROC AUC: 0.9608367128727152
Batch [300/1250], Train Loss: 0.014651973731815815, Train Acc: 0.9719791666666666, Train F1: 0.9736466580995845, Train ROC AUC: 0.9715159478512408
Batch [400/1250], Train Loss: 0.0037022067699581385, Train Acc: 0.9766015625, Train F1: 0.9778522543623237, Train ROC AUC: 0.9759726565822607
Batch [500/1250], Train Loss: 0.027544066309928894, Train Acc: 0.97996875, Train F1: 0.9809691756201286, Train ROC AUC: 0.9793744795972754
Batch [600/1250], Train Loss: 0.005712928716093302, Train Acc: 0.98234375, Train F1: 0.9831773389964588, Train ROC AUC: 0.9817609776732594
Batch [700/1250], Train Loss: 0.007277522701770067, Train Acc: 0.9843080357142857, Train F1: 0.9850222579933762, Train ROC AUC: 0.9837442653760541
Batch [800/1250], Train Loss: 0.00530304666608572, Train Acc: 0.98552734375, Train F1: 0.9861526474145492, Train ROC AUC: 0.9849911206654058
Batch [900/1250], Train Loss: 0.003278943942859769, Train Acc: 0.9866493055555555, Train F1: 0.9872051537836788, Train ROC AUC: 0.9861265742874342
Batch [1000/1250], Train Loss: 0.005144784692674875, Train Acc: 0.987578125, Train F1: 0.9880783719400399, Train ROC AUC: 0.9870766157005219
Batch [1100/1250], Train Loss: 0.11701200902462006, Train Acc: 0.9884090909090909, Train F1: 0.988863657137397, Train ROC AUC: 0.9878996687383433
Batch [1200/1250], Train Loss: 0.001218130113556981, Train Acc: 0.9890755208333334, Train F1: 0.9894920909563905, Train ROC AUC: 0.9885733850314181
--------------------------------------------------
Train Loss: 0.055905151122482497, Train Acc: 0.9893438727268179, Train F1: 0.9897438209696825, Train ROC AUC: 0.9888339647365288
Valid Loss: 0.02369910772707444, Valid Acc: 0.9945967580548329, Valid F1: 0.9945941893201281, Valid ROC AUC: 0.9936895684474183
Confusion Matrix for the validation set:
 [[3598   35]
 [  19 6342]]
Saved the new best model to ../data/models/80_20_split/pklot/all_rainy/5_epochs/shufflenet.pth with accuracy 0.9945967580548329
Epoch time: 187.79189491271973 seconds.
==================================================
Epoch 2/5
Batch [100/1250], Train Loss: 0.00473018828779459, Train Acc: 0.9959375, Train F1: 0.9959386225820123, Train ROC AUC: 0.9958858284673814
Batch [200/1250], Train Loss: 0.0008612768142484128, Train Acc: 0.996640625, Train F1: 0.996641002955183, Train ROC AUC: 0.9964937592781313
Batch [300/1250], Train Loss: 0.04402810335159302, Train Acc: 0.9956770833333334, Train F1: 0.9956771488605779, Train ROC AUC: 0.9953526068098648
Batch [400/1250], Train Loss: 0.00041709691868163645, Train Acc: 0.9958984375, Train F1: 0.995898484230526, Train ROC AUC: 0.9955863099423653
Batch [500/1250], Train Loss: 0.0007276140968315303, Train Acc: 0.99615625, Train F1: 0.9961561447310575, Train ROC AUC: 0.9958251194620383
Batch [600/1250], Train Loss: 0.00030942345620132983, Train Acc: 0.9964583333333333, Train F1: 0.9964582262509869, Train ROC AUC: 0.9961515883605222
Batch [700/1250], Train Loss: 0.004103570245206356, Train Acc: 0.9964732142857143, Train F1: 0.9964730307331084, Train ROC AUC: 0.9961438895480532
Batch [800/1250], Train Loss: 0.002970346948131919, Train Acc: 0.99638671875, Train F1: 0.9963864098656111, Train ROC AUC: 0.9960168646713893
Batch [900/1250], Train Loss: 0.002524329349398613, Train Acc: 0.9964930555555556, Train F1: 0.9964927350588679, Train ROC AUC: 0.9961245734925605
Batch [1000/1250], Train Loss: 0.0027594631537795067, Train Acc: 0.996515625, Train F1: 0.9965152603949555, Train ROC AUC: 0.9961380501822485
Batch [1100/1250], Train Loss: 0.0004025854868814349, Train Acc: 0.9965625, Train F1: 0.9965620432885354, Train ROC AUC: 0.9961587383629308
Batch [1200/1250], Train Loss: 0.0012779056560248137, Train Acc: 0.9965885416666667, Train F1: 0.9965881003526394, Train ROC AUC: 0.9961904472775083
--------------------------------------------------
Train Loss: 0.01604391905583907, Train Acc: 0.9966105510668635, Train F1: 0.9966100642075355, Train ROC AUC: 0.9961961807434936
Valid Loss: 0.01795762264396651, Valid Acc: 0.9960976585951571, Valid F1: 0.9960961531635741, Valid ROC AUC: 0.9953998381532315
Confusion Matrix for the validation set:
 [[3607   26]
 [  13 6348]]
Saved the new best model to ../data/models/80_20_split/pklot/all_rainy/5_epochs/shufflenet.pth with accuracy 0.9960976585951571
Epoch time: 182.32295608520508 seconds.
==================================================
Epoch 3/5
Batch [100/1250], Train Loss: 0.002269197255373001, Train Acc: 0.9975, Train F1: 0.9974997567207553, Train ROC AUC: 0.9971807425384418
Batch [200/1250], Train Loss: 0.0006464299513027072, Train Acc: 0.99828125, Train F1: 0.9982810872417212, Train ROC AUC: 0.9980415250073841
Batch [300/1250], Train Loss: 0.0021912825759500265, Train Acc: 0.9977083333333333, Train F1: 0.9977080456233396, Train ROC AUC: 0.9973916552602041
Batch [400/1250], Train Loss: 0.10234856605529785, Train Acc: 0.997734375, Train F1: 0.9977341068187451, Train ROC AUC: 0.9974249767977872
Batch [500/1250], Train Loss: 0.13351525366306305, Train Acc: 0.99759375, Train F1: 0.9975933264773025, Train ROC AUC: 0.9972235420315524
Batch [600/1250], Train Loss: 0.005157665349543095, Train Acc: 0.997421875, Train F1: 0.997421456431332, Train ROC AUC: 0.9970506997047268
Batch [700/1250], Train Loss: 0.0008501615957356989, Train Acc: 0.9973214285714286, Train F1: 0.997320974371499, Train ROC AUC: 0.9969413585046811
Batch [800/1250], Train Loss: 0.0010257933754473925, Train Acc: 0.9972265625, Train F1: 0.9972260861380691, Train ROC AUC: 0.996835514244843
Batch [900/1250], Train Loss: 0.020443756133317947, Train Acc: 0.9972222222222222, Train F1: 0.9972217352140901, Train ROC AUC: 0.9968218159903199
Batch [1000/1250], Train Loss: 0.0017590036150068045, Train Acc: 0.9971875, Train F1: 0.9971870052358334, Train ROC AUC: 0.9967847483343228
Batch [1100/1250], Train Loss: 0.0077583626843988895, Train Acc: 0.9970596590909091, Train F1: 0.9970590803188631, Train ROC AUC: 0.9966280580798501
Batch [1200/1250], Train Loss: 0.0002994455280713737, Train Acc: 0.9971223958333333, Train F1: 0.9971218758197165, Train ROC AUC: 0.9967110967561447
--------------------------------------------------
Train Loss: 0.014847058390441816, Train Acc: 0.9970983315406359, Train F1: 0.997097796875432, Train ROC AUC: 0.9966825357117374
Valid Loss: 0.012488152918918949, Valid Acc: 0.9977986792075245, Valid F1: 0.9977982884239428, Valid ROC AUC: 0.9974443857817341
Confusion Matrix for the validation set:
 [[3619   14]
 [   8 6353]]
Saved the new best model to ../data/models/80_20_split/pklot/all_rainy/5_epochs/shufflenet.pth with accuracy 0.9977986792075245
Epoch time: 184.66809844970703 seconds.
==================================================
Epoch 4/5
Batch [100/1250], Train Loss: 0.0020104164723306894, Train Acc: 0.996875, Train F1: 0.9968740557474919, Train ROC AUC: 0.9962795509729939
Batch [200/1250], Train Loss: 0.0021288434509187937, Train Acc: 0.997109375, Train F1: 0.9971086165728181, Train ROC AUC: 0.9966014391984391
Batch [300/1250], Train Loss: 0.0007177320658229291, Train Acc: 0.99765625, Train F1: 0.9976559838562249, Train ROC AUC: 0.9973346742368596
Batch [400/1250], Train Loss: 0.002562098205089569, Train Acc: 0.997421875, Train F1: 0.9974214465014221, Train ROC AUC: 0.9970375253323807
Batch [500/1250], Train Loss: 0.0010515619069337845, Train Acc: 0.99753125, Train F1: 0.9975308998342687, Train ROC AUC: 0.997182005740433
Batch [600/1250], Train Loss: 0.0019173631444573402, Train Acc: 0.997578125, Train F1: 0.9975777245711015, Train ROC AUC: 0.9972098710917494
Batch [700/1250], Train Loss: 0.001849164254963398, Train Acc: 0.9976116071428571, Train F1: 0.9976111099338881, Train ROC AUC: 0.9972056016427762
Batch [800/1250], Train Loss: 0.0014367029070854187, Train Acc: 0.99755859375, Train F1: 0.9975581778975061, Train ROC AUC: 0.9971857838315147
Batch [900/1250], Train Loss: 0.009353680536150932, Train Acc: 0.9975173611111111, Train F1: 0.9975168825906573, Train ROC AUC: 0.9971197987046757
Batch [1000/1250], Train Loss: 0.0005645337514579296, Train Acc: 0.997484375, Train F1: 0.9974838283381507, Train ROC AUC: 0.9970651599293765
Batch [1100/1250], Train Loss: 0.001329897902905941, Train Acc: 0.9974715909090909, Train F1: 0.997471083952009, Train ROC AUC: 0.997070317129039
Batch [1200/1250], Train Loss: 0.002902430482208729, Train Acc: 0.9974609375, Train F1: 0.9974604787660246, Train ROC AUC: 0.9970769458505175
--------------------------------------------------
Train Loss: 0.01375088653776329, Train Acc: 0.9974860544813268, Train F1: 0.9974856005470772, Train ROC AUC: 0.9971049373727069
Valid Loss: 0.01757883092592052, Valid Acc: 0.9962977786672004, Valid F1: 0.9962952410712044, Valid ROC AUC: 0.9953209528906992
Confusion Matrix for the validation set:
 [[3603   30]
 [   7 6354]]
Epoch time: 194.61259007453918 seconds.
==================================================
Epoch 5/5
Batch [100/1250], Train Loss: 0.0011542547727003694, Train Acc: 0.996875, Train F1: 0.9968744799043366, Train ROC AUC: 0.9965023705357046
Batch [200/1250], Train Loss: 0.15694373846054077, Train Acc: 0.997421875, Train F1: 0.9974215987032184, Train ROC AUC: 0.9971341765003465
Batch [300/1250], Train Loss: 0.0009272184688597918, Train Acc: 0.99734375, Train F1: 0.9973432391378098, Train ROC AUC: 0.9969537343558877
Batch [400/1250], Train Loss: 0.009473690763115883, Train Acc: 0.9975390625, Train F1: 0.9975386535411126, Train ROC AUC: 0.9971900164673987
Batch [500/1250], Train Loss: 0.005055935122072697, Train Acc: 0.99740625, Train F1: 0.9974057611028061, Train ROC AUC: 0.9970205966267982
Batch [600/1250], Train Loss: 0.001388037926517427, Train Acc: 0.997265625, Train F1: 0.9972651464842117, Train ROC AUC: 0.9968757943928785
Batch [700/1250], Train Loss: 0.00434523168951273, Train Acc: 0.9972991071428572, Train F1: 0.9972986676554005, Train ROC AUC: 0.9969248533612491
Batch [800/1250], Train Loss: 0.0012174984440207481, Train Acc: 0.9974609375, Train F1: 0.997460532027779, Train ROC AUC: 0.9971018404072849
Batch [900/1250], Train Loss: 0.002014536177739501, Train Acc: 0.9973958333333334, Train F1: 0.997395381721165, Train ROC AUC: 0.9970156844096592
Batch [1000/1250], Train Loss: 0.0020814663730561733, Train Acc: 0.99734375, Train F1: 0.9973432845176203, Train ROC AUC: 0.996955834399524
Batch [1100/1250], Train Loss: 0.005530274473130703, Train Acc: 0.9974005681818182, Train F1: 0.9974000999468347, Train ROC AUC: 0.997012680843571
Batch [1200/1250], Train Loss: 0.0017142407596111298, Train Acc: 0.9973567708333333, Train F1: 0.9973563338256448, Train ROC AUC: 0.9969795064467306
--------------------------------------------------
Train Loss: 0.013764323881914606, Train Acc: 0.99737348975661, Train F1: 0.9973730640041303, Train ROC AUC: 0.9970017488060255
Valid Loss: 0.012724458262959057, Valid Acc: 0.9972983790274165, Valid F1: 0.9972974978954025, Valid ROC AUC: 0.9967562492554474
Confusion Matrix for the validation set:
 [[3614   19]
 [   8 6353]]
Epoch time: 193.11545133590698 seconds.
==================================================
Average Train Loss: 0.022862267797688258
Average Train Accuracy: 0.9955824599144509
Average Train F1: 0.9956620693207714
Average Train ROC AUC: 0.9951638734740984

Best Validation Accuracy: 0.9977986792075245

Average Valid Loss: 0.016889634495767893
Average Valid Accuracy: 0.9964178507104263
Average Valid F1: 0.9964162739748504
Average Valid ROC AUC: 0.9957221989057061

Total training time: 942.5130212306976 seconds.
