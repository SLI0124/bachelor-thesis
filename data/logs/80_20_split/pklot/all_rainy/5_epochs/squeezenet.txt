Dataset: pklot
Camera view: all_rainy
Model: squeezenet
Train size split: 80
Valid size split: 20
Number of epochs: 5
**************************************************
Train split file: ../data/splits/pklot/all_rainy_train_80_20.txt
Validation split file: ../data/splits/pklot/all_rainy_valid_80_20.txt

**************************************************
Train dataset size: 79954
Train dataset class distribution: {'empty': 29099, 'occupied': 50855}
Valid dataset size: 9994
Valid dataset class distribution: {'empty': 3633, 'occupied': 6361}
Training the model...
**************************************************
Epoch 1/5
Batch [100/1250], Train Loss: 0.09471217542886734, Train Acc: 0.80578125, Train F1: 0.803511638460199, Train ROC AUC: 0.7687731327509011
Batch [200/1250], Train Loss: 0.059029720723629, Train Acc: 0.8815625, Train F1: 0.881800641656427, Train ROC AUC: 0.8590734737173138
Batch [300/1250], Train Loss: 0.12222670763731003, Train Acc: 0.91171875, Train F1: 0.9122822710033645, Train ROC AUC: 0.8953771522335862
Batch [400/1250], Train Loss: 0.10818090289831161, Train Acc: 0.9299609375, Train F1: 0.9305536117506976, Train ROC AUC: 0.9169476431731838
Batch [500/1250], Train Loss: 0.011253480799496174, Train Acc: 0.94221875, Train F1: 0.9427880588996193, Train ROC AUC: 0.931517666065918
Batch [600/1250], Train Loss: 5.6424505601171404e-05, Train Acc: 0.9502083333333333, Train F1: 0.9507389643476457, Train ROC AUC: 0.941278135577765
Batch [700/1250], Train Loss: 0.015428119339048862, Train Acc: 0.9554910714285715, Train F1: 0.9559756890231164, Train ROC AUC: 0.9476837651486921
Batch [800/1250], Train Loss: 0.0005857435753569007, Train Acc: 0.96029296875, Train F1: 0.9607385577403531, Train ROC AUC: 0.9533642696957877
Batch [900/1250], Train Loss: 0.00898919440805912, Train Acc: 0.9636979166666667, Train F1: 0.9641083540644114, Train ROC AUC: 0.9574181743768455
Batch [1000/1250], Train Loss: 0.0282133799046278, Train Acc: 0.96659375, Train F1: 0.966974374047944, Train ROC AUC: 0.9608835770169536
Batch [1100/1250], Train Loss: 0.09504149854183197, Train Acc: 0.96890625, Train F1: 0.9692596194766425, Train ROC AUC: 0.963637983528157
Batch [1200/1250], Train Loss: 0.004373182542622089, Train Acc: 0.9708463541666666, Train F1: 0.9711765185727799, Train ROC AUC: 0.9659863582727981
--------------------------------------------------
Train Loss: 0.0863695972337533, Train Acc: 0.9717837756710108, Train F1: 0.9721035411315883, Train ROC AUC: 0.9671054407076701
Valid Loss: 0.023288939128537918, Valid Acc: 0.9954972983790275, Valid F1: 0.9954982257848076, Valid ROC AUC: 0.9953413773799561
Confusion Matrix for the validation set:
 [[3614   19]
 [  26 6335]]
Saved the new best model to ../data/models/80_20_split/pklot/all_rainy/5_epochs/squeezenet.pth with accuracy 0.9954972983790275
Epoch time: 326.80781292915344 seconds.
==================================================
Epoch 2/5
Batch [100/1250], Train Loss: 0.0033720633946359158, Train Acc: 0.9871875, Train F1: 0.9871775640458763, Train ROC AUC: 0.9853088004564257
Batch [200/1250], Train Loss: 0.000758902111556381, Train Acc: 0.991171875, Train F1: 0.9911679468217861, Train ROC AUC: 0.990005667890166
Batch [300/1250], Train Loss: 0.0290327537804842, Train Acc: 0.99140625, Train F1: 0.991403244531588, Train ROC AUC: 0.9903859369956717
Batch [400/1250], Train Loss: 0.008504558354616165, Train Acc: 0.992265625, Train F1: 0.9922635330562373, Train ROC AUC: 0.991403141982217
Batch [500/1250], Train Loss: 0.08280640840530396, Train Acc: 0.992875, Train F1: 0.9928734711573202, Train ROC AUC: 0.9921224320271406
Batch [600/1250], Train Loss: 0.029364660382270813, Train Acc: 0.9926302083333334, Train F1: 0.9926288477728622, Train ROC AUC: 0.9918976851173021
Batch [700/1250], Train Loss: 0.01609531044960022, Train Acc: 0.9925669642857143, Train F1: 0.9925651950586085, Train ROC AUC: 0.991760411428265
Batch [800/1250], Train Loss: 0.0011223074980080128, Train Acc: 0.99291015625, Train F1: 0.9929085079309672, Train ROC AUC: 0.9921277350342166
Batch [900/1250], Train Loss: 0.007788511458784342, Train Acc: 0.9932986111111111, Train F1: 0.9932971122712742, Train ROC AUC: 0.9925466848449553
Batch [1000/1250], Train Loss: 0.00032852686126716435, Train Acc: 0.993640625, Train F1: 0.9936391987565588, Train ROC AUC: 0.9929146558341307
Batch [1100/1250], Train Loss: 0.0020996727980673313, Train Acc: 0.9936647727272727, Train F1: 0.9936636603246436, Train ROC AUC: 0.9929839781966197
Batch [1200/1250], Train Loss: 0.1411915123462677, Train Acc: 0.9932552083333334, Train F1: 0.9932539173427766, Train ROC AUC: 0.9925273287893096
--------------------------------------------------
Train Loss: 0.031306850987000506, Train Acc: 0.993358681241714, Train F1: 0.9933574820422787, Train ROC AUC: 0.9926475290336544
Valid Loss: 0.023313190284089458, Valid Acc: 0.995097058234941, Valid F1: 0.9951009201806525, Valid ROC AUC: 0.9954991479050208
Confusion Matrix for the validation set:
 [[3622   11]
 [  38 6323]]
Epoch time: 325.27509689331055 seconds.
==================================================
Epoch 3/5
Batch [100/1250], Train Loss: 0.0007356335408985615, Train Acc: 0.99453125, Train F1: 0.9945320040775988, Train ROC AUC: 0.9942296640247584
Batch [200/1250], Train Loss: 0.0329916812479496, Train Acc: 0.994609375, Train F1: 0.9946094935284816, Train ROC AUC: 0.9942334527639715
Batch [300/1250], Train Loss: 0.00145572645124048, Train Acc: 0.9947395833333333, Train F1: 0.9947391952731411, Train ROC AUC: 0.9942739362337181
Batch [400/1250], Train Loss: 0.043018970638513565, Train Acc: 0.994375, Train F1: 0.9943748727882504, Train ROC AUC: 0.993915312336791
Batch [500/1250], Train Loss: 0.0009769456228241324, Train Acc: 0.99446875, Train F1: 0.994468500757973, Train ROC AUC: 0.9939972051268297
Batch [600/1250], Train Loss: 0.009213808923959732, Train Acc: 0.99453125, Train F1: 0.9945308395855704, Train ROC AUC: 0.9940355108516623
Batch [700/1250], Train Loss: 0.0014394851168617606, Train Acc: 0.9946651785714286, Train F1: 0.9946647349124925, Train ROC AUC: 0.9941759662474573
Batch [800/1250], Train Loss: 0.08649838715791702, Train Acc: 0.99421875, Train F1: 0.994218420109975, Train ROC AUC: 0.9937051536879097
Batch [900/1250], Train Loss: 0.006499197334051132, Train Acc: 0.9942708333333333, Train F1: 0.9942702511418009, Train ROC AUC: 0.9937159875413873
Batch [1000/1250], Train Loss: 0.0012486379127949476, Train Acc: 0.994375, Train F1: 0.9943743856852011, Train ROC AUC: 0.9938249813374147
Batch [1100/1250], Train Loss: 0.0013590606395155191, Train Acc: 0.9943892045454545, Train F1: 0.994388524905719, Train ROC AUC: 0.9938205580055728
Batch [1200/1250], Train Loss: 0.02361333556473255, Train Acc: 0.994453125, Train F1: 0.9944524879077073, Train ROC AUC: 0.993895824069111
--------------------------------------------------
Train Loss: 0.026449767231254372, Train Acc: 0.9945343572554218, Train F1: 0.9945336931665416, Train ROC AUC: 0.9939760218143219
Valid Loss: 0.03386018291645191, Valid Acc: 0.9921953171903142, Valid F1: 0.9922087858106142, Valid ROC AUC: 0.9933376787299671
Confusion Matrix for the validation set:
 [[3624    9]
 [  69 6292]]
Epoch time: 338.9174699783325 seconds.
==================================================
Epoch 4/5
Batch [100/1250], Train Loss: 0.006302837748080492, Train Acc: 0.995625, Train F1: 0.9956253965683018, Train ROC AUC: 0.9953734649291837
Batch [200/1250], Train Loss: 0.009362281300127506, Train Acc: 0.99640625, Train F1: 0.9964065843254696, Train ROC AUC: 0.9962043051497298
Batch [300/1250], Train Loss: 0.009019220247864723, Train Acc: 0.9955208333333333, Train F1: 0.9955209707966757, Train ROC AUC: 0.9951913603100668
Batch [400/1250], Train Loss: 0.021491270512342453, Train Acc: 0.9951171875, Train F1: 0.9951177030102517, Train ROC AUC: 0.9948152939522197
Batch [500/1250], Train Loss: 0.003560979152098298, Train Acc: 0.99534375, Train F1: 0.9953439667565542, Train ROC AUC: 0.9950078948457675
Batch [600/1250], Train Loss: 0.0009963108459487557, Train Acc: 0.9954947916666667, Train F1: 0.9954949640927642, Train ROC AUC: 0.9951723079366527
Batch [700/1250], Train Loss: 0.0036057019606232643, Train Acc: 0.9956026785714286, Train F1: 0.9956027654716558, Train ROC AUC: 0.9952678503485195
Batch [800/1250], Train Loss: 0.018448373302817345, Train Acc: 0.9953515625, Train F1: 0.9953516162431137, Train ROC AUC: 0.9949863242694608
Batch [900/1250], Train Loss: 0.002391659654676914, Train Acc: 0.9953819444444445, Train F1: 0.9953818500862318, Train ROC AUC: 0.9949916017511401
Batch [1000/1250], Train Loss: 0.0016356197884306312, Train Acc: 0.995546875, Train F1: 0.9955467728039139, Train ROC AUC: 0.9951683276971424
Batch [1100/1250], Train Loss: 0.006323870271444321, Train Acc: 0.9954829545454545, Train F1: 0.9954829166438898, Train ROC AUC: 0.9951100336347238
Batch [1200/1250], Train Loss: 0.0004227610770612955, Train Acc: 0.9955338541666666, Train F1: 0.9955336660694369, Train ROC AUC: 0.9951346311726732
--------------------------------------------------
Train Loss: 0.022800246670821797, Train Acc: 0.9955224253946019, Train F1: 0.9955223266211274, Train ROC AUC: 0.9951423347786764
Valid Loss: 0.01768070768867471, Valid Acc: 0.9962977786672004, Valid F1: 0.9962967915697172, Valid ROC AUC: 0.9957341160759208
Confusion Matrix for the validation set:
 [[3610   23]
 [  14 6347]]
Saved the new best model to ../data/models/80_20_split/pklot/all_rainy/5_epochs/squeezenet.pth with accuracy 0.9962977786672004
Epoch time: 291.32545828819275 seconds.
==================================================
Epoch 5/5
Batch [100/1250], Train Loss: 0.0031449669040739536, Train Acc: 0.996875, Train F1: 0.9968744433297034, Train ROC AUC: 0.9964625162374411
Batch [200/1250], Train Loss: 0.07773634791374207, Train Acc: 0.99546875, Train F1: 0.9954674803589136, Train ROC AUC: 0.9948184942295835
Batch [300/1250], Train Loss: 0.002976923482492566, Train Acc: 0.9957291666666667, Train F1: 0.9957282520244062, Train ROC AUC: 0.9951764823613212
Batch [400/1250], Train Loss: 0.021098667755723, Train Acc: 0.995703125, Train F1: 0.9957021335704107, Train ROC AUC: 0.9951284946563237
Batch [500/1250], Train Loss: 0.05481763929128647, Train Acc: 0.99496875, Train F1: 0.9949675807887066, Train ROC AUC: 0.9943281372656863
Batch [600/1250], Train Loss: 0.005067629273980856, Train Acc: 0.994765625, Train F1: 0.9947643815551722, Train ROC AUC: 0.994111966164854
Batch [700/1250], Train Loss: 0.004096104763448238, Train Acc: 0.9950446428571429, Train F1: 0.995043539002057, Train ROC AUC: 0.9944296081770735
Batch [800/1250], Train Loss: 0.005873886402696371, Train Acc: 0.9950390625, Train F1: 0.9950382115524695, Train ROC AUC: 0.9944759212918296
Batch [900/1250], Train Loss: 0.004387961234897375, Train Acc: 0.9951736111111111, Train F1: 0.9951729264126624, Train ROC AUC: 0.9946525305912103
Batch [1000/1250], Train Loss: 0.0017648690845817327, Train Acc: 0.995140625, Train F1: 0.9951398916190476, Train ROC AUC: 0.9946059260307378
Batch [1100/1250], Train Loss: 0.0004446666862349957, Train Acc: 0.9952982954545454, Train F1: 0.9952976461233358, Train ROC AUC: 0.9947840937712719
Batch [1200/1250], Train Loss: 0.005776365753263235, Train Acc: 0.9952864583333333, Train F1: 0.9952857725106312, Train ROC AUC: 0.9947653611814701
--------------------------------------------------
Train Loss: 0.023228413188181002, Train Acc: 0.9952472671786277, Train F1: 0.9952464967693783, Train ROC AUC: 0.9947055081465138
Valid Loss: 0.02283557740851694, Valid Acc: 0.9940964578747248, Valid F1: 0.9940906275319948, Valid ROC AUC: 0.9926472920480842
Confusion Matrix for the validation set:
 [[3587   46]
 [  13 6348]]
Epoch time: 288.07278633117676 seconds.
==================================================
Average Train Loss: 0.038030975062202196
Average Train Accuracy: 0.9900893013482752
Average Train F1: 0.9901527079461827
Average Train ROC AUC: 0.9887153668961673

Best Validation Accuracy: 0.9962977786672004

Average Valid Loss: 0.024195719485254185
Average Valid Accuracy: 0.9946367820692416
Average Valid F1: 0.9946390701755574
Average Valid ROC AUC: 0.9945119224277897

Total training time: 1570.399623632431 seconds.
