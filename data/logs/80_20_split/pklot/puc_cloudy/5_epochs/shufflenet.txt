Dataset: pklot
Camera view: puc_cloudy
Model: shufflenet
Train size split: 80
Valid size split: 20
Number of epochs: 5
**************************************************
Train split file: ../data/splits/pklot/puc_cloudy_train_80_20.txt
Validation split file: ../data/splits/pklot/puc_cloudy_valid_80_20.txt

**************************************************
Train dataset size: 106224
Train dataset class distribution: {'empty': 72297, 'occupied': 33927}
Valid dataset size: 13278
Valid dataset class distribution: {'empty': 9053, 'occupied': 4225}
Training the model...
**************************************************
Epoch 1/5
Batch [100/1660], Train Loss: 0.0060998788103461266, Train Acc: 0.9578125, Train F1: 0.9628281233909999, Train ROC AUC: 0.9600635836422743
Batch [200/1660], Train Loss: 0.0005149741773493588, Train Acc: 0.977109375, Train F1: 0.9796068668007578, Train ROC AUC: 0.9774620098373037
Batch [300/1660], Train Loss: 0.0016325574833899736, Train Acc: 0.9844270833333333, Train F1: 0.9860926984370038, Train ROC AUC: 0.9845976464977153
Batch [400/1660], Train Loss: 0.0049646287225186825, Train Acc: 0.9877734375, Train F1: 0.9890226486892331, Train ROC AUC: 0.9877786724937059
Batch [500/1660], Train Loss: 0.0076324851252138615, Train Acc: 0.9895, Train F1: 0.990499598910671, Train ROC AUC: 0.9894114964956545
Batch [600/1660], Train Loss: 0.0005874159978702664, Train Acc: 0.9911458333333333, Train F1: 0.9919787848423778, Train ROC AUC: 0.9910285160448739
Batch [700/1660], Train Loss: 0.00026265584165230393, Train Acc: 0.9923214285714286, Train F1: 0.9930354320218724, Train ROC AUC: 0.9922071299823761
Batch [800/1660], Train Loss: 0.00014065027062315494, Train Acc: 0.99296875, Train F1: 0.9935936252737108, Train ROC AUC: 0.9928395194785183
Batch [900/1660], Train Loss: 0.00026813781005330384, Train Acc: 0.9936805555555556, Train F1: 0.9942359379184394, Train ROC AUC: 0.9935410492476358
Batch [1000/1660], Train Loss: 0.00916121806949377, Train Acc: 0.994234375, Train F1: 0.9947342701498075, Train ROC AUC: 0.9941027240837889
Batch [1100/1660], Train Loss: 0.002324123866856098, Train Acc: 0.9946590909090909, Train F1: 0.9951136268380407, Train ROC AUC: 0.9945428188666819
Batch [1200/1660], Train Loss: 5.8199497289024293e-05, Train Acc: 0.9950651041666667, Train F1: 0.9954817993295149, Train ROC AUC: 0.9949547827962021
Batch [1300/1660], Train Loss: 3.559271863196045e-05, Train Acc: 0.9953846153846154, Train F1: 0.9957692336834612, Train ROC AUC: 0.9952699524850342
Batch [1400/1660], Train Loss: 0.0001264378079213202, Train Acc: 0.9956808035714285, Train F1: 0.9960379753865193, Train ROC AUC: 0.995571305989453
Batch [1500/1660], Train Loss: 0.00012563802010845393, Train Acc: 0.9958333333333333, Train F1: 0.9961667120876851, Train ROC AUC: 0.9957150812275712
Batch [1600/1660], Train Loss: 0.1703149825334549, Train Acc: 0.995986328125, Train F1: 0.996298884370145, Train ROC AUC: 0.9958639318134084
--------------------------------------------------
Train Loss: 0.027567570972964365, Train Acc: 0.9961119897574936, Train F1: 0.9964132677732683, Train ROC AUC: 0.995983077959817
Valid Loss: 0.002077460482190383, Valid Acc: 0.9994728121705077, Valid F1: 0.9994728952390254, Valid ROC AUC: 0.9995502749423676
Confusion Matrix for the validation set:
 [[9047    6]
 [   1 4224]]
Saved the new best model to ../data/models/80_20_split/pklot/puc_cloudy/5_epochs/shufflenet.pth with accuracy 0.9994728121705077
Epoch time: 269.08967113494873 seconds.
==================================================
Epoch 2/5
Batch [100/1660], Train Loss: 0.00037627454730682075, Train Acc: 0.99953125, Train F1: 0.999531282013282, Train ROC AUC: 0.9995225802813263
Batch [200/1660], Train Loss: 0.00035109621239826083, Train Acc: 0.99890625, Train F1: 0.998906321885013, Train ROC AUC: 0.9988040647435668
Batch [300/1660], Train Loss: 0.0013505086535587907, Train Acc: 0.9990104166666667, Train F1: 0.9990104815963025, Train ROC AUC: 0.9989245657837228
Batch [400/1660], Train Loss: 0.0001436190796084702, Train Acc: 0.998828125, Train F1: 0.9988281630587548, Train ROC AUC: 0.9986844635668907
Batch [500/1660], Train Loss: 0.00024715426843613386, Train Acc: 0.99875, Train F1: 0.9987500646691516, Train ROC AUC: 0.9986152658112128
Batch [600/1660], Train Loss: 1.2458593118935823e-05, Train Acc: 0.9989583333333333, Train F1: 0.9989583785245933, Train ROC AUC: 0.9988446121323705
Batch [700/1660], Train Loss: 4.35766669397708e-05, Train Acc: 0.9990848214285715, Train F1: 0.9990848469005434, Train ROC AUC: 0.9989751470688347
Batch [800/1660], Train Loss: 7.495882891817018e-05, Train Acc: 0.99912109375, Train F1: 0.9991211008354771, Train ROC AUC: 0.9989987457068913
Batch [900/1660], Train Loss: 0.00014267869119066745, Train Acc: 0.9991840277777778, Train F1: 0.9991840336131483, Train ROC AUC: 0.9990705433197625
Batch [1000/1660], Train Loss: 2.0571536879288033e-05, Train Acc: 0.999203125, Train F1: 0.9992031404034448, Train ROC AUC: 0.9991043963801809
Batch [1100/1660], Train Loss: 3.7755533412564546e-05, Train Acc: 0.99921875, Train F1: 0.9992187545952842, Train ROC AUC: 0.9991080531281562
Batch [1200/1660], Train Loss: 8.605555922258645e-05, Train Acc: 0.9992578125, Train F1: 0.9992578165099766, Train ROC AUC: 0.9991520619303298
Batch [1300/1660], Train Loss: 6.578881584573537e-05, Train Acc: 0.9993149038461538, Train F1: 0.9993149072505685, Train ROC AUC: 0.999217927102267
Batch [1400/1660], Train Loss: 5.997822154313326e-05, Train Acc: 0.9993526785714286, Train F1: 0.9993526845433078, Train ROC AUC: 0.9992656303943896
Batch [1500/1660], Train Loss: 1.6190191672649235e-05, Train Acc: 0.9993854166666667, Train F1: 0.9993854193128254, Train ROC AUC: 0.9992983101032304
Batch [1600/1660], Train Loss: 9.126488293986768e-05, Train Acc: 0.99939453125, Train F1: 0.9993945361614324, Train ROC AUC: 0.9993118150126634
--------------------------------------------------
Train Loss: 0.0027400550773923975, Train Acc: 0.9993692574182859, Train F1: 0.9993692549514915, Train ROC AUC: 0.9992706989231362
Valid Loss: 0.01741005431596512, Valid Acc: 0.9944268715167947, Valid F1: 0.9944392891778828, Valid ROC AUC: 0.9958498441459466
Confusion Matrix for the validation set:
 [[8980   73]
 [   1 4224]]
Epoch time: 287.104266166687 seconds.
==================================================
Epoch 3/5
Batch [100/1660], Train Loss: 0.00013660108379554003, Train Acc: 0.999375, Train F1: 0.999375, Train ROC AUC: 0.9992764469111575
Batch [200/1660], Train Loss: 2.827768366842065e-05, Train Acc: 0.99953125, Train F1: 0.99953125, Train ROC AUC: 0.9994546941123664
Batch [300/1660], Train Loss: 0.0001679747219895944, Train Acc: 0.9994270833333333, Train F1: 0.9994270960375496, Train ROC AUC: 0.9993594519972702
Batch [400/1660], Train Loss: 0.130589559674263, Train Acc: 0.999453125, Train F1: 0.999453125, Train ROC AUC: 0.9993686950487702
Batch [500/1660], Train Loss: 0.0003127903619315475, Train Acc: 0.99946875, Train F1: 0.9994687569121911, Train ROC AUC: 0.9994017104774044
Batch [600/1660], Train Loss: 0.0008043406414799392, Train Acc: 0.9994270833333333, Train F1: 0.9994270955940654, Train ROC AUC: 0.999364142723466
Batch [700/1660], Train Loss: 0.0009355485090054572, Train Acc: 0.999375, Train F1: 0.9993750114772235, Train ROC AUC: 0.9993011780719019
Batch [800/1660], Train Loss: 1.5418263501487672e-05, Train Acc: 0.99939453125, Train F1: 0.999394545961519, Train ROC AUC: 0.9993282312688889
Batch [900/1660], Train Loss: 2.2496535166283138e-05, Train Acc: 0.999375, Train F1: 0.999375018199781, Train ROC AUC: 0.9993087362925674
Batch [1000/1660], Train Loss: 0.0001487280969740823, Train Acc: 0.999390625, Train F1: 0.9993906369351855, Train ROC AUC: 0.999317804437083
Batch [1100/1660], Train Loss: 0.010455853305757046, Train Acc: 0.9992755681818182, Train F1: 0.9992755982358934, Train ROC AUC: 0.999207453100224
Batch [1200/1660], Train Loss: 0.00037314099608920515, Train Acc: 0.9992057291666666, Train F1: 0.9992057505712868, Train ROC AUC: 0.9991142032950832
Batch [1300/1660], Train Loss: 0.0001931769511429593, Train Acc: 0.9992307692307693, Train F1: 0.9992307921926185, Train ROC AUC: 0.9991458801775703
Batch [1400/1660], Train Loss: 2.853462501661852e-05, Train Acc: 0.9992745535714286, Train F1: 0.9992745703225216, Train ROC AUC: 0.9991895089501718
Batch [1500/1660], Train Loss: 0.00019855877326335758, Train Acc: 0.99925, Train F1: 0.9992500129338303, Train ROC AUC: 0.999155411474206
Batch [1600/1660], Train Loss: 5.6604421843076125e-06, Train Acc: 0.999296875, Train F1: 0.9992968864112081, Train ROC AUC: 0.9992075494531701
--------------------------------------------------
Train Loss: 0.0033643563482370835, Train Acc: 0.9992845308028317, Train F1: 0.9992845419935545, Train ROC AUC: 0.9991928124597372
Valid Loss: 0.0028120723106326295, Valid Acc: 0.9993974996234373, Valid F1: 0.9993976135151778, Valid ROC AUC: 0.9994950446319733
Confusion Matrix for the validation set:
 [[9046    7]
 [   1 4224]]
Epoch time: 291.154004573822 seconds.
==================================================
Epoch 4/5
Batch [100/1660], Train Loss: 0.00011809451098088175, Train Acc: 0.9990625, Train F1: 0.9990625, Train ROC AUC: 0.9989267694553221
Batch [200/1660], Train Loss: 5.5133268688223325e-06, Train Acc: 0.99953125, Train F1: 0.99953125, Train ROC AUC: 0.9994620098237006
Batch [300/1660], Train Loss: 0.005545014049857855, Train Acc: 0.9992708333333333, Train F1: 0.9992708333333333, Train ROC AUC: 0.9991613213277646
Batch [400/1660], Train Loss: 6.135641888249665e-05, Train Acc: 0.9994140625, Train F1: 0.9994140721126411, Train ROC AUC: 0.9993408103261933
Batch [500/1660], Train Loss: 1.8994382116943598e-05, Train Acc: 0.99946875, Train F1: 0.99946875698077, Train ROC AUC: 0.9994004309987595
Batch [600/1660], Train Loss: 0.0001696566614555195, Train Acc: 0.9995052083333333, Train F1: 0.9995052136701981, Train ROC AUC: 0.999442126292581
Batch [700/1660], Train Loss: 0.00017473698244430125, Train Acc: 0.9995535714285714, Train F1: 0.9995535714285714, Train ROC AUC: 0.9994868149930638
Batch [800/1660], Train Loss: 3.993582504335791e-05, Train Acc: 0.99953125, Train F1: 0.9995312575275258, Train ROC AUC: 0.9994782437193325
Batch [900/1660], Train Loss: 6.945369023014791e-06, Train Acc: 0.9995833333333334, Train F1: 0.9995833393119307, Train ROC AUC: 0.9995357257818462
Batch [1000/1660], Train Loss: 7.861893391236663e-05, Train Acc: 0.99959375, Train F1: 0.99959375, Train ROC AUC: 0.9995330794022327
Batch [1100/1660], Train Loss: 1.846813756856136e-05, Train Acc: 0.99953125, Train F1: 0.9995312472433939, Train ROC AUC: 0.9994554600773721
Batch [1200/1660], Train Loss: 0.00011260409519309178, Train Acc: 0.9995182291666667, Train F1: 0.9995182265741815, Train ROC AUC: 0.9994412212564829
Batch [1300/1660], Train Loss: 0.00045094912638887763, Train Acc: 0.9995192307692308, Train F1: 0.9995192307692308, Train ROC AUC: 0.9994478760390128
Batch [1400/1660], Train Loss: 2.6054576665046625e-05, Train Acc: 0.9995200892857142, Train F1: 0.9995200870786757, Train ROC AUC: 0.9994445107063148
Batch [1500/1660], Train Loss: 0.0001022110300255008, Train Acc: 0.99953125, Train F1: 0.9995312479878021, Train ROC AUC: 0.9994576157179559
Batch [1600/1660], Train Loss: 0.002479665447026491, Train Acc: 0.999521484375, Train F1: 0.99952147856587, Train ROC AUC: 0.9994378738952265
--------------------------------------------------
Train Loss: 0.002492433990344413, Train Acc: 0.9994916403072752, Train F1: 0.9994916363308153, Train ROC AUC: 0.9994075354852766
Valid Loss: 0.0018593234031396395, Valid Acc: 0.9995481247175779, Valid F1: 0.9995480961830087, Valid ROC AUC: 0.9994161665981462
Confusion Matrix for the validation set:
 [[9051    2]
 [   4 4221]]
Saved the new best model to ../data/models/80_20_split/pklot/puc_cloudy/5_epochs/shufflenet.pth with accuracy 0.9995481247175779
Epoch time: 295.43990206718445 seconds.
==================================================
Epoch 5/5
Batch [100/1660], Train Loss: 1.2273875654500443e-05, Train Acc: 0.99953125, Train F1: 0.9995312808251151, Train ROC AUC: 0.9995249992789363
Batch [200/1660], Train Loss: 1.016948044707533e-05, Train Acc: 0.999609375, Train F1: 0.9996093877112321, Train ROC AUC: 0.9995830044978984
Batch [300/1660], Train Loss: 2.441543256281875e-05, Train Acc: 0.9996875, Train F1: 0.9996875133577295, Train ROC AUC: 0.9996843463884468
Batch [400/1660], Train Loss: 2.1730720618506894e-05, Train Acc: 0.9995703125, Train F1: 0.9995703332182302, Train ROC AUC: 0.9995551114433455
Batch [500/1660], Train Loss: 0.0003714674385264516, Train Acc: 0.99959375, Train F1: 0.9995937553107809, Train ROC AUC: 0.9995450953369379
Batch [600/1660], Train Loss: 0.00013531539298128337, Train Acc: 0.9995833333333334, Train F1: 0.999583342395304, Train ROC AUC: 0.9995419667599235
Batch [700/1660], Train Loss: 5.142327063367702e-05, Train Acc: 0.9995089285714286, Train F1: 0.9995089285714286, Train ROC AUC: 0.9994353501133164
Batch [800/1660], Train Loss: 4.71865787403658e-05, Train Acc: 0.99953125, Train F1: 0.99953125, Train ROC AUC: 0.9994610359898832
Batch [900/1660], Train Loss: 0.018533989787101746, Train Acc: 0.9995659722222222, Train F1: 0.9995659691070047, Train ROC AUC: 0.999494227023241
Batch [1000/1660], Train Loss: 1.2009488273179159e-05, Train Acc: 0.999578125, Train F1: 0.9995781167751484, Train ROC AUC: 0.9994952129845502
Batch [1100/1660], Train Loss: 1.0158340955968015e-05, Train Acc: 0.9996022727272728, Train F1: 0.9996022633211469, Train ROC AUC: 0.9995187607106626
Batch [1200/1660], Train Loss: 1.361276281386381e-05, Train Acc: 0.99953125, Train F1: 0.9995312348733071, Train ROC AUC: 0.9994293903453376
Batch [1300/1660], Train Loss: 4.745904789160704e-06, Train Acc: 0.999483173076923, Train F1: 0.9994831549602092, Train ROC AUC: 0.9993702154163181
Batch [1400/1660], Train Loss: 0.00012036813859594986, Train Acc: 0.999453125, Train F1: 0.9994531021032501, Train ROC AUC: 0.9993287715094846
Batch [1500/1660], Train Loss: 0.00026550519396550953, Train Acc: 0.99946875, Train F1: 0.9994687246590972, Train ROC AUC: 0.9993411123803788
Batch [1600/1660], Train Loss: 0.0003548520908225328, Train Acc: 0.999501953125, Train F1: 0.9995019308867599, Train ROC AUC: 0.9993825591681146
--------------------------------------------------
Train Loss: 0.0023324862081061156, Train Acc: 0.9995198825124265, Train F1: 0.9995198618506271, Train ROC AUC: 0.9994048184089591
Valid Loss: 0.0010876555055510278, Valid Acc: 0.9999246874529296, Valid F1: 0.9999246850756913, Valid ROC AUC: 0.9998816568047337
Confusion Matrix for the validation set:
 [[9053    0]
 [   1 4224]]
Saved the new best model to ../data/models/80_20_split/pklot/puc_cloudy/5_epochs/shufflenet.pth with accuracy 0.9999246874529296
Epoch time: 303.04212260246277 seconds.
==================================================
Average Train Loss: 0.007699380519408874
Average Train Accuracy: 0.9987554601596627
Average Train F1: 0.9988157125799514
Average Train ROC AUC: 0.9986517886473854

Best Validation Accuracy: 0.9999246874529296

Average Valid Loss: 0.00504931320349576
Average Valid Accuracy: 0.9985539990962493
Average Valid F1: 0.9985565158381572
Average Valid ROC AUC: 0.9988385974246334

Total training time: 1445.8339684009552 seconds.
