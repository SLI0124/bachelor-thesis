Dataset: pklot
Camera view: puc_cloudy
Model: mobilenet
Train size split: 80
Valid size split: 20
Number of epochs: 5
**************************************************
Train split file: ../data/splits/pklot/puc_cloudy_train_80_20.txt
Validation split file: ../data/splits/pklot/puc_cloudy_valid_80_20.txt

**************************************************
Train dataset size: 106224
Train dataset class distribution: {'empty': 72297, 'occupied': 33927}
Valid dataset size: 13278
Valid dataset class distribution: {'empty': 9053, 'occupied': 4225}
Training the model...
**************************************************
Epoch 1/5
Batch [100/1660], Train Loss: 0.004460999742150307, Train Acc: 0.9740625, Train F1: 0.9789945343882641, Train ROC AUC: 0.9744591497082429
Batch [200/1660], Train Loss: 0.004446553532034159, Train Acc: 0.9859375, Train F1: 0.9884206873290867, Train ROC AUC: 0.9860624579021253
Batch [300/1660], Train Loss: 0.0005954580847173929, Train Acc: 0.9901041666666667, Train F1: 0.9917636631785175, Train ROC AUC: 0.9901837476713483
Batch [400/1660], Train Loss: 0.0013327900087460876, Train Acc: 0.991328125, Train F1: 0.9925729935562672, Train ROC AUC: 0.99113653902082
Batch [500/1660], Train Loss: 0.03415428474545479, Train Acc: 0.99253125, Train F1: 0.9935276558814434, Train ROC AUC: 0.9922832188283982
Batch [600/1660], Train Loss: 0.0016277320683002472, Train Acc: 0.993671875, Train F1: 0.9945026710582359, Train ROC AUC: 0.9934483535753501
Batch [700/1660], Train Loss: 0.057139333337545395, Train Acc: 0.9943303571428571, Train F1: 0.9950427567390777, Train ROC AUC: 0.9941040644220693
Batch [800/1660], Train Loss: 0.000600334897171706, Train Acc: 0.99478515625, Train F1: 0.9954087323716604, Train ROC AUC: 0.9945742958944184
Batch [900/1660], Train Loss: 0.0021798808593302965, Train Acc: 0.9951215277777777, Train F1: 0.9956758477196043, Train ROC AUC: 0.9948820290036957
Batch [1000/1660], Train Loss: 0.000557897612452507, Train Acc: 0.995359375, Train F1: 0.9958583160570674, Train ROC AUC: 0.9951069969901889
Batch [1100/1660], Train Loss: 0.027416633442044258, Train Acc: 0.995625, Train F1: 0.9960786628558324, Train ROC AUC: 0.9953754753148947
Batch [1200/1660], Train Loss: 2.972705442516599e-05, Train Acc: 0.9959244791666667, Train F1: 0.996340409503567, Train ROC AUC: 0.9956916120981231
Batch [1300/1660], Train Loss: 0.0009144035284407437, Train Acc: 0.9961658653846154, Train F1: 0.9965498105480909, Train ROC AUC: 0.9959299453259262
Batch [1400/1660], Train Loss: 0.000610960298217833, Train Acc: 0.9963727678571429, Train F1: 0.9967293230493387, Train ROC AUC: 0.996142668034924
Batch [1500/1660], Train Loss: 1.0842096344276797e-05, Train Acc: 0.9965625, Train F1: 0.9968952752783072, Train ROC AUC: 0.9963287028294373
Batch [1600/1660], Train Loss: 0.00023253886320162565, Train Acc: 0.996708984375, Train F1: 0.9970210161350259, Train ROC AUC: 0.9964917068705891
--------------------------------------------------
Train Loss: 0.022637425207116427, Train Acc: 0.9968086308178943, Train F1: 0.9971094417957174, Train ROC AUC: 0.9965979175338036
Valid Loss: 0.004517739703146617, Valid Acc: 0.9989456243410152, Valid F1: 0.9989452907176362, Valid ROC AUC: 0.9984694210360161
Confusion Matrix for the validation set:
 [[9051    2]
 [  12 4213]]
Saved the new best model to ../data/models/80_20_split/pklot/puc_cloudy/5_epochs/mobilenet.pth with accuracy 0.9989456243410152
Epoch time: 444.7813296318054 seconds.
==================================================
Epoch 2/5
Batch [100/1660], Train Loss: 1.6088306438177824e-05, Train Acc: 0.99984375, Train F1: 0.9998437393995264, Train ROC AUC: 0.9997506234413965
Batch [200/1660], Train Loss: 0.0011530399788171053, Train Acc: 0.99953125, Train F1: 0.9995312181104197, Train ROC AUC: 0.999386923253267
Batch [300/1660], Train Loss: 0.0006377077661454678, Train Acc: 0.9994791666666667, Train F1: 0.9994791432446338, Train ROC AUC: 0.9993506272736545
Batch [400/1660], Train Loss: 1.1349908163538203e-05, Train Acc: 0.9995703125, Train F1: 0.999570305363503, Train ROC AUC: 0.9994865468977828
Batch [500/1660], Train Loss: 0.0001840284967329353, Train Acc: 0.99953125, Train F1: 0.9995312438542835, Train ROC AUC: 0.999446575614375
Batch [600/1660], Train Loss: 0.0024265972897410393, Train Acc: 0.9992447916666667, Train F1: 0.9992447999476426, Train ROC AUC: 0.9991396808572006
Batch [700/1660], Train Loss: 0.00028929137624800205, Train Acc: 0.9991071428571429, Train F1: 0.9991071765614502, Train ROC AUC: 0.9990066213680173
Batch [800/1660], Train Loss: 0.001037962851114571, Train Acc: 0.9990234375, Train F1: 0.9990234697489936, Train ROC AUC: 0.9989052925493125
Batch [900/1660], Train Loss: 2.611244417494163e-05, Train Acc: 0.9990972222222222, Train F1: 0.9990972354682708, Train ROC AUC: 0.9989722526479603
Batch [1000/1660], Train Loss: 2.862482870114036e-05, Train Acc: 0.9990625, Train F1: 0.9990625, Train ROC AUC: 0.9989186320349204
Batch [1100/1660], Train Loss: 3.5021213989239186e-05, Train Acc: 0.9990482954545454, Train F1: 0.9990482897714289, Train ROC AUC: 0.9988964915320017
Batch [1200/1660], Train Loss: 0.00021688485867343843, Train Acc: 0.9990755208333333, Train F1: 0.9990755157744915, Train ROC AUC: 0.998928468729413
Batch [1300/1660], Train Loss: 0.001220339210703969, Train Acc: 0.9990264423076923, Train F1: 0.9990264373880576, Train ROC AUC: 0.9988721831756333
Batch [1400/1660], Train Loss: 1.902364419947844e-05, Train Acc: 0.9990066964285714, Train F1: 0.9990066731885459, Train ROC AUC: 0.998831856248444
Batch [1500/1660], Train Loss: 0.019348111003637314, Train Acc: 0.999, Train F1: 0.9989999652033348, Train ROC AUC: 0.9988138674807067
Batch [1600/1660], Train Loss: 0.0006837203400209546, Train Acc: 0.998984375, Train F1: 0.9989843585078729, Train ROC AUC: 0.9988155916571436
--------------------------------------------------
Train Loss: 0.004147947299462424, Train Acc: 0.9989738665461666, Train F1: 0.9989738545059217, Train ROC AUC: 0.9988081550542636
Valid Loss: 0.0011562436531081543, Valid Acc: 0.9996234372646483, Valid F1: 0.9996234728846956, Valid ROC AUC: 0.9996607355631565
Confusion Matrix for the validation set:
 [[9049    4]
 [   1 4224]]
Saved the new best model to ../data/models/80_20_split/pklot/puc_cloudy/5_epochs/mobilenet.pth with accuracy 0.9996234372646483
Epoch time: 460.5291635990143 seconds.
==================================================
Epoch 3/5
Batch [100/1660], Train Loss: 0.0002555050887167454, Train Acc: 0.9996875, Train F1: 0.9996875, Train ROC AUC: 0.9996426195806052
Batch [200/1660], Train Loss: 0.0001444619265384972, Train Acc: 0.9996875, Train F1: 0.9996875, Train ROC AUC: 0.9996412012928303
Batch [300/1660], Train Loss: 6.433067756006494e-05, Train Acc: 0.9997395833333333, Train F1: 0.9997395776356238, Train ROC AUC: 0.9996778658730754
Batch [400/1660], Train Loss: 0.00017618824495002627, Train Acc: 0.9995703125, Train F1: 0.9995703054546783, Train ROC AUC: 0.9994882652099146
Batch [500/1660], Train Loss: 0.0006878488347865641, Train Acc: 0.999125, Train F1: 0.9991250229620141, Train ROC AUC: 0.9990173955734862
Batch [600/1660], Train Loss: 0.0005376457120291889, Train Acc: 0.9991666666666666, Train F1: 0.9991666849640947, Train ROC AUC: 0.9990602472797033
Batch [700/1660], Train Loss: 3.510689930408262e-05, Train Acc: 0.9991964285714285, Train F1: 0.9991964589053052, Train ROC AUC: 0.9991097353193531
Batch [800/1660], Train Loss: 0.0012687513371929526, Train Acc: 0.99919921875, Train F1: 0.9991992516184944, Train ROC AUC: 0.9991175310344019
Batch [900/1660], Train Loss: 4.369570433482295e-06, Train Acc: 0.9991840277777778, Train F1: 0.9991840456194919, Train ROC AUC: 0.9990811129906059
Batch [1000/1660], Train Loss: 0.00010100438521476462, Train Acc: 0.999125, Train F1: 0.9991250229774548, Train ROC AUC: 0.9990172542733318
Batch [1100/1660], Train Loss: 0.0639786645770073, Train Acc: 0.9991477272727273, Train F1: 0.9991477577234515, Train ROC AUC: 0.9990534331555428
Batch [1200/1660], Train Loss: 1.2843383956351317e-05, Train Acc: 0.999140625, Train F1: 0.9991406530354716, Train ROC AUC: 0.9990430520183743
Batch [1300/1660], Train Loss: 7.775321137160063e-05, Train Acc: 0.9991466346153847, Train F1: 0.9991466645005975, Train ROC AUC: 0.9990530947027819
Batch [1400/1660], Train Loss: 9.278374636778608e-05, Train Acc: 0.9991964285714285, Train F1: 0.999196450980206, Train ROC AUC: 0.9991031656835383
Batch [1500/1660], Train Loss: 2.8949520128662698e-05, Train Acc: 0.99925, Train F1: 0.9992500194795096, Train ROC AUC: 0.9991633226621005
Batch [1600/1660], Train Loss: 0.0186031311750412, Train Acc: 0.99923828125, Train F1: 0.9992382997997313, Train ROC AUC: 0.9991481999833137
--------------------------------------------------
Train Loss: 0.0034565629560957115, Train Acc: 0.999228046392529, Train F1: 0.9992280645026032, Train ROC AUC: 0.9991356737452076
Valid Loss: 0.0010016660347280147, Valid Acc: 0.9996987498117186, Valid F1: 0.9996987688142129, Valid ROC AUC: 0.9997159658735507
Confusion Matrix for the validation set:
 [[9050    3]
 [   1 4224]]
Saved the new best model to ../data/models/80_20_split/pklot/puc_cloudy/5_epochs/mobilenet.pth with accuracy 0.9996987498117186
Epoch time: 464.9557499885559 seconds.
==================================================
Epoch 4/5
Batch [100/1660], Train Loss: 0.00010008311073761433, Train Acc: 0.99921875, Train F1: 0.9992186993690363, Train ROC AUC: 0.9990371883069735
Batch [200/1660], Train Loss: 0.00012009583588223904, Train Acc: 0.9990625, Train F1: 0.9990625609967754, Train ROC AUC: 0.9989861908363485
Batch [300/1660], Train Loss: 2.241981383122038e-05, Train Acc: 0.9991666666666666, Train F1: 0.9991667404036632, Train ROC AUC: 0.9991250111550349
Batch [400/1660], Train Loss: 6.205923273228109e-05, Train Acc: 0.9990625, Train F1: 0.9990625616847474, Train ROC AUC: 0.998984095944973
Batch [500/1660], Train Loss: 4.760974843520671e-05, Train Acc: 0.99896875, Train F1: 0.998968817724184, Train ROC AUC: 0.9988763290394385
Batch [600/1660], Train Loss: 1.0435936928843148e-05, Train Acc: 0.999140625, Train F1: 0.9991406716253107, Train ROC AUC: 0.9990651516212513
Batch [700/1660], Train Loss: 1.1086617632827256e-05, Train Acc: 0.99921875, Train F1: 0.9992187861591599, Train ROC AUC: 0.9991480955366017
Batch [800/1660], Train Loss: 2.3350816263700835e-05, Train Acc: 0.99919921875, Train F1: 0.9991992642651263, Train ROC AUC: 0.9991356578905832
Batch [900/1660], Train Loss: 1.3741665497946087e-05, Train Acc: 0.99921875, Train F1: 0.9992187892615697, Train ROC AUC: 0.9991526494345294
Batch [1000/1660], Train Loss: 0.0002870777971111238, Train Acc: 0.999203125, Train F1: 0.9992031404434331, Train ROC AUC: 0.999103903252718
Batch [1100/1660], Train Loss: 0.00015370786422863603, Train Acc: 0.9991619318181818, Train F1: 0.9991619563899939, Train ROC AUC: 0.9990668347009326
Batch [1200/1660], Train Loss: 7.68789614085108e-05, Train Acc: 0.9991796875, Train F1: 0.9991797185071027, Train ROC AUC: 0.9990947060544778
Batch [1300/1660], Train Loss: 0.0001960491354111582, Train Acc: 0.9991466346153847, Train F1: 0.9991466643922018, Train ROC AUC: 0.999053791371092
Batch [1400/1660], Train Loss: 9.330511966254562e-05, Train Acc: 0.9991294642857143, Train F1: 0.9991295046291963, Train ROC AUC: 0.9990452060795949
Batch [1500/1660], Train Loss: 8.482628618367016e-05, Train Acc: 0.99915625, Train F1: 0.9991562827990192, Train ROC AUC: 0.9990688682100825
Batch [1600/1660], Train Loss: 0.10085713118314743, Train Acc: 0.99919921875, Train F1: 0.9991992447988765, Train ROC AUC: 0.9991110453778591
--------------------------------------------------
Train Loss: 0.0032967476012050454, Train Acc: 0.9992092182557614, Train F1: 0.999209242989796, Train ROC AUC: 0.9991218419126281
Valid Loss: 0.0018911058733255442, Valid Acc: 0.9995481247175779, Valid F1: 0.9995481816942491, Valid ROC AUC: 0.9996055052527619
Confusion Matrix for the validation set:
 [[9048    5]
 [   1 4224]]
Epoch time: 464.8778774738312 seconds.
==================================================
Epoch 5/5
Batch [100/1660], Train Loss: 8.822331437841058e-05, Train Acc: 0.99984375, Train F1: 0.9998437396326635, Train ROC AUC: 0.999753086419753
Batch [200/1660], Train Loss: 6.0321312048472464e-05, Train Acc: 0.99984375, Train F1: 0.9998437398567038, Train ROC AUC: 0.999755441428222
Batch [300/1660], Train Loss: 0.0007336477865464985, Train Acc: 0.9997395833333333, Train F1: 0.9997395777791337, Train ROC AUC: 0.9996801757031817
Batch [400/1660], Train Loss: 0.000634567579254508, Train Acc: 0.999375, Train F1: 0.9993750200026555, Train ROC AUC: 0.9993154752793509
Batch [500/1660], Train Loss: 8.210637315642089e-05, Train Acc: 0.9991875, Train F1: 0.9991875207299347, Train ROC AUC: 0.9990947699565366
Batch [600/1660], Train Loss: 0.0023511408362537622, Train Acc: 0.9988541666666667, Train F1: 0.9988542155252034, Train ROC AUC: 0.9987291993980771
Batch [700/1660], Train Loss: 7.205497240647674e-05, Train Acc: 0.9987946428571428, Train F1: 0.9987947093682169, Train ROC AUC: 0.9986714466804207
Batch [800/1660], Train Loss: 0.0025916551239788532, Train Acc: 0.9987890625, Train F1: 0.9987891016231863, Train ROC AUC: 0.9986410297893463
Batch [900/1660], Train Loss: 0.0001979546796064824, Train Acc: 0.99890625, Train F1: 0.9989062895226066, Train ROC AUC: 0.9987775829501832
Batch [1000/1660], Train Loss: 7.706891483394429e-05, Train Acc: 0.999015625, Train F1: 0.999015657104346, Train ROC AUC: 0.9988991778839652
Batch [1100/1660], Train Loss: 5.0360798923065886e-05, Train Acc: 0.9990767045454545, Train F1: 0.9990767317439062, Train ROC AUC: 0.9989679448549945
Batch [1200/1660], Train Loss: 0.0004089951398782432, Train Acc: 0.999140625, Train F1: 0.9991406435942999, Train ROC AUC: 0.9990332625187514
Batch [1300/1660], Train Loss: 3.704388655023649e-05, Train Acc: 0.9991826923076923, Train F1: 0.9991827085991218, Train ROC AUC: 0.999080373039959
Batch [1400/1660], Train Loss: 0.00010832615225808695, Train Acc: 0.9992299107142857, Train F1: 0.9992299285320044, Train ROC AUC: 0.9991378485631224
Batch [1500/1660], Train Loss: 9.715293344925158e-06, Train Acc: 0.9992604166666667, Train F1: 0.9992604326231789, Train ROC AUC: 0.9991715367799141
Batch [1600/1660], Train Loss: 4.442045610630885e-05, Train Acc: 0.999306640625, Train F1: 0.9993066546726144, Train ROC AUC: 0.9992230461852858
--------------------------------------------------
Train Loss: 0.003447811248009398, Train Acc: 0.9993033589395993, Train F1: 0.999303375282837, Train ROC AUC: 0.999222287509108
Valid Loss: 0.005375912020914834, Valid Acc: 0.9981171863232414, Valid F1: 0.9981159315165251, Valid ROC AUC: 0.997167645888087
Confusion Matrix for the validation set:
 [[9051    2]
 [  23 4202]]
Epoch time: 471.4199776649475 seconds.
==================================================
Average Train Loss: 0.007397298862377802
Average Train Accuracy: 0.9987046241903901
Average Train F1: 0.9987647958153749
Average Train ROC AUC: 0.9985771751510022

Best Validation Accuracy: 0.9996987498117186

Average Valid Loss: 0.0027885334570446328
Average Valid Accuracy: 0.9991866244916402
Average Valid F1: 0.9991863291254639
Average Valid ROC AUC: 0.9989238547227144

Total training time: 2306.56707572937 seconds.
