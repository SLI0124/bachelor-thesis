Dataset: pklot
Camera view: puc_rainy
Model: mobilenet
Train size split: 80
Valid size split: 20
Number of epochs: 5
**************************************************
Train split file: ../data/splits/pklot/puc_rainy_train_80_20.txt
Validation split file: ../data/splits/pklot/puc_rainy_valid_80_20.txt

**************************************************
Train dataset size: 66444
Train dataset class distribution: {'empty': 22326, 'occupied': 44118}
Valid dataset size: 8306
Valid dataset class distribution: {'empty': 2873, 'occupied': 5433}
Training the model...
**************************************************
Epoch 1/5
Batch [100/1039], Train Loss: 0.013663074001669884, Train Acc: 0.96421875, Train F1: 0.969154535887588, Train ROC AUC: 0.964626246330653
Batch [200/1039], Train Loss: 0.012563877739012241, Train Acc: 0.978984375, Train F1: 0.9814613076501295, Train ROC AUC: 0.9787093234107606
Batch [300/1039], Train Loss: 0.09928424656391144, Train Acc: 0.9834375, Train F1: 0.9850905601142504, Train ROC AUC: 0.9827728101473455
Batch [400/1039], Train Loss: 0.004148308653384447, Train Acc: 0.98578125, Train F1: 0.9870215356803099, Train ROC AUC: 0.9849563082790508
Batch [500/1039], Train Loss: 0.01327070314437151, Train Acc: 0.98784375, Train F1: 0.9888355930276684, Train ROC AUC: 0.9869124826482311
Batch [600/1039], Train Loss: 0.0012041914742439985, Train Acc: 0.9892708333333333, Train F1: 0.990098044333278, Train ROC AUC: 0.9884388599953263
Batch [700/1039], Train Loss: 0.013590928167104721, Train Acc: 0.9904017857142857, Train F1: 0.99111122721781, Train ROC AUC: 0.9896346101026696
Batch [800/1039], Train Loss: 0.001742672873660922, Train Acc: 0.99103515625, Train F1: 0.991655687445387, Train ROC AUC: 0.9902281101619113
Batch [900/1039], Train Loss: 0.07674408704042435, Train Acc: 0.9916319444444445, Train F1: 0.9921835496483848, Train ROC AUC: 0.9908569185797437
Batch [1000/1039], Train Loss: 0.000732585322111845, Train Acc: 0.992171875, Train F1: 0.9926684245294582, Train ROC AUC: 0.9914129046040151
--------------------------------------------------
Train Loss: 0.049905896837701184, Train Acc: 0.9923093131057733, Train F1: 0.9927876523093112, Train ROC AUC: 0.9915563905504582
Valid Loss: 0.010533394095881913, Valid Acc: 0.9984348663616662, Valid F1: 0.998434415659421, Valid ROC AUC: 0.9979835683354401
Confusion Matrix for the validation set:
 [[2863   10]
 [   3 5430]]
Saved the new best model to ../data/models/80_20_split/pklot/puc_rainy/5_epochs/mobilenet.pth with accuracy 0.9984348663616662
Epoch time: 241.3693869113922 seconds.
==================================================
Epoch 2/5
Batch [100/1039], Train Loss: 0.001846715109422803, Train Acc: 0.9975, Train F1: 0.997499388106927, Train ROC AUC: 0.9969194278139637
Batch [200/1039], Train Loss: 0.0034683209378272295, Train Acc: 0.99734375, Train F1: 0.997343267152558, Train ROC AUC: 0.9968107401347581
Batch [300/1039], Train Loss: 0.0007588814478367567, Train Acc: 0.99734375, Train F1: 0.9973429900724591, Train ROC AUC: 0.9967420992902345
Batch [400/1039], Train Loss: 0.15494531393051147, Train Acc: 0.99625, Train F1: 0.996248602830372, Train ROC AUC: 0.9954314423996362
Batch [500/1039], Train Loss: 0.003510222304612398, Train Acc: 0.9965625, Train F1: 0.9965613102110701, Train ROC AUC: 0.9958024923033579
Batch [600/1039], Train Loss: 0.001586628844961524, Train Acc: 0.99671875, Train F1: 0.9967176065494524, Train ROC AUC: 0.9959703598272507
Batch [700/1039], Train Loss: 0.0015955191338434815, Train Acc: 0.9966741071428571, Train F1: 0.9966727598860955, Train ROC AUC: 0.99586719701008
Batch [800/1039], Train Loss: 0.0010239114053547382, Train Acc: 0.9967578125, Train F1: 0.9967566915041843, Train ROC AUC: 0.996022508932558
Batch [900/1039], Train Loss: 0.00034924017381854355, Train Acc: 0.996875, Train F1: 0.996873915052323, Train ROC AUC: 0.9961495712881268
Batch [1000/1039], Train Loss: 0.0026873054448515177, Train Acc: 0.996984375, Train F1: 0.9969833153991223, Train ROC AUC: 0.9962711124024253
--------------------------------------------------
Train Loss: 0.017027472972583484, Train Acc: 0.9970350972247306, Train F1: 0.9970340603690789, Train ROC AUC: 0.9963292689967717
Valid Loss: 0.013798943513225262, Valid Acc: 0.997832891885384, Valid F1: 0.997832891885384, Valid ROC AUC: 0.9976054213307199
Confusion Matrix for the validation set:
 [[2864    9]
 [   9 5424]]
Epoch time: 244.25825357437134 seconds.
==================================================
Epoch 3/5
Batch [100/1039], Train Loss: 0.0011020501842722297, Train Acc: 0.99671875, Train F1: 0.996717810153749, Train ROC AUC: 0.996041473659471
Batch [200/1039], Train Loss: 0.0037456126883625984, Train Acc: 0.996953125, Train F1: 0.996952358723305, Train ROC AUC: 0.9963543343150008
Batch [300/1039], Train Loss: 0.0035467634443193674, Train Acc: 0.9970833333333333, Train F1: 0.9970826782449077, Train ROC AUC: 0.9965231388259856
Batch [400/1039], Train Loss: 0.017475886270403862, Train Acc: 0.9973046875, Train F1: 0.9973042599322173, Train ROC AUC: 0.9968197132776602
Batch [500/1039], Train Loss: 0.0020465070847421885, Train Acc: 0.99721875, Train F1: 0.9972181353479678, Train ROC AUC: 0.99665661579134
Batch [600/1039], Train Loss: 0.003604926634579897, Train Acc: 0.9972135416666666, Train F1: 0.9972128660866996, Train ROC AUC: 0.9966292213139362
Batch [700/1039], Train Loss: 0.002402747515588999, Train Acc: 0.9972991071428572, Train F1: 0.9972983649684956, Train ROC AUC: 0.996692293464967
Batch [800/1039], Train Loss: 0.12658658623695374, Train Acc: 0.997265625, Train F1: 0.9972648685679184, Train ROC AUC: 0.9966533701418459
Batch [900/1039], Train Loss: 0.0018315663328394294, Train Acc: 0.99734375, Train F1: 0.9973430529659704, Train ROC AUC: 0.99676162429557
Batch [1000/1039], Train Loss: 0.0004423079371917993, Train Acc: 0.99746875, Train F1: 0.9974680813183678, Train ROC AUC: 0.9969016421452265
--------------------------------------------------
Train Loss: 0.014666290046886745, Train Acc: 0.9975167057973632, Train F1: 0.9975160308874893, Train ROC AUC: 0.9969463626894228
Valid Loss: 0.011544274892478895, Valid Acc: 0.9984348663616662, Valid F1: 0.9984346735679471, Valid ROC AUC: 0.9981475761850096
Confusion Matrix for the validation set:
 [[2865    8]
 [   5 5428]]
Epoch time: 246.239848613739 seconds.
==================================================
Epoch 4/5
Batch [100/1039], Train Loss: 0.007254127413034439, Train Acc: 0.99640625, Train F1: 0.9964035736759138, Train ROC AUC: 0.9952419198151572
Batch [200/1039], Train Loss: 0.006445858161896467, Train Acc: 0.99703125, Train F1: 0.9970300623448267, Train ROC AUC: 0.9962807382287282
Batch [300/1039], Train Loss: 0.0012018686393275857, Train Acc: 0.9967708333333334, Train F1: 0.9967695788278135, Train ROC AUC: 0.9959869883678222
Batch [400/1039], Train Loss: 0.13900157809257507, Train Acc: 0.9964453125, Train F1: 0.9964437181831997, Train ROC AUC: 0.9955678869579538
Batch [500/1039], Train Loss: 0.0016149316215887666, Train Acc: 0.9968125, Train F1: 0.9968113226350344, Train ROC AUC: 0.9960594378629938
Batch [600/1039], Train Loss: 0.0008253456908278167, Train Acc: 0.996875, Train F1: 0.9968737895248637, Train ROC AUC: 0.9961071281769709
Batch [700/1039], Train Loss: 0.000739977287594229, Train Acc: 0.9969196428571429, Train F1: 0.9969184719508195, Train ROC AUC: 0.996167397470629
Batch [800/1039], Train Loss: 0.0007310737855732441, Train Acc: 0.9970703125, Train F1: 0.997069288155775, Train ROC AUC: 0.9963615802083651
Batch [900/1039], Train Loss: 0.00045414583291858435, Train Acc: 0.9972395833333333, Train F1: 0.9972386486734078, Train ROC AUC: 0.9965707602343729
Batch [1000/1039], Train Loss: 0.0003248512512072921, Train Acc: 0.99721875, Train F1: 0.9972178225127669, Train ROC AUC: 0.9965524818905716
--------------------------------------------------
Train Loss: 0.015146298307678795, Train Acc: 0.9972458009752574, Train F1: 0.9972448991635949, Train ROC AUC: 0.9965874939308825
Valid Loss: 0.012158445311853519, Valid Acc: 0.9980736816758969, Valid F1: 0.9980736816758969, Valid ROC AUC: 0.9978714856273065
Confusion Matrix for the validation set:
 [[2865    8]
 [   8 5425]]
Epoch time: 246.9607012271881 seconds.
==================================================
Epoch 5/5
Batch [100/1039], Train Loss: 0.0006153880967758596, Train Acc: 0.99828125, Train F1: 0.9982811544307428, Train ROC AUC: 0.9980304531034474
Batch [200/1039], Train Loss: 0.010451910085976124, Train Acc: 0.998046875, Train F1: 0.9980464061750166, Train ROC AUC: 0.9976026143841626
Batch [300/1039], Train Loss: 0.000979805481620133, Train Acc: 0.99765625, Train F1: 0.997655518290478, Train ROC AUC: 0.9970846622024766
Batch [400/1039], Train Loss: 0.0014630582882091403, Train Acc: 0.99765625, Train F1: 0.9976555256811923, Train ROC AUC: 0.9970782153741085
Batch [500/1039], Train Loss: 0.00041485863039270043, Train Acc: 0.99746875, Train F1: 0.9974679097681499, Train ROC AUC: 0.9968365577472406
Batch [600/1039], Train Loss: 0.08584042638540268, Train Acc: 0.9974739583333333, Train F1: 0.9974731156271494, Train ROC AUC: 0.9968411431992249
Batch [700/1039], Train Loss: 0.00030344040715135634, Train Acc: 0.9975892857142857, Train F1: 0.9975884983727692, Train ROC AUC: 0.9969774212915614
Batch [800/1039], Train Loss: 0.000779031659476459, Train Acc: 0.99765625, Train F1: 0.9976555419823783, Train ROC AUC: 0.9970731387308691
Batch [900/1039], Train Loss: 0.0012747986475005746, Train Acc: 0.9977083333333333, Train F1: 0.9977075965440031, Train ROC AUC: 0.9971093998455318
Batch [1000/1039], Train Loss: 0.00013666391896549612, Train Acc: 0.9976875, Train F1: 0.9976868078713529, Train ROC AUC: 0.9971107557491912
--------------------------------------------------
Train Loss: 0.014510168981258497, Train Acc: 0.9976521582084161, Train F1: 0.9976514809291154, Train ROC AUC: 0.9970815483856851
Valid Loss: 0.012569022996467538, Valid Acc: 0.997832891885384, Valid F1: 0.9978323572383713, Valid ROC AUC: 0.9973594095563657
Confusion Matrix for the validation set:
 [[2861   12]
 [   6 5427]]
Epoch time: 247.84823608398438 seconds.
==================================================
Average Train Loss: 0.02225122542922174
Average Train Accuracy: 0.9963518150623081
Average Train F1: 0.9964468247317179
Average Train ROC AUC: 0.995700212910644

Best Validation Accuracy: 0.9984348663616662

Average Valid Loss: 0.012120816161981426
Average Valid Accuracy: 0.9981218396339994
Average Valid F1: 0.9981216040054042
Average Valid ROC AUC: 0.9977934922069684

Total training time: 1226.676426410675 seconds.
