Dataset: pklot
Camera view: puc_rainy
Model: shufflenet
Train size split: 80
Valid size split: 20
Number of epochs: 5
**************************************************
Train split file: ../data/splits/pklot/puc_rainy_train_80_20.txt
Validation split file: ../data/splits/pklot/puc_rainy_valid_80_20.txt

**************************************************
Train dataset size: 66444
Train dataset class distribution: {'empty': 22326, 'occupied': 44118}
Valid dataset size: 8306
Valid dataset class distribution: {'empty': 2873, 'occupied': 5433}
Training the model...
**************************************************
Epoch 1/5
Batch [100/1039], Train Loss: 0.027122169733047485, Train Acc: 0.95234375, Train F1: 0.9571901013251317, Train ROC AUC: 0.9486431842628802
Batch [200/1039], Train Loss: 0.010112603195011616, Train Acc: 0.972109375, Train F1: 0.9745642467959188, Train ROC AUC: 0.9696397296470999
Batch [300/1039], Train Loss: 0.1308479905128479, Train Acc: 0.97953125, Train F1: 0.9811760197547433, Train ROC AUC: 0.9774503796317859
Batch [400/1039], Train Loss: 0.026996435597538948, Train Acc: 0.98328125, Train F1: 0.9845158508198009, Train ROC AUC: 0.9813894292009903
Batch [500/1039], Train Loss: 0.0036304828245192766, Train Acc: 0.9856875, Train F1: 0.9866757082622494, Train ROC AUC: 0.9839948906611401
Batch [600/1039], Train Loss: 0.0040560257621109486, Train Acc: 0.987265625, Train F1: 0.9880900693388697, Train ROC AUC: 0.9857148087442021
Batch [700/1039], Train Loss: 0.02307184413075447, Train Acc: 0.9884375, Train F1: 0.9891444073098955, Train ROC AUC: 0.9870013307287508
Batch [800/1039], Train Loss: 0.0014087979216128588, Train Acc: 0.98958984375, Train F1: 0.9902086836490145, Train ROC AUC: 0.988287722493099
Batch [900/1039], Train Loss: 0.0018191492417827249, Train Acc: 0.9904513888888888, Train F1: 0.9910015252746818, Train ROC AUC: 0.9892204186846217
Batch [1000/1039], Train Loss: 0.007809351198375225, Train Acc: 0.991046875, Train F1: 0.991542060834927, Train ROC AUC: 0.9898794379486491
--------------------------------------------------
Train Loss: 0.05790220279427746, Train Acc: 0.9911955932815604, Train F1: 0.9916726376459957, Train ROC AUC: 0.9900532130210994
Valid Loss: 0.013896341243078215, Valid Acc: 0.9973513123043583, Valid F1: 0.9973497818081598, Valid ROC AUC: 0.9964992652640535
Confusion Matrix for the validation set:
 [[2855   18]
 [   4 5429]]
Saved the new best model to ../data/models/80_20_split/pklot/puc_rainy/5_epochs/shufflenet.pth with accuracy 0.9973513123043583
Epoch time: 130.13113451004028 seconds.
==================================================
Epoch 2/5
Batch [100/1039], Train Loss: 0.0006035433616489172, Train Acc: 0.9959375, Train F1: 0.9959347550289652, Train ROC AUC: 0.9948001534195344
Batch [200/1039], Train Loss: 0.022316329181194305, Train Acc: 0.996640625, Train F1: 0.996638799479492, Train ROC AUC: 0.995702246717747
Batch [300/1039], Train Loss: 0.0028707836754620075, Train Acc: 0.9969270833333334, Train F1: 0.9969257544173089, Train ROC AUC: 0.9961409226318172
Batch [400/1039], Train Loss: 0.0023998264223337173, Train Acc: 0.996953125, Train F1: 0.9969521618862397, Train ROC AUC: 0.9962723854094675
Batch [500/1039], Train Loss: 0.11702066659927368, Train Acc: 0.9970625, Train F1: 0.9970614787064402, Train ROC AUC: 0.9963584369002778
Batch [600/1039], Train Loss: 0.01630665920674801, Train Acc: 0.996875, Train F1: 0.9968738585976934, Train ROC AUC: 0.9961340629274965
Batch [700/1039], Train Loss: 0.00157349300570786, Train Acc: 0.9969642857142857, Train F1: 0.9969633407882783, Train ROC AUC: 0.9962911874518202
Batch [800/1039], Train Loss: 0.0004182815901003778, Train Acc: 0.99703125, Train F1: 0.9970302297464869, Train ROC AUC: 0.9963348895377236
Batch [900/1039], Train Loss: 0.0007724394090473652, Train Acc: 0.9970833333333333, Train F1: 0.9970823315557653, Train ROC AUC: 0.9963937414289269
Batch [1000/1039], Train Loss: 0.0019323135493323207, Train Acc: 0.997125, Train F1: 0.997123971612586, Train ROC AUC: 0.9964214230832084
--------------------------------------------------
Train Loss: 0.01622033967809412, Train Acc: 0.9971253988320992, Train F1: 0.997124425580024, Train ROC AUC: 0.9964415171357837
Valid Loss: 0.010717156081227586, Valid Acc: 0.9979532867806405, Valid F1: 0.9979530346657768, Valid ROC AUC: 0.9976154475918363
Confusion Matrix for the validation set:
 [[2863   10]
 [   7 5426]]
Saved the new best model to ../data/models/80_20_split/pklot/puc_rainy/5_epochs/shufflenet.pth with accuracy 0.9979532867806405
Epoch time: 133.07546138763428 seconds.
==================================================
Epoch 3/5
Batch [100/1039], Train Loss: 0.0013623598497360945, Train Acc: 0.99765625, Train F1: 0.9976553421228368, Train ROC AUC: 0.9970083416804428
Batch [200/1039], Train Loss: 0.006707530468702316, Train Acc: 0.997890625, Train F1: 0.997890211153248, Train ROC AUC: 0.9974523623678869
Batch [300/1039], Train Loss: 0.0003783782885875553, Train Acc: 0.99765625, Train F1: 0.9976557559495416, Train ROC AUC: 0.9971639267204071
Batch [400/1039], Train Loss: 0.0009004657040350139, Train Acc: 0.997890625, Train F1: 0.9978901961640052, Train ROC AUC: 0.9974291369955278
Batch [500/1039], Train Loss: 0.0019386220956221223, Train Acc: 0.99753125, Train F1: 0.9975305900147677, Train ROC AUC: 0.9969620359704592
Batch [600/1039], Train Loss: 0.005166089627891779, Train Acc: 0.9975520833333333, Train F1: 0.9975515219664465, Train ROC AUC: 0.9970303542556439
Batch [700/1039], Train Loss: 0.0784456878900528, Train Acc: 0.9975, Train F1: 0.9974993481243927, Train ROC AUC: 0.9969437093875331
Batch [800/1039], Train Loss: 0.0018318294314667583, Train Acc: 0.9975, Train F1: 0.997499316908599, Train ROC AUC: 0.9969267725044129
Batch [900/1039], Train Loss: 0.00027338528889231384, Train Acc: 0.9975868055555556, Train F1: 0.9975861135273633, Train ROC AUC: 0.9970121957471677
Batch [1000/1039], Train Loss: 0.0010010621044784784, Train Acc: 0.997640625, Train F1: 0.9976399870054037, Train ROC AUC: 0.997087021232482
--------------------------------------------------
Train Loss: 0.014011338129374077, Train Acc: 0.9976521582084161, Train F1: 0.9976515070523932, Train ROC AUC: 0.997092610556437
Valid Loss: 0.012472514922914202, Valid Acc: 0.9979532867806405, Valid F1: 0.9979533706602409, Valid ROC AUC: 0.9977794554414058
Confusion Matrix for the validation set:
 [[2865    8]
 [   9 5424]]
Epoch time: 132.62384343147278 seconds.
==================================================
Epoch 4/5
Batch [100/1039], Train Loss: 0.08875887840986252, Train Acc: 0.99765625, Train F1: 0.9976558576255763, Train ROC AUC: 0.9972217580213903
Batch [200/1039], Train Loss: 0.0007379906019195914, Train Acc: 0.99765625, Train F1: 0.9976558385757437, Train ROC AUC: 0.9971896936990113
Batch [300/1039], Train Loss: 0.0005665838834829628, Train Acc: 0.9978645833333334, Train F1: 0.9978640534493087, Train ROC AUC: 0.9973621666725878
Batch [400/1039], Train Loss: 0.013000364415347576, Train Acc: 0.9976953125, Train F1: 0.997694746979403, Train ROC AUC: 0.9971712840578033
Batch [500/1039], Train Loss: 0.0027700879145413637, Train Acc: 0.99778125, Train F1: 0.9977806096601164, Train ROC AUC: 0.9972249888950293
Batch [600/1039], Train Loss: 0.008465220220386982, Train Acc: 0.9975260416666667, Train F1: 0.9975253547117194, Train ROC AUC: 0.9969522506122228
Batch [700/1039], Train Loss: 0.0020831695292145014, Train Acc: 0.9976339285714285, Train F1: 0.9976332649223306, Train ROC AUC: 0.9970676303159394
Batch [800/1039], Train Loss: 0.0032505737617611885, Train Acc: 0.9976953125, Train F1: 0.9976947163590049, Train ROC AUC: 0.9971603709774234
Batch [900/1039], Train Loss: 0.0003337983216624707, Train Acc: 0.9977604166666667, Train F1: 0.9977598314359242, Train ROC AUC: 0.9972316969157105
Batch [1000/1039], Train Loss: 0.0007586519350297749, Train Acc: 0.997734375, Train F1: 0.9977337362107679, Train ROC AUC: 0.9971805790293712
--------------------------------------------------
Train Loss: 0.014892600132362804, Train Acc: 0.9976973090121004, Train F1: 0.9976966319447668, Train ROC AUC: 0.9971266102844393
Valid Loss: 0.013939639663574501, Valid Acc: 0.9974717071996148, Valid F1: 0.9974703512623765, Valid ROC AUC: 0.9966732993747393
Confusion Matrix for the validation set:
 [[2856   17]
 [   4 5429]]
Epoch time: 134.29363536834717 seconds.
==================================================
Epoch 5/5
Batch [100/1039], Train Loss: 0.0013651431072503328, Train Acc: 0.99546875, Train F1: 0.995465887892934, Train ROC AUC: 0.9943014606236633
Batch [200/1039], Train Loss: 0.11205080896615982, Train Acc: 0.996796875, Train F1: 0.9967951956594178, Train ROC AUC: 0.9959200212024308
Batch [300/1039], Train Loss: 0.0008423379622399807, Train Acc: 0.9972395833333333, Train F1: 0.9972385187677151, Train ROC AUC: 0.9965492431038747
Batch [400/1039], Train Loss: 0.0007829027599655092, Train Acc: 0.9973828125, Train F1: 0.9973818959887558, Train ROC AUC: 0.9967342184069969
Batch [500/1039], Train Loss: 0.00045450538164004683, Train Acc: 0.99775, Train F1: 0.9977492813558547, Train ROC AUC: 0.997165367436412
Batch [600/1039], Train Loss: 0.00034624311956577003, Train Acc: 0.9978385416666666, Train F1: 0.9978378154526754, Train ROC AUC: 0.9972433837905633
Batch [700/1039], Train Loss: 0.0006774259964004159, Train Acc: 0.9977678571428571, Train F1: 0.9977671189589575, Train ROC AUC: 0.9971670469414305
Batch [800/1039], Train Loss: 0.0033768154680728912, Train Acc: 0.997734375, Train F1: 0.9977335856294208, Train ROC AUC: 0.9971103130961733
Batch [900/1039], Train Loss: 0.00318306777626276, Train Acc: 0.9976215277777778, Train F1: 0.9976207497758031, Train ROC AUC: 0.9970078589263792
Batch [1000/1039], Train Loss: 0.061841387301683426, Train Acc: 0.99771875, Train F1: 0.9977180919330187, Train ROC AUC: 0.9971552966652032
--------------------------------------------------
Train Loss: 0.013983665675033423, Train Acc: 0.9976973090121004, Train F1: 0.9976966575685822, Train ROC AUC: 0.9971376724551911
Valid Loss: 0.011978034958100089, Valid Acc: 0.9980736816758969, Valid F1: 0.9980727284989656, Valid ROC AUC: 0.9973794620785983
Confusion Matrix for the validation set:
 [[2859   14]
 [   2 5431]]
Saved the new best model to ../data/models/80_20_split/pklot/puc_rainy/5_epochs/shufflenet.pth with accuracy 0.9980736816758969
Epoch time: 135.3758487701416 seconds.
==================================================
Average Train Loss: 0.023402029281828378
Average Train Accuracy: 0.9962735536692552
Average Train F1: 0.9963683719583525
Average Train ROC AUC: 0.99557032469059

Best Validation Accuracy: 0.9980736816758969

Average Valid Loss: 0.012600737373778917
Average Valid Accuracy: 0.9977606549482303
Average Valid F1: 0.9977598533791039
Average Valid ROC AUC: 0.9971893859501266

Total training time: 665.4999234676361 seconds.
