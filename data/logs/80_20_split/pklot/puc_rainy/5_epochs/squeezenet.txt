Dataset: pklot
Camera view: puc_rainy
Model: squeezenet
Train size split: 80
Valid size split: 20
Number of epochs: 5
**************************************************
Train split file: ../data/splits/pklot/puc_rainy_train_80_20.txt
Validation split file: ../data/splits/pklot/puc_rainy_valid_80_20.txt

**************************************************
Train dataset size: 66444
Train dataset class distribution: {'empty': 22326, 'occupied': 44118}
Valid dataset size: 8306
Valid dataset class distribution: {'empty': 2873, 'occupied': 5433}
Training the model...
**************************************************
Epoch 1/5
Batch [100/1039], Train Loss: 0.05089292302727699, Train Acc: 0.79703125, Train F1: 0.7870949345158573, Train ROC AUC: 0.7252047392492819
Batch [200/1039], Train Loss: 0.10595747083425522, Train Acc: 0.887421875, Train F1: 0.8863975679705952, Train ROC AUC: 0.8500999656002752
Batch [300/1039], Train Loss: 0.14004532992839813, Train Acc: 0.9206770833333333, Train F1: 0.9207538262227907, Train ROC AUC: 0.8945376725282956
Batch [400/1039], Train Loss: 0.014186888933181763, Train Acc: 0.9376953125, Train F1: 0.9380618924813944, Train ROC AUC: 0.9183050838410979
Batch [500/1039], Train Loss: 0.05102890357375145, Train Acc: 0.9490625, Train F1: 0.9494985601212963, Train ROC AUC: 0.9335839991604907
Batch [600/1039], Train Loss: 0.0020970699843019247, Train Acc: 0.95625, Train F1: 0.9566841057435919, Train ROC AUC: 0.9432905009219439
Batch [700/1039], Train Loss: 0.005229537840932608, Train Acc: 0.9616517857142857, Train F1: 0.9620647861913424, Train ROC AUC: 0.9502800196836437
Batch [800/1039], Train Loss: 0.0001793968549463898, Train Acc: 0.96568359375, Train F1: 0.9660726787016405, Train ROC AUC: 0.9555531510279867
Batch [900/1039], Train Loss: 0.006407689303159714, Train Acc: 0.9688368055555555, Train F1: 0.9692026415774181, Train ROC AUC: 0.959757791345809
Batch [1000/1039], Train Loss: 0.004406516905874014, Train Acc: 0.9714375, Train F1: 0.9717802914041204, Train ROC AUC: 0.9631454732544215
--------------------------------------------------
Train Loss: 0.08706495589295077, Train Acc: 0.972427909216784, Train F1: 0.9727630813599257, Train ROC AUC: 0.9644069280304308
Valid Loss: 0.01873679830907629, Valid Acc: 0.995906573561281, Valid F1: 0.995906573561281, Valid ROC AUC: 0.9954769069580265
Confusion Matrix for the validation set:
 [[2856   17]
 [  17 5416]]
Saved the new best model to ../data/models/80_20_split/pklot/puc_rainy/5_epochs/squeezenet.pth with accuracy 0.995906573561281
Epoch time: 201.6080892086029 seconds.
==================================================
Epoch 2/5
Batch [100/1039], Train Loss: 0.026952149346470833, Train Acc: 0.995, Train F1: 0.9949994739092933, Train ROC AUC: 0.9943820805424626
Batch [200/1039], Train Loss: 0.0012500991579145193, Train Acc: 0.994765625, Train F1: 0.9947637552379817, Train ROC AUC: 0.9938313163730943
Batch [300/1039], Train Loss: 0.004502454772591591, Train Acc: 0.995, Train F1: 0.9949983020403064, Train ROC AUC: 0.9940782895565156
Batch [400/1039], Train Loss: 0.003991032484918833, Train Acc: 0.995078125, Train F1: 0.9950764497550508, Train ROC AUC: 0.9941623756745879
Batch [500/1039], Train Loss: 0.003763432614505291, Train Acc: 0.995375, Train F1: 0.9953732202547697, Train ROC AUC: 0.9944527869087563
Batch [600/1039], Train Loss: 0.0011795005993917584, Train Acc: 0.9956510416666666, Train F1: 0.9956495200043816, Train ROC AUC: 0.9947928621433003
Batch [700/1039], Train Loss: 0.04920559749007225, Train Acc: 0.9956696428571429, Train F1: 0.9956680111776363, Train ROC AUC: 0.9947773765700684
Batch [800/1039], Train Loss: 0.005182747729122639, Train Acc: 0.99564453125, Train F1: 0.9956430087814861, Train ROC AUC: 0.9947804849078735
Batch [900/1039], Train Loss: 0.029615674167871475, Train Acc: 0.99578125, Train F1: 0.9957799899119568, Train ROC AUC: 0.9949814358380498
Batch [1000/1039], Train Loss: 0.001178512116894126, Train Acc: 0.99596875, Train F1: 0.9959675455882352, Train ROC AUC: 0.9951871962105758
--------------------------------------------------
Train Loss: 0.023243868978492344, Train Acc: 0.9958160255252544, Train F1: 0.9958148185788078, Train ROC AUC: 0.9950241003643949
Valid Loss: 0.02515752323043461, Valid Acc: 0.9953045990849988, Valid F1: 0.9953001228469063, Valid ROC AUC: 0.9938687010815357
Confusion Matrix for the validation set:
 [[2842   31]
 [   8 5425]]
Epoch time: 203.2622447013855 seconds.
==================================================
Epoch 3/5
Batch [100/1039], Train Loss: 0.011521569453179836, Train Acc: 0.99546875, Train F1: 0.9954670450816115, Train ROC AUC: 0.9946134223036517
Batch [200/1039], Train Loss: 0.07890637964010239, Train Acc: 0.99484375, Train F1: 0.9948419787673407, Train ROC AUC: 0.9938872558705599
Batch [300/1039], Train Loss: 0.4359460175037384, Train Acc: 0.9942708333333333, Train F1: 0.9942678020717487, Train ROC AUC: 0.9930767549856916
Batch [400/1039], Train Loss: 0.012292154133319855, Train Acc: 0.99390625, Train F1: 0.9939035999832093, Train ROC AUC: 0.9927317461423293
Batch [500/1039], Train Loss: 0.11638975143432617, Train Acc: 0.994125, Train F1: 0.9941225523580406, Train ROC AUC: 0.9929976501037469
Batch [600/1039], Train Loss: 0.001096439897082746, Train Acc: 0.994609375, Train F1: 0.9946074637347715, Train ROC AUC: 0.993609162275092
Batch [700/1039], Train Loss: 0.0015547543298453093, Train Acc: 0.9947991071428571, Train F1: 0.9947972791202806, Train ROC AUC: 0.9938301415513833
Batch [800/1039], Train Loss: 0.003397986525669694, Train Acc: 0.995078125, Train F1: 0.9950765820450701, Train ROC AUC: 0.9941837629563478
Batch [900/1039], Train Loss: 0.00033846605219878256, Train Acc: 0.9953125, Train F1: 0.995310951057544, Train ROC AUC: 0.9944257544118097
Batch [1000/1039], Train Loss: 0.004457049537450075, Train Acc: 0.99546875, Train F1: 0.9954672391038707, Train ROC AUC: 0.994592523396445
--------------------------------------------------
Train Loss: 0.024268292977231883, Train Acc: 0.9955601709710433, Train F1: 0.9955587172309316, Train ROC AUC: 0.9946986891900261
Valid Loss: 0.03405524856196, Valid Acc: 0.9913315675415363, Valid F1: 0.9913111336117044, Valid ROC AUC: 0.9881255754289077
Confusion Matrix for the validation set:
 [[2809   64]
 [   8 5425]]
Epoch time: 202.81314396858215 seconds.
==================================================
Epoch 4/5
Batch [100/1039], Train Loss: 0.0005246539367362857, Train Acc: 0.998125, Train F1: 0.9981239290662688, Train ROC AUC: 0.9973357791754018
Batch [200/1039], Train Loss: 0.026441074907779694, Train Acc: 0.996640625, Train F1: 0.9966401368837041, Train ROC AUC: 0.9960828093164731
Batch [300/1039], Train Loss: 0.0008832745952531695, Train Acc: 0.9959375, Train F1: 0.9959364085913462, Train ROC AUC: 0.9951801150481332
Batch [400/1039], Train Loss: 0.0005287672975100577, Train Acc: 0.9953515625, Train F1: 0.9953501489163, Train ROC AUC: 0.9944824350009703
Batch [500/1039], Train Loss: 0.0004474652814678848, Train Acc: 0.9958125, Train F1: 0.9958110506207581, Train ROC AUC: 0.9949619225399553
Batch [600/1039], Train Loss: 0.002753137145191431, Train Acc: 0.9959895833333333, Train F1: 0.9959882100542643, Train ROC AUC: 0.9951733860656201
Batch [700/1039], Train Loss: 0.11118273437023163, Train Acc: 0.9960714285714286, Train F1: 0.9960699442782238, Train ROC AUC: 0.9952238069549943
Batch [800/1039], Train Loss: 0.012289830483496189, Train Acc: 0.99625, Train F1: 0.9962486474086467, Train ROC AUC: 0.9954375712071146
Batch [900/1039], Train Loss: 0.0030779181979596615, Train Acc: 0.9964756944444444, Train F1: 0.9964745003528657, Train ROC AUC: 0.9957144366516387
Batch [1000/1039], Train Loss: 0.0005361967487260699, Train Acc: 0.99653125, Train F1: 0.996530053782424, Train ROC AUC: 0.9957714960100496
--------------------------------------------------
Train Loss: 0.02013787392615339, Train Acc: 0.9965835891878876, Train F1: 0.9965823944354364, Train ROC AUC: 0.9958233391554707
Valid Loss: 0.0168508687589425, Valid Acc: 0.996990127618589, Valid F1: 0.9969897568614365, Valid ROC AUC: 0.9965511904054895
Confusion Matrix for the validation set:
 [[2859   14]
 [  11 5422]]
Saved the new best model to ../data/models/80_20_split/pklot/puc_rainy/5_epochs/squeezenet.pth with accuracy 0.996990127618589
Epoch time: 202.85501384735107 seconds.
==================================================
Epoch 5/5
Batch [100/1039], Train Loss: 0.0051207831129431725, Train Acc: 0.99578125, Train F1: 0.9957796373758377, Train ROC AUC: 0.994939982564961
Batch [200/1039], Train Loss: 0.10634995996952057, Train Acc: 0.99625, Train F1: 0.9962493524783969, Train ROC AUC: 0.9956251709986321
Batch [300/1039], Train Loss: 0.008036729879677296, Train Acc: 0.996875, Train F1: 0.9968741637567503, Train ROC AUC: 0.9962342987657982
Batch [400/1039], Train Loss: 0.0010364364134147763, Train Acc: 0.9969140625, Train F1: 0.9969132987864058, Train ROC AUC: 0.996287459370069
Batch [500/1039], Train Loss: 0.0002813469909597188, Train Acc: 0.997, Train F1: 0.9969991543371648, Train ROC AUC: 0.9963442728045709
Batch [600/1039], Train Loss: 0.00015467393677681684, Train Acc: 0.9971875, Train F1: 0.997186630677503, Train ROC AUC: 0.9965366390362578
Batch [700/1039], Train Loss: 0.006356335710734129, Train Acc: 0.9969196428571429, Train F1: 0.9969185743086991, Train ROC AUC: 0.9962004955668984
Batch [800/1039], Train Loss: 0.005027660634368658, Train Acc: 0.996953125, Train F1: 0.9969521114013365, Train ROC AUC: 0.9962515979569367
Batch [900/1039], Train Loss: 0.0003177738981321454, Train Acc: 0.9966666666666667, Train F1: 0.9966652999227227, Train ROC AUC: 0.9958566502075246
Batch [1000/1039], Train Loss: 0.013828372582793236, Train Acc: 0.995015625, Train F1: 0.9950132955758958, Train ROC AUC: 0.9939497538983142
--------------------------------------------------
Train Loss: 0.028519436141131536, Train Acc: 0.9944314008789357, Train F1: 0.994428178634575, Train ROC AUC: 0.9931849657448552
Valid Loss: 0.09373762186330098, Valid Acc: 0.987719720683843, Valid F1: 0.9877375401033581, Valid ROC AUC: 0.9879067915202048
Confusion Matrix for the validation set:
 [[2840   33]
 [  69 5364]]
Epoch time: 202.83175683021545 seconds.
==================================================
Average Train Loss: 0.036646885583191985
Average Train Accuracy: 0.9909638191559809
Average Train F1: 0.9910294380479353
Average Train ROC AUC: 0.9886276044970355

Best Validation Accuracy: 0.996990127618589

Average Valid Loss: 0.03770761214474287
Average Valid Accuracy: 0.9934505176980496
Average Valid F1: 0.9934490253969372
Average Valid ROC AUC: 0.9923858330788328

Total training time: 1013.3702485561371 seconds.
