Dataset: pklot
Camera view: all_sunny
Model: mobilenet
Train size split: 80
Valid size split: 20
Number of epochs: 5
**************************************************
Train split file: ../data/splits/pklot/all_sunny_train_80_20.txt
Validation split file: ../data/splits/pklot/all_sunny_valid_80_20.txt

**************************************************
Train dataset size: 293421
Train dataset class distribution: {'empty': 144408, 'occupied': 149013}
Valid dataset size: 36678
Valid dataset class distribution: {'empty': 17971, 'occupied': 18707}
Training the model...
**************************************************
Epoch 1/5
Batch [100/4585], Train Loss: 0.12978404760360718, Train Acc: 0.9371875, Train F1: 0.9418980671138177, Train ROC AUC: 0.936689693628073
Batch [200/4585], Train Loss: 0.0902688279747963, Train Acc: 0.95703125, Train F1: 0.9594277862546443, Train ROC AUC: 0.9567219289624925
Batch [300/4585], Train Loss: 0.012172635644674301, Train Acc: 0.9651041666666667, Train F1: 0.9667137034854982, Train ROC AUC: 0.9648934663889775
Batch [400/4585], Train Loss: 0.01431395672261715, Train Acc: 0.968984375, Train F1: 0.9701960181851029, Train ROC AUC: 0.9688008471965011
Batch [500/4585], Train Loss: 0.01262509636580944, Train Acc: 0.97225, Train F1: 0.9732222184797795, Train ROC AUC: 0.9720989106773682
Batch [600/4585], Train Loss: 0.01678161509335041, Train Acc: 0.975390625, Train F1: 0.9762034663274233, Train ROC AUC: 0.975268548116781
Batch [700/4585], Train Loss: 0.0010336694540455937, Train Acc: 0.9776785714285714, Train F1: 0.9783769135682422, Train ROC AUC: 0.9775742272553686
Batch [800/4585], Train Loss: 0.003982871770858765, Train Acc: 0.9788671875, Train F1: 0.9794788953061315, Train ROC AUC: 0.9787720543368219
Batch [900/4585], Train Loss: 0.03226502612233162, Train Acc: 0.9799305555555555, Train F1: 0.9804748365702856, Train ROC AUC: 0.979845118782257
Batch [1000/4585], Train Loss: 0.001645783195272088, Train Acc: 0.981328125, Train F1: 0.9818186646169841, Train ROC AUC: 0.9812482293537192
Batch [1100/4585], Train Loss: 0.05669848620891571, Train Acc: 0.9822443181818182, Train F1: 0.9826906431558762, Train ROC AUC: 0.9821679403882088
Batch [1200/4585], Train Loss: 0.02182186022400856, Train Acc: 0.9830078125, Train F1: 0.9834172701764555, Train ROC AUC: 0.982937679343003
Batch [1300/4585], Train Loss: 0.0016844229539856315, Train Acc: 0.9836899038461538, Train F1: 0.9840681442718986, Train ROC AUC: 0.9836262369322648
Batch [1400/4585], Train Loss: 0.006162355653941631, Train Acc: 0.9843638392857142, Train F1: 0.9847152896331308, Train ROC AUC: 0.9843030839592999
Batch [1500/4585], Train Loss: 0.002919777762144804, Train Acc: 0.9851041666666667, Train F1: 0.9854324470929925, Train ROC AUC: 0.9850470888211507
Batch [1600/4585], Train Loss: 0.0026536500081419945, Train Acc: 0.9856640625, Train F1: 0.9859720114274099, Train ROC AUC: 0.9856127397325076
Batch [1700/4585], Train Loss: 0.024358436465263367, Train Acc: 0.9860661764705883, Train F1: 0.9863561174989186, Train ROC AUC: 0.9860156321604165
Batch [1800/4585], Train Loss: 0.018073508515954018, Train Acc: 0.9863194444444444, Train F1: 0.9865933509333973, Train ROC AUC: 0.9862725625807629
Batch [1900/4585], Train Loss: 0.009778282605111599, Train Acc: 0.986578947368421, Train F1: 0.9868385111484947, Train ROC AUC: 0.9865341169339844
Batch [2000/4585], Train Loss: 0.001326331403106451, Train Acc: 0.9869765625, Train F1: 0.9872232521646052, Train ROC AUC: 0.9869342605699153
Batch [2100/4585], Train Loss: 0.008957055397331715, Train Acc: 0.9872172619047619, Train F1: 0.987452264152552, Train ROC AUC: 0.9871775177568365
Batch [2200/4585], Train Loss: 0.007848205976188183, Train Acc: 0.9874360795454545, Train F1: 0.9876604496905868, Train ROC AUC: 0.987398565637698
Batch [2300/4585], Train Loss: 0.06043151021003723, Train Acc: 0.9876902173913044, Train F1: 0.9879048803644289, Train ROC AUC: 0.9876529018185239
Batch [2400/4585], Train Loss: 0.0008808369748294353, Train Acc: 0.9879166666666667, Train F1: 0.9881224296608582, Train ROC AUC: 0.9878807653664107
Batch [2500/4585], Train Loss: 0.02637210115790367, Train Acc: 0.9881875, Train F1: 0.9883850679658314, Train ROC AUC: 0.9881501982633379
Batch [2600/4585], Train Loss: 0.012454967945814133, Train Acc: 0.9884915865384616, Train F1: 0.9886816132752585, Train ROC AUC: 0.9884552323989194
Batch [2700/4585], Train Loss: 0.0018172399140894413, Train Acc: 0.98875, Train F1: 0.9889330453306401, Train ROC AUC: 0.9887157623397833
Batch [2800/4585], Train Loss: 0.017040148377418518, Train Acc: 0.9889285714285714, Train F1: 0.9891051142031881, Train ROC AUC: 0.9888959877144613
Batch [2900/4585], Train Loss: 0.002037233207374811, Train Acc: 0.9890571120689655, Train F1: 0.9892275966567436, Train ROC AUC: 0.9890265386914502
Batch [3000/4585], Train Loss: 0.019464507699012756, Train Acc: 0.989234375, Train F1: 0.9893992030065103, Train ROC AUC: 0.9892041501775343
Batch [3100/4585], Train Loss: 0.00475657731294632, Train Acc: 0.9893548387096774, Train F1: 0.9895143657065272, Train ROC AUC: 0.9893250744846283
Batch [3200/4585], Train Loss: 0.1432466208934784, Train Acc: 0.98953125, Train F1: 0.989685816895507, Train ROC AUC: 0.9895016412411353
Batch [3300/4585], Train Loss: 0.01321303378790617, Train Acc: 0.9896969696969697, Train F1: 0.9898468798476046, Train ROC AUC: 0.9896682962475538
Batch [3400/4585], Train Loss: 0.002778746420517564, Train Acc: 0.9897886029411764, Train F1: 0.9899341204420856, Train ROC AUC: 0.9897609542302077
Batch [3500/4585], Train Loss: 0.0014495095238089561, Train Acc: 0.9899732142857143, Train F1: 0.9901146034833247, Train ROC AUC: 0.9899464186507685
Batch [3600/4585], Train Loss: 0.003393652383238077, Train Acc: 0.9900911458333334, Train F1: 0.9902286277495045, Train ROC AUC: 0.9900654007587851
Batch [3700/4585], Train Loss: 0.0035602489951997995, Train Acc: 0.9901097972972973, Train F1: 0.990243566148372, Train ROC AUC: 0.990084695297965
Batch [3800/4585], Train Loss: 0.028736593201756477, Train Acc: 0.9902549342105263, Train F1: 0.9903851965921445, Train ROC AUC: 0.9902298203294662
Batch [3900/4585], Train Loss: 0.012981036677956581, Train Acc: 0.9903405448717949, Train F1: 0.9904674779627802, Train ROC AUC: 0.9903158177139946
Batch [4000/4585], Train Loss: 0.00031848487560637295, Train Acc: 0.990484375, Train F1: 0.9906081566989722, Train ROC AUC: 0.9904609056115679
Batch [4100/4585], Train Loss: 0.000889089482370764, Train Acc: 0.9906516768292682, Train F1: 0.9907724613297778, Train ROC AUC: 0.9906286904186131
Batch [4200/4585], Train Loss: 0.03199990093708038, Train Acc: 0.990751488095238, Train F1: 0.9908694122052226, Train ROC AUC: 0.9907292372219288
Batch [4300/4585], Train Loss: 0.009037361480295658, Train Acc: 0.9908357558139534, Train F1: 0.9909509488752947, Train ROC AUC: 0.9908142432806473
Batch [4400/4585], Train Loss: 0.0058337547816336155, Train Acc: 0.9909446022727273, Train F1: 0.9910571904225857, Train ROC AUC: 0.9909234922455306
Batch [4500/4585], Train Loss: 0.001065745484083891, Train Acc: 0.9909930555555555, Train F1: 0.9911031463636646, Train ROC AUC: 0.9909721161425772
--------------------------------------------------
Train Loss: 0.032147377116765984, Train Acc: 0.9911015230675377, Train F1: 0.9912095919766275, Train ROC AUC: 0.9910808136976983
Valid Loss: 0.025238092164554568, Valid Acc: 0.9924205245651344, Valid F1: 0.9924210843002937, Valid ROC AUC: 0.9925148943286767
Confusion Matrix for the validation set:
 [[17921    50]
 [  228 18479]]
Saved the new best model to ../data/models/80_20_split/pklot/all_sunny/5_epochs/mobilenet.pth with accuracy 0.9924205245651344
Epoch time: 2062.0874361991882 seconds.
==================================================
Epoch 2/5
Batch [100/4585], Train Loss: 0.00034268712624907494, Train Acc: 0.99578125, Train F1: 0.9957812632871904, Train ROC AUC: 0.9957844013621407
Batch [200/4585], Train Loss: 0.0028443236369639635, Train Acc: 0.99546875, Train F1: 0.99546875, Train ROC AUC: 0.9954689687309746
Batch [300/4585], Train Loss: 0.0007948040147311985, Train Acc: 0.99546875, Train F1: 0.9954687499139573, Train ROC AUC: 0.9954687332814517
Batch [400/4585], Train Loss: 0.004295975435525179, Train Acc: 0.9954296875, Train F1: 0.9954296853447993, Train ROC AUC: 0.9954285558082858
Batch [500/4585], Train Loss: 0.0010594557970762253, Train Acc: 0.9943125, Train F1: 0.9943124705546668, Train ROC AUC: 0.9943059182815462
Batch [600/4585], Train Loss: 0.16752441227436066, Train Acc: 0.9945052083333333, Train F1: 0.994505179211883, Train ROC AUC: 0.9944987345177323
Batch [700/4585], Train Loss: 0.001169810420833528, Train Acc: 0.9947544642857142, Train F1: 0.9947544350710119, Train ROC AUC: 0.9947476139007931
Batch [800/4585], Train Loss: 0.003938428126275539, Train Acc: 0.9948828125, Train F1: 0.994882788695308, Train ROC AUC: 0.9948771717316068
Batch [900/4585], Train Loss: 0.004484320059418678, Train Acc: 0.995, Train F1: 0.9949999874889628, Train ROC AUC: 0.9949965144122211
Batch [1000/4585], Train Loss: 0.00997898355126381, Train Acc: 0.99515625, Train F1: 0.9951562416164353, Train ROC AUC: 0.9951536230482301
Batch [1100/4585], Train Loss: 0.0022322486620396376, Train Acc: 0.995, Train F1: 0.994999995673067, Train ROC AUC: 0.9949979868655917
Batch [1200/4585], Train Loss: 0.06576155126094818, Train Acc: 0.9949609375, Train F1: 0.9949609297772084, Train ROC AUC: 0.9949580043341054
Batch [1300/4585], Train Loss: 0.028187502175569534, Train Acc: 0.994951923076923, Train F1: 0.9949519147201041, Train ROC AUC: 0.9949487976858903
Batch [1400/4585], Train Loss: 0.005144097376614809, Train Acc: 0.9951674107142857, Train F1: 0.9951674040925533, Train ROC AUC: 0.9951645737109247
Batch [1500/4585], Train Loss: 0.008647726848721504, Train Acc: 0.9951770833333333, Train F1: 0.995177082542401, Train ROC AUC: 0.9951757259301968
Batch [1600/4585], Train Loss: 0.0007255098316818476, Train Acc: 0.995234375, Train F1: 0.9952343778912243, Train ROC AUC: 0.9952338281573295
Batch [1700/4585], Train Loss: 0.006682553328573704, Train Acc: 0.995266544117647, Train F1: 0.9952665434348982, Train ROC AUC: 0.9952652358763417
Batch [1800/4585], Train Loss: 0.0010626085568219423, Train Acc: 0.9953559027777777, Train F1: 0.9953559045807306, Train ROC AUC: 0.9953552561811196
Batch [1900/4585], Train Loss: 0.006458094343543053, Train Acc: 0.9954605263157895, Train F1: 0.9954605295362708, Train ROC AUC: 0.995460293504394
Batch [2000/4585], Train Loss: 0.0016297493129968643, Train Acc: 0.9955, Train F1: 0.9955000042636747, Train ROC AUC: 0.9954999089041943
Batch [2100/4585], Train Loss: 0.002662982326000929, Train Acc: 0.9955133928571429, Train F1: 0.9955133984293774, Train ROC AUC: 0.9955135974643337
Batch [2200/4585], Train Loss: 0.0025928658433258533, Train Acc: 0.9956036931818182, Train F1: 0.9956036982348199, Train ROC AUC: 0.9956038871860613
Batch [2300/4585], Train Loss: 0.006040948908776045, Train Acc: 0.9956725543478261, Train F1: 0.995672560141562, Train ROC AUC: 0.9956728950697137
Batch [2400/4585], Train Loss: 0.004101213533431292, Train Acc: 0.99564453125, Train F1: 0.9956445377562138, Train ROC AUC: 0.9956450026666778
Batch [2500/4585], Train Loss: 0.0004811490362044424, Train Acc: 0.99569375, Train F1: 0.9956937559080605, Train ROC AUC: 0.9956941968602931
Batch [2600/4585], Train Loss: 0.004385985899716616, Train Acc: 0.9957271634615384, Train F1: 0.9957271695305522, Train ROC AUC: 0.99572775634825
Batch [2700/4585], Train Loss: 0.0009450513171032071, Train Acc: 0.9957870370370371, Train F1: 0.9957870426728341, Train ROC AUC: 0.9957874928490332
Batch [2800/4585], Train Loss: 0.018752919510006905, Train Acc: 0.99578125, Train F1: 0.9957812546873032, Train ROC AUC: 0.9957815046802383
Batch [2900/4585], Train Loss: 0.0058740670792758465, Train Acc: 0.9958028017241379, Train F1: 0.9958028075706779, Train ROC AUC: 0.9958034164586169
Batch [3000/4585], Train Loss: 0.0004828017845284194, Train Acc: 0.9958177083333334, Train F1: 0.9958177160410987, Train ROC AUC: 0.9958187150808846
Batch [3100/4585], Train Loss: 0.001071758451871574, Train Acc: 0.9958870967741935, Train F1: 0.9958871048798393, Train ROC AUC: 0.995888269311405
Batch [3200/4585], Train Loss: 0.00793211068958044, Train Acc: 0.995908203125, Train F1: 0.9959082103705303, Train ROC AUC: 0.9959091795434044
Batch [3300/4585], Train Loss: 0.04700291529297829, Train Acc: 0.9959375, Train F1: 0.9959375079530618, Train ROC AUC: 0.9959385736533489
Batch [3400/4585], Train Loss: 0.004794867243617773, Train Acc: 0.9959604779411765, Train F1: 0.9959604859465293, Train ROC AUC: 0.9959615683749432
Batch [3500/4585], Train Loss: 0.00041647820034995675, Train Acc: 0.9959910714285715, Train F1: 0.9959910809915117, Train ROC AUC: 0.9959925804734636
Batch [3600/4585], Train Loss: 0.0014701636973768473, Train Acc: 0.9960373263888889, Train F1: 0.9960373365312881, Train ROC AUC: 0.9960389883478299
Batch [3700/4585], Train Loss: 0.0020265430212020874, Train Acc: 0.9960726351351351, Train F1: 0.9960726456332326, Train ROC AUC: 0.996074426716018
Batch [3800/4585], Train Loss: 0.00036532399826683104, Train Acc: 0.9961019736842105, Train F1: 0.9961019845959257, Train ROC AUC: 0.9961038508246889
Batch [3900/4585], Train Loss: 0.0008126122993417084, Train Acc: 0.9961017628205128, Train F1: 0.9961017731090527, Train ROC AUC: 0.9961034963799185
Batch [4000/4585], Train Loss: 0.0023444874677807093, Train Acc: 0.99613671875, Train F1: 0.9961367283450171, Train ROC AUC: 0.9961382799248508
Batch [4100/4585], Train Loss: 0.002047344809398055, Train Acc: 0.996139481707317, Train F1: 0.9961394915776962, Train ROC AUC: 0.9961411059591302
Batch [4200/4585], Train Loss: 0.02188759483397007, Train Acc: 0.9961123511904761, Train F1: 0.996112361563783, Train ROC AUC: 0.996114124060967
Batch [4300/4585], Train Loss: 0.0014195836847648025, Train Acc: 0.9961264534883721, Train F1: 0.9961264642929587, Train ROC AUC: 0.9961283413346969
Batch [4400/4585], Train Loss: 0.003702235873788595, Train Acc: 0.9961150568181818, Train F1: 0.996115069113404, Train ROC AUC: 0.9961173222949659
Batch [4500/4585], Train Loss: 0.000418793031712994, Train Acc: 0.9961493055555556, Train F1: 0.9961493181975359, Train ROC AUC: 0.9961516830889451
--------------------------------------------------
Train Loss: 0.014068133967295794, Train Acc: 0.9961829589565846, Train F1: 0.9961829718444191, Train ROC AUC: 0.9961854425642973
Valid Loss: 0.008686074723801104, Valid Acc: 0.9979279131904684, Valid F1: 0.9979279520193972, Valid ROC AUC: 0.9979467820218433
Confusion Matrix for the validation set:
 [[17951    20]
 [   56 18651]]
Saved the new best model to ../data/models/80_20_split/pklot/all_sunny/5_epochs/mobilenet.pth with accuracy 0.9979279131904684
Epoch time: 2040.0473210811615 seconds.
==================================================
Epoch 3/5
Batch [100/4585], Train Loss: 0.012765116058290005, Train Acc: 0.996875, Train F1: 0.9968749987792964, Train ROC AUC: 0.9968750000000001
Batch [200/4585], Train Loss: 0.000765762000810355, Train Acc: 0.996640625, Train F1: 0.9966406304748321, Train ROC AUC: 0.9966421361025388
Batch [300/4585], Train Loss: 0.0029196585528552532, Train Acc: 0.9970833333333333, Train F1: 0.9970833586626141, Train ROC AUC: 0.9970908738477219
Batch [400/4585], Train Loss: 0.005465792957693338, Train Acc: 0.996875, Train F1: 0.9968750148261691, Train ROC AUC: 0.9968784895448994
Batch [500/4585], Train Loss: 0.02801421843469143, Train Acc: 0.99678125, Train F1: 0.9967812704416344, Train ROC AUC: 0.996786579534736
Batch [600/4585], Train Loss: 0.002196164336055517, Train Acc: 0.9966666666666667, Train F1: 0.9966667037567857, Train ROC AUC: 0.9966764695345756
Batch [700/4585], Train Loss: 0.003226929809898138, Train Acc: 0.9966071428571428, Train F1: 0.996607178980011, Train ROC AUC: 0.9966166641296373
Batch [800/4585], Train Loss: 0.0013460898771882057, Train Acc: 0.99671875, Train F1: 0.9967187800154269, Train ROC AUC: 0.9967270303989897
Batch [900/4585], Train Loss: 0.003149645868688822, Train Acc: 0.9966145833333333, Train F1: 0.9966146105939601, Train ROC AUC: 0.9966219682334859
Batch [1000/4585], Train Loss: 0.00011170646030222997, Train Acc: 0.996765625, Train F1: 0.9967656482948035, Train ROC AUC: 0.9967721685493077
Batch [1100/4585], Train Loss: 0.030384153127670288, Train Acc: 0.9967755681818182, Train F1: 0.9967755883554335, Train ROC AUC: 0.9967812099314425
Batch [1200/4585], Train Loss: 0.007845218293368816, Train Acc: 0.9966666666666667, Train F1: 0.9966666879307794, Train ROC AUC: 0.9966726935078492
Batch [1300/4585], Train Loss: 0.010480543598532677, Train Acc: 0.9966947115384616, Train F1: 0.9966947325293555, Train ROC AUC: 0.9967006327901826
Batch [1400/4585], Train Loss: 0.00442653289064765, Train Acc: 0.9967745535714285, Train F1: 0.9967745748747169, Train ROC AUC: 0.9967806527263087
Batch [1500/4585], Train Loss: 0.0016307069454342127, Train Acc: 0.99678125, Train F1: 0.9967812710748103, Train ROC AUC: 0.9967872678436339
Batch [1600/4585], Train Loss: 0.003044813871383667, Train Acc: 0.996728515625, Train F1: 0.9967285394027945, Train ROC AUC: 0.9967352100654812
Batch [1700/4585], Train Loss: 0.000754609820432961, Train Acc: 0.9967647058823529, Train F1: 0.996764729294714, Train ROC AUC: 0.9967714536674976
Batch [1800/4585], Train Loss: 0.0010269093327224255, Train Acc: 0.9967447916666666, Train F1: 0.996744816069698, Train ROC AUC: 0.9967517365802552
Batch [1900/4585], Train Loss: 0.0342106856405735, Train Acc: 0.9968092105263158, Train F1: 0.9968092336294333, Train ROC AUC: 0.9968159607912086
Batch [2000/4585], Train Loss: 0.0017586271278560162, Train Acc: 0.9967890625, Train F1: 0.9967890855068587, Train ROC AUC: 0.9967957429129174
Batch [2100/4585], Train Loss: 0.0001655659725656733, Train Acc: 0.9968377976190477, Train F1: 0.9968378193175154, Train ROC AUC: 0.9968441577364131
Batch [2200/4585], Train Loss: 0.0016903261421248317, Train Acc: 0.9968394886363636, Train F1: 0.9968395086056789, Train ROC AUC: 0.9968452822133884
Batch [2300/4585], Train Loss: 0.0007442375062964857, Train Acc: 0.9968546195652174, Train F1: 0.9968546417563123, Train ROC AUC: 0.9968611371337519
Batch [2400/4585], Train Loss: 0.0003971462429035455, Train Acc: 0.9969140625, Train F1: 0.9969140820314923, Train ROC AUC: 0.9969198674080186
Batch [2500/4585], Train Loss: 0.001358951791189611, Train Acc: 0.99691875, Train F1: 0.9969187674999656, Train ROC AUC: 0.9969238558504938
Batch [2600/4585], Train Loss: 0.0005665599019266665, Train Acc: 0.9969711538461539, Train F1: 0.9969711704975671, Train ROC AUC: 0.9969761470154159
Batch [2700/4585], Train Loss: 0.0005742725916206837, Train Acc: 0.9969907407407408, Train F1: 0.9969907572302596, Train ROC AUC: 0.9969956656515003
Batch [2800/4585], Train Loss: 0.00018717018247116357, Train Acc: 0.9969754464285714, Train F1: 0.9969754623827672, Train ROC AUC: 0.9969802044489592
Batch [2900/4585], Train Loss: 0.0028075342997908592, Train Acc: 0.9970366379310345, Train F1: 0.9970366534594598, Train ROC AUC: 0.9970413748602531
Batch [3000/4585], Train Loss: 0.0013480223715305328, Train Acc: 0.997109375, Train F1: 0.9971093897292206, Train ROC AUC: 0.9971139463396431
Batch [3100/4585], Train Loss: 0.00043063389603048563, Train Acc: 0.9971421370967742, Train F1: 0.9971421522435051, Train ROC AUC: 0.9971468168602554
Batch [3200/4585], Train Loss: 0.06623954325914383, Train Acc: 0.9971728515625, Train F1: 0.9971728653441784, Train ROC AUC: 0.9971771779713338
Batch [3300/4585], Train Loss: 0.00228684488683939, Train Acc: 0.9972159090909091, Train F1: 0.9972159220618279, Train ROC AUC: 0.9972200208625367
Batch [3400/4585], Train Loss: 0.0016910224221646786, Train Acc: 0.9972104779411765, Train F1: 0.997210490377854, Train ROC AUC: 0.9972143791978494
Batch [3500/4585], Train Loss: 0.021659251302480698, Train Acc: 0.9971741071428571, Train F1: 0.997174120105718, Train ROC AUC: 0.997178136528588
Batch [3600/4585], Train Loss: 0.0004399312601890415, Train Acc: 0.9971397569444445, Train F1: 0.9971397705016506, Train ROC AUC: 0.997143887938168
Batch [3700/4585], Train Loss: 0.0036066710017621517, Train Acc: 0.9971579391891892, Train F1: 0.9971579527452554, Train ROC AUC: 0.9971620964886106
Batch [3800/4585], Train Loss: 0.0005803903914056718, Train Acc: 0.9971587171052632, Train F1: 0.9971587308204447, Train ROC AUC: 0.9971629565184588
Batch [3900/4585], Train Loss: 0.0004661727580241859, Train Acc: 0.9971594551282051, Train F1: 0.9971594686935852, Train ROC AUC: 0.9971636180250704
Batch [4000/4585], Train Loss: 0.004643438849598169, Train Acc: 0.997171875, Train F1: 0.9971718887849377, Train ROC AUC: 0.9971761312395094
Batch [4100/4585], Train Loss: 0.0025258478708565235, Train Acc: 0.9971646341463415, Train F1: 0.9971646486910557, Train ROC AUC: 0.9971691475645651
Batch [4200/4585], Train Loss: 0.004811211489140987, Train Acc: 0.9971800595238095, Train F1: 0.9971800735437184, Train ROC AUC: 0.9971844245488419
Batch [4300/4585], Train Loss: 0.0002019255916820839, Train Acc: 0.9971765988372093, Train F1: 0.9971766140024626, Train ROC AUC: 0.9971813752933344
Batch [4400/4585], Train Loss: 0.00018188761896453798, Train Acc: 0.9972123579545454, Train F1: 0.9972123726339319, Train ROC AUC: 0.997217092522238
Batch [4500/4585], Train Loss: 0.0018832531059160829, Train Acc: 0.9972465277777778, Train F1: 0.9972465423963, Train ROC AUC: 0.9972512994785483
--------------------------------------------------
Train Loss: 0.01042743309817911, Train Acc: 0.9972565017500452, Train F1: 0.9972565168100904, Train ROC AUC: 0.9972614433463576
Valid Loss: 0.00903001836163782, Valid Acc: 0.9979551774905938, Valid F1: 0.997955210722528, Valid ROC AUC: 0.9979713207040619
Confusion Matrix for the validation set:
 [[17949    22]
 [   53 18654]]
Saved the new best model to ../data/models/80_20_split/pklot/all_sunny/5_epochs/mobilenet.pth with accuracy 0.9979551774905938
Epoch time: 2311.6107182502747 seconds.
==================================================
Epoch 4/5
Batch [100/4585], Train Loss: 0.001548210857436061, Train Acc: 0.9971875, Train F1: 0.9971875098878344, Train ROC AUC: 0.9971918328283581
Batch [200/4585], Train Loss: 0.000564289279282093, Train Acc: 0.996796875, Train F1: 0.9967968795943879, Train ROC AUC: 0.996798409075306
Batch [300/4585], Train Loss: 0.0011810665018856525, Train Acc: 0.9969791666666666, Train F1: 0.9969791862071452, Train ROC AUC: 0.9969850414804254
Batch [400/4585], Train Loss: 0.0003947913646697998, Train Acc: 0.9972265625, Train F1: 0.9972265788440707, Train ROC AUC: 0.997231767167878
Batch [500/4585], Train Loss: 0.0024697091430425644, Train Acc: 0.99690625, Train F1: 0.9969062655234172, Train ROC AUC: 0.9969106954524803
Batch [600/4585], Train Loss: 0.003952065482735634, Train Acc: 0.996875, Train F1: 0.9968750154905335, Train ROC AUC: 0.9968794809891562
Batch [700/4585], Train Loss: 0.00320438458584249, Train Acc: 0.9969196428571429, Train F1: 0.9969196622553373, Train ROC AUC: 0.9969253059623181
Batch [800/4585], Train Loss: 0.004083611071109772, Train Acc: 0.99697265625, Train F1: 0.996972672951521, Train ROC AUC: 0.9969776081759699
Batch [900/4585], Train Loss: 0.004989296663552523, Train Acc: 0.9970833333333333, Train F1: 0.997083349892337, Train ROC AUC: 0.9970884788396153
Batch [1000/4585], Train Loss: 0.04710446670651436, Train Acc: 0.99715625, Train F1: 0.9971562659663461, Train ROC AUC: 0.9971613355976047
Batch [1100/4585], Train Loss: 0.00040743875433690846, Train Acc: 0.9972159090909091, Train F1: 0.9972159287123579, Train ROC AUC: 0.997222337467777
Batch [1200/4585], Train Loss: 0.00047834916040301323, Train Acc: 0.9972395833333333, Train F1: 0.9972396025600673, Train ROC AUC: 0.9972460225106927
Batch [1300/4585], Train Loss: 0.0006684819818474352, Train Acc: 0.9972475961538462, Train F1: 0.9972476142916415, Train ROC AUC: 0.9972536510385728
Batch [1400/4585], Train Loss: 0.0019058907637372613, Train Acc: 0.9972767857142857, Train F1: 0.997276806320419, Train ROC AUC: 0.9972838211980084
Batch [1500/4585], Train Loss: 0.000348173693055287, Train Acc: 0.9973229166666666, Train F1: 0.9973229353198406, Train ROC AUC: 0.9973293996596462
Batch [1600/4585], Train Loss: 0.0036423795390874147, Train Acc: 0.99732421875, Train F1: 0.9973242389902103, Train ROC AUC: 0.9973312651974126
Batch [1700/4585], Train Loss: 6.274132465478033e-05, Train Acc: 0.9973988970588236, Train F1: 0.997398918032384, Train ROC AUC: 0.9974063683454195
Batch [1800/4585], Train Loss: 0.0005750213167630136, Train Acc: 0.9973524305555556, Train F1: 0.9973524525655926, Train ROC AUC: 0.9973601970224516
Batch [1900/4585], Train Loss: 0.000651494599878788, Train Acc: 0.9973684210526316, Train F1: 0.9973684430386627, Train ROC AUC: 0.9973762848672204
Batch [2000/4585], Train Loss: 0.001453665317967534, Train Acc: 0.9973984375, Train F1: 0.9973984593841891, Train ROC AUC: 0.9974062878010249
Batch [2100/4585], Train Loss: 0.007563640363514423, Train Acc: 0.9974553571428572, Train F1: 0.9974553772681446, Train ROC AUC: 0.9974628066312744
Batch [2200/4585], Train Loss: 0.016184620559215546, Train Acc: 0.997372159090909, Train F1: 0.9973721798435389, Train ROC AUC: 0.9973795986035157
Batch [2300/4585], Train Loss: 0.001343157491646707, Train Acc: 0.9973709239130435, Train F1: 0.997370944705582, Train ROC AUC: 0.9973784632867033
Batch [2400/4585], Train Loss: 0.0015675832983106375, Train Acc: 0.99736328125, Train F1: 0.9973633039911999, Train ROC AUC: 0.9973714804698541
Batch [2500/4585], Train Loss: 0.0014882934046909213, Train Acc: 0.99739375, Train F1: 0.9973937717135224, Train ROC AUC: 0.9974016344306532
Batch [2600/4585], Train Loss: 0.0035749119706451893, Train Acc: 0.9974098557692308, Train F1: 0.9974098759221698, Train ROC AUC: 0.9974172143365941
Batch [2700/4585], Train Loss: 0.000648916291538626, Train Acc: 0.9974189814814814, Train F1: 0.9974190011208793, Train ROC AUC: 0.9974262713303989
Batch [2800/4585], Train Loss: 0.0032291205134242773, Train Acc: 0.9974497767857143, Train F1: 0.9974497972282166, Train ROC AUC: 0.9974574494470044
Batch [2900/4585], Train Loss: 0.00042273945291526616, Train Acc: 0.9974353448275862, Train F1: 0.9974353667607233, Train ROC AUC: 0.9974435691826873
Batch [3000/4585], Train Loss: 0.001238896744325757, Train Acc: 0.9974635416666666, Train F1: 0.9974635617336142, Train ROC AUC: 0.9974711807134113
Batch [3100/4585], Train Loss: 0.005393339321017265, Train Acc: 0.9975302419354839, Train F1: 0.9975302606946618, Train ROC AUC: 0.997537585820132
Batch [3200/4585], Train Loss: 0.0052029844373464584, Train Acc: 0.997548828125, Train F1: 0.9975488454596961, Train ROC AUC: 0.9975557022672312
Batch [3300/4585], Train Loss: 0.00853701401501894, Train Acc: 0.9974763257575757, Train F1: 0.9974763437379418, Train ROC AUC: 0.9974832783688866
Batch [3400/4585], Train Loss: 0.005122082307934761, Train Acc: 0.9974816176470588, Train F1: 0.9974816355422778, Train ROC AUC: 0.9974885239327665
Batch [3500/4585], Train Loss: 0.0007413343992084265, Train Acc: 0.9975, Train F1: 0.9975000176881386, Train ROC AUC: 0.9975068659399537
Batch [3600/4585], Train Loss: 0.0005328645929694176, Train Acc: 0.9975260416666667, Train F1: 0.9975260586774817, Train ROC AUC: 0.9975326752476761
Batch [3700/4585], Train Loss: 0.0004086505505256355, Train Acc: 0.9975295608108108, Train F1: 0.9975295784876458, Train ROC AUC: 0.9975364321210037
Batch [3800/4585], Train Loss: 0.0004913394222967327, Train Acc: 0.9975657894736842, Train F1: 0.9975658065452628, Train ROC AUC: 0.997572519874939
Batch [3900/4585], Train Loss: 0.0013783465838059783, Train Acc: 0.9975641025641026, Train F1: 0.9975641198761562, Train ROC AUC: 0.9975709229269788
Batch [4000/4585], Train Loss: 0.020708812400698662, Train Acc: 0.99759765625, Train F1: 0.9975976733193952, Train ROC AUC: 0.9976045033352341
Batch [4100/4585], Train Loss: 0.007211265619844198, Train Acc: 0.9976143292682926, Train F1: 0.9976143464873362, Train ROC AUC: 0.9976212513010135
Batch [4200/4585], Train Loss: 0.0014586945762857795, Train Acc: 0.9976227678571429, Train F1: 0.997622784876198, Train ROC AUC: 0.9976295940156488
Batch [4300/4585], Train Loss: 0.004196247085928917, Train Acc: 0.9976271802325581, Train F1: 0.9976271969485123, Train ROC AUC: 0.9976338750971322
Batch [4400/4585], Train Loss: 0.0007379407179541886, Train Acc: 0.9976455965909091, Train F1: 0.9976456130371678, Train ROC AUC: 0.9976522112020778
Batch [4500/4585], Train Loss: 0.0016854907153174281, Train Acc: 0.9976354166666667, Train F1: 0.9976354333952914, Train ROC AUC: 0.9976421159645223
--------------------------------------------------
Train Loss: 0.009208791238845127, Train Acc: 0.9976313897096664, Train F1: 0.9976314065536832, Train ROC AUC: 0.9976381356680567
Valid Loss: 0.009578639791385216, Valid Acc: 0.9978461202900921, Valid F1: 0.9978460923282501, Valid ROC AUC: 0.9978326642845291
Confusion Matrix for the validation set:
 [[17920    51]
 [   28 18679]]
Epoch time: 2391.9110622406006 seconds.
==================================================
Epoch 5/5
Batch [100/4585], Train Loss: 0.00019321254512760788, Train Acc: 0.998125, Train F1: 0.9981250458463231, Train ROC AUC: 0.9981468858517483
Batch [200/4585], Train Loss: 0.0043026539497077465, Train Acc: 0.9975, Train F1: 0.9975000271322556, Train ROC AUC: 0.997507884658707
Batch [300/4585], Train Loss: 0.0026468588039278984, Train Acc: 0.9978125, Train F1: 0.9978125247034499, Train ROC AUC: 0.9978223114563723
Batch [400/4585], Train Loss: 0.006259647198021412, Train Acc: 0.9977734375, Train F1: 0.9977734716168581, Train ROC AUC: 0.9977875135420772
Batch [500/4585], Train Loss: 0.0005649165250360966, Train Acc: 0.9978125, Train F1: 0.9978125291630918, Train ROC AUC: 0.9978248615076203
Batch [600/4585], Train Loss: 0.08974172919988632, Train Acc: 0.9975260416666667, Train F1: 0.9975260790054135, Train ROC AUC: 0.9975398483651954
Batch [700/4585], Train Loss: 0.000357749464455992, Train Acc: 0.9977455357142857, Train F1: 0.9977455652633809, Train ROC AUC: 0.9977573785428003
Batch [800/4585], Train Loss: 0.00044980383245274425, Train Acc: 0.9978125, Train F1: 0.9978125272577509, Train ROC AUC: 0.9978240699446792
Batch [900/4585], Train Loss: 0.0003733029880095273, Train Acc: 0.9977951388888889, Train F1: 0.9977951667780501, Train ROC AUC: 0.997806804298724
Batch [1000/4585], Train Loss: 0.0008166069746948779, Train Acc: 0.997828125, Train F1: 0.9978281507527378, Train ROC AUC: 0.9978392091551282
Batch [1100/4585], Train Loss: 0.002072929171845317, Train Acc: 0.9978125, Train F1: 0.9978125228185138, Train ROC AUC: 0.9978223600553213
Batch [1200/4585], Train Loss: 0.00013819894229527563, Train Acc: 0.9978515625, Train F1: 0.9978515830061707, Train ROC AUC: 0.9978605650342539
Batch [1300/4585], Train Loss: 0.007736274506896734, Train Acc: 0.9978966346153846, Train F1: 0.997896652527233, Train ROC AUC: 0.9979046401017365
Batch [1400/4585], Train Loss: 0.07418874651193619, Train Acc: 0.9977901785714286, Train F1: 0.9977901970102783, Train ROC AUC: 0.9977980887438366
Batch [1500/4585], Train Loss: 0.0011953426292166114, Train Acc: 0.9978125, Train F1: 0.9978125143210251, Train ROC AUC: 0.9978186515653233
Batch [1600/4585], Train Loss: 0.0003507495566736907, Train Acc: 0.997841796875, Train F1: 0.9978418109061797, Train ROC AUC: 0.9978479290185456
Batch [1700/4585], Train Loss: 0.0001540813100291416, Train Acc: 0.9979136029411765, Train F1: 0.9979136163670105, Train ROC AUC: 0.997919614062699
Batch [1800/4585], Train Loss: 0.00011226543574593961, Train Acc: 0.9979861111111111, Train F1: 0.9979861238747333, Train ROC AUC: 0.9979920754076406
Batch [1900/4585], Train Loss: 0.00036480039125308394, Train Acc: 0.998001644736842, Train F1: 0.9980016572989748, Train ROC AUC: 0.9980074661746988
Batch [2000/4585], Train Loss: 6.76824856782332e-05, Train Acc: 0.997984375, Train F1: 0.9979843882657494, Train ROC AUC: 0.9979905103117089
Batch [2100/4585], Train Loss: 0.0035150216426700354, Train Acc: 0.9979315476190476, Train F1: 0.9979315625137375, Train ROC AUC: 0.9979383289576349
Batch [2200/4585], Train Loss: 0.002276492537930608, Train Acc: 0.9978622159090909, Train F1: 0.9978622292810887, Train ROC AUC: 0.9978680976420085
Batch [2300/4585], Train Loss: 0.0006232212763279676, Train Acc: 0.9978804347826087, Train F1: 0.9978804470970096, Train ROC AUC: 0.9978859143187556
Batch [2400/4585], Train Loss: 0.001186516135931015, Train Acc: 0.9978971354166667, Train F1: 0.9978971478038878, Train ROC AUC: 0.9979026541788463
Batch [2500/4585], Train Loss: 0.004502724856138229, Train Acc: 0.99793125, Train F1: 0.9979312622162099, Train ROC AUC: 0.9979368203184336
Batch [2600/4585], Train Loss: 0.0007095635519362986, Train Acc: 0.9979026442307692, Train F1: 0.9979026570333469, Train ROC AUC: 0.9979084400725918
Batch [2700/4585], Train Loss: 0.000706889433786273, Train Acc: 0.9978993055555555, Train F1: 0.9978993182705379, Train ROC AUC: 0.9979050456825056
Batch [2800/4585], Train Loss: 0.0008447757572866976, Train Acc: 0.9978794642857143, Train F1: 0.9978794777009058, Train ROC AUC: 0.9978855050900802
Batch [2900/4585], Train Loss: 0.0022839342709630728, Train Acc: 0.9978879310344828, Train F1: 0.997887943710452, Train ROC AUC: 0.997893653057876
Batch [3000/4585], Train Loss: 0.020322374999523163, Train Acc: 0.997890625, Train F1: 0.9978906375105902, Train ROC AUC: 0.9978962617816269
Batch [3100/4585], Train Loss: 0.0004241756396368146, Train Acc: 0.9979284274193548, Train F1: 0.9979284405874081, Train ROC AUC: 0.9979344849963794
Batch [3200/4585], Train Loss: 0.001207756227813661, Train Acc: 0.99794921875, Train F1: 0.9979492316115173, Train ROC AUC: 0.997955183303995
Batch [3300/4585], Train Loss: 0.001403404283337295, Train Acc: 0.997935606060606, Train F1: 0.9979356189659718, Train ROC AUC: 0.9979415404301979
Batch [3400/4585], Train Loss: 0.0032280702143907547, Train Acc: 0.9979273897058824, Train F1: 0.9979274024127417, Train ROC AUC: 0.9979331966054085
Batch [3500/4585], Train Loss: 0.00018851867935154587, Train Acc: 0.9979464285714286, Train F1: 0.9979464409432769, Train ROC AUC: 0.9979521279786294
Batch [3600/4585], Train Loss: 0.0011404165998101234, Train Acc: 0.9979383680555556, Train F1: 0.9979383802702319, Train ROC AUC: 0.9979439325156352
Batch [3700/4585], Train Loss: 0.0017557499231770635, Train Acc: 0.997960304054054, Train F1: 0.9979603162250367, Train ROC AUC: 0.997965930058085
Batch [3800/4585], Train Loss: 8.901296678232029e-05, Train Acc: 0.99796875, Train F1: 0.9979687617663014, Train ROC AUC: 0.9979742121627296
Batch [3900/4585], Train Loss: 0.0010873550781980157, Train Acc: 0.9980008012820513, Train F1: 0.9980008127013651, Train ROC AUC: 0.9980061848958334
Batch [4000/4585], Train Loss: 0.005269960500299931, Train Acc: 0.99800390625, Train F1: 0.9980039178465959, Train ROC AUC: 0.9980093916597983
Batch [4100/4585], Train Loss: 0.0007846884545870125, Train Acc: 0.9979801829268292, Train F1: 0.9979801947299966, Train ROC AUC: 0.9979857208837029
Batch [4200/4585], Train Loss: 0.0010359225561842322, Train Acc: 0.9979985119047619, Train F1: 0.9979985235462179, Train ROC AUC: 0.9980040022905246
Batch [4300/4585], Train Loss: 0.0012678978964686394, Train Acc: 0.9979905523255814, Train F1: 0.9979905640554056, Train ROC AUC: 0.9979960864924887
Batch [4400/4585], Train Loss: 0.0006785698351450264, Train Acc: 0.9980149147727273, Train F1: 0.9980149265166481, Train ROC AUC: 0.9980204933788315
Batch [4500/4585], Train Loss: 0.0002278093306813389, Train Acc: 0.9980208333333334, Train F1: 0.998020844587276, Train ROC AUC: 0.9980261825175416
--------------------------------------------------
Train Loss: 0.007882274626087447, Train Acc: 0.9980301341758088, Train F1: 0.9980301454914345, Train ROC AUC: 0.9980355338704824
Valid Loss: 0.007878925631293485, Valid Acc: 0.9979824417907193, Valid F1: 0.9979824283234888, Valid ROC AUC: 0.997975061220807
Confusion Matrix for the validation set:
 [[17928    43]
 [   31 18676]]
Saved the new best model to ../data/models/80_20_split/pklot/all_sunny/5_epochs/mobilenet.pth with accuracy 0.9979824417907193
Epoch time: 2287.9659075737 seconds.
==================================================
Average Train Loss: 0.014746802009434696
Average Train Accuracy: 0.9960405015319285
Average Train F1: 0.996062126535251
Average Train ROC AUC: 0.9960402738293785

Best Validation Accuracy: 0.9979824417907193

Average Valid Loss: 0.012082350134534438
Average Valid Accuracy: 0.9968264354654016
Average Valid F1: 0.9968265535387916
Average Valid ROC AUC: 0.9968481445119834

Total training time: 11093.624444961548 seconds.
